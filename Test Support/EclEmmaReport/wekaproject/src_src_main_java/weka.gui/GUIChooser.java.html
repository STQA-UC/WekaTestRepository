<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>GUIChooser.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">AllTests (Nov 28, 2015 2:34:31 PM)</a> &gt; <a href="../../index.html" class="el_group">wekaproject</a> &gt; <a href="../index.html" class="el_bundle">src/src/main/java</a> &gt; <a href="index.source.html" class="el_package">weka.gui</a> &gt; <span class="el_source">GUIChooser.java</span></div><h1>GUIChooser.java</h1><pre class="source lang-java linenums"><span class="nc" id="L1">/*</span>
 *    This program is free software; you can redistribute it and/or modify
 *    it under the terms of the GNU General Public License as published by
 *    the Free Software Foundation; either version 2 of the License, or
 *    (at your option) any later version.
 *
 *    This program is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *    GNU General Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License
 *    along with this program; if not, write to the Free Software
 *    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 */

/*
 *    GUIChooser.java
 *    Copyright (C) 1999 University of Waikato, Hamilton, New Zealand
 *
 */

package weka.gui;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Component;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.Image;
import java.awt.LayoutManager;
import java.awt.Point;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileReader;
import java.io.Reader;
import java.lang.reflect.Method;
import java.util.Collections;
import java.util.Enumeration;
import java.util.HashSet;
import java.util.Hashtable;
import java.util.Locale;
import java.util.Vector;

import javax.swing.BorderFactory;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JSeparator;
import javax.swing.JTable;
import javax.swing.KeyStroke;

import weka.classifiers.bayes.net.GUI;
import weka.classifiers.evaluation.ThresholdCurve;
import weka.core.Copyright;
import weka.core.Instances;
import weka.core.Memory;
import weka.core.SystemInfo;
import weka.core.Utils;
import weka.core.Version;
import weka.gui.arffviewer.ArffViewer;
import weka.gui.beans.KnowledgeFlow;
import weka.gui.beans.KnowledgeFlowApp;
import weka.gui.boundaryvisualizer.BoundaryVisualizer;
import weka.gui.experiment.Experimenter;
import weka.gui.explorer.Explorer;
import weka.gui.graphvisualizer.GraphVisualizer;
import weka.gui.sql.SqlViewer;
import weka.gui.treevisualizer.Node;
import weka.gui.treevisualizer.NodePlace;
import weka.gui.treevisualizer.PlaceNode2;
import weka.gui.treevisualizer.TreeBuild;
import weka.gui.treevisualizer.TreeVisualizer;
import weka.gui.visualize.PlotData2D;
import weka.gui.visualize.ThresholdVisualizePanel;
import weka.gui.visualize.VisualizePanel;

/** 
 * The main class for the Weka GUIChooser. Lets the user choose
 * which GUI they want to run.
 *
 * @author Len Trigg (trigg@cs.waikato.ac.nz)
 * @author Mark Hall (mhall@cs.waikato.ac.nz)
 * @author FracPete (fracpete at waikato dot ac dot nz)
 * @version $Revision: 9490 $
 */
<span class="nc" id="L103">public class GUIChooser</span>
  extends JFrame {
  
  static {
    try {
<span class="nc" id="L108">      Object MacApp = Class.forName(&quot;com.apple.eawt.Application&quot;).newInstance();</span>
      
<span class="nc" id="L110">      Object macArffHandler = Class.forName(&quot;weka.gui.MacArffOpenFilesHandler&quot;).newInstance();</span>
      
<span class="nc" id="L112">      Class fileHandlerClass = Class.forName(&quot;com.apple.eawt.OpenFilesHandler&quot;);</span>
<span class="nc" id="L113">      Class[] paramClass = new Class[1];</span>
<span class="nc" id="L114">      paramClass[0] = fileHandlerClass;</span>
<span class="nc" id="L115">      Object[] args = new Object[1];</span>
<span class="nc" id="L116">      args[0] = macArffHandler;</span>
      
<span class="nc" id="L118">      Method m = MacApp.getClass().getMethod(&quot;setOpenFileHandler&quot;, paramClass);</span>
<span class="nc" id="L119">      System.out.println(&quot;Trying to install a file handler for Mac...&quot;);</span>
<span class="nc" id="L120">      m.invoke(MacApp, macArffHandler);</span>
      
<span class="nc" id="L122">    } catch (Exception ex) {</span>
      // quietly ignore...
    }
  }

  /** for serialization */
  private static final long serialVersionUID = 9001529425230247914L;

  /** the GUIChooser itself */
  protected GUIChooser m_Self;
  
  // Menu stuff
  private JMenuBar m_jMenuBar;
  private JMenu m_jMenuProgram;
  private JMenu m_jMenuVisualization;
  private JMenu m_jMenuTools;
  private JMenu m_jMenuHelp;
  
  // Applications

  /** the panel for the application buttons */
<span class="nc" id="L143">  protected JPanel m_PanelApplications = new JPanel();</span>
  
  /** Click to open the Explorer */
<span class="nc" id="L146">  protected JButton m_ExplorerBut = new JButton(Messages.getInstance().getString(&quot;GUIChooser_Explorer_Text&quot;));</span>

  /** The frame containing the explorer interface */
  protected JFrame m_ExplorerFrame;

  /** Click to open the Explorer */
<span class="nc" id="L152">  protected JButton m_ExperimenterBut = new JButton(Messages.getInstance().getString(&quot;GUIChooser_Experimenter_Text&quot;));</span>

  /** The frame containing the experiment interface */
  protected JFrame m_ExperimenterFrame;

  /** Click to open the KnowledgeFlow */
<span class="nc" id="L158">  protected JButton m_KnowledgeFlowBut = new JButton(Messages.getInstance().getString(&quot;GUIChooser_KnowledgeFlow_Text&quot;));</span>
  
  /** Pending file to load on startup of the KnowledgeFlow */
<span class="nc" id="L161">  protected String m_pendingKnowledgeFlowLoad = null;</span>

  /** The frame containing the knowledge flow interface */
  protected JFrame m_KnowledgeFlowFrame;

  /** Click to open the simplecli */
<span class="nc" id="L167">  protected JButton m_SimpleBut = new JButton(Messages.getInstance().getString(&quot;GUIChooser_Simple_CLI_Text&quot;));</span>
  
  /** The SimpleCLI */
  protected SimpleCLI m_SimpleCLI;

  /** keeps track of the opened ArffViewer instancs */
<span class="nc" id="L173">  protected Vector m_ArffViewers = new Vector();</span>

  /** The frame containing the SqlViewer */
  protected JFrame m_SqlViewerFrame;
  
  /** The frame containing the Bayes net GUI */
  protected JFrame m_BayesNetGUIFrame;
  
  /** The frame containing the ensemble library interface */
  protected JFrame m_EnsembleLibraryFrame;

  // Visualization

  /** keeps track of the opened plots */
<span class="nc" id="L187">  protected Vector m_Plots = new Vector();</span>

  /** keeps track of the opened ROCs */
<span class="nc" id="L190">  protected Vector m_ROCs = new Vector();</span>

  /** keeps track of the opened tree visualizer instancs */
<span class="nc" id="L193">  protected Vector m_TreeVisualizers = new Vector();</span>

  /** keeps track of the opened graph visualizer instancs */
<span class="nc" id="L196">  protected Vector m_GraphVisualizers = new Vector();</span>

  /** The frame containing the boundary visualizer */
  protected JFrame m_BoundaryVisualizerFrame;
  
  // Help

  /** The frame containing the system info */
  protected JFrame m_SystemInfoFrame;
  
  // Other

  /** The frame containing the memory usage */
  protected JFrame m_MemoryUsageFrame;

  /** The frame of the LogWindow */
<span class="nc" id="L212">  protected static LogWindow m_LogWindow = new LogWindow();</span>

  /** The weka image */
<span class="nc" id="L215">  Image m_weka = Toolkit.getDefaultToolkit().</span>
<span class="nc" id="L216">    getImage(GUIChooser.class.getClassLoader().getResource(&quot;weka/gui/images/weka_background.gif&quot;));</span>

  /** filechooser for the TreeVisualizer */
<span class="nc" id="L219">  protected JFileChooser m_FileChooserTreeVisualizer = new JFileChooser(new File(System.getProperty(&quot;user.dir&quot;)));</span>

  /** filechooser for the GraphVisualizer */
<span class="nc" id="L222">  protected JFileChooser m_FileChooserGraphVisualizer = new JFileChooser(new File(System.getProperty(&quot;user.dir&quot;)));</span>

  /** filechooser for Plots */
<span class="nc" id="L225">  protected JFileChooser m_FileChooserPlot = new JFileChooser(new File(System.getProperty(&quot;user.dir&quot;)));</span>

  /** filechooser for ROC curves */
<span class="nc" id="L228">  protected JFileChooser m_FileChooserROC = new JFileChooser(new File(System.getProperty(&quot;user.dir&quot;)));</span>
  
  /** the icon for the frames */
  protected Image m_Icon;
  
  /** contains the child frames (title &amp;lt;-&amp;gt; object). */
<span class="nc" id="L234">  protected HashSet&lt;Container&gt; m_ChildFrames = new HashSet&lt;Container&gt;();</span>
  
  /**
   * Create a singleton instance of the GUIChooser 
   */
  public static synchronized void createSingleton() {
<span class="nc bnc" id="L240" title="All 2 branches missed.">    if (m_chooser == null) {</span>
<span class="nc" id="L241">      m_chooser = new GUIChooser();</span>
    }
<span class="nc" id="L243">  }</span>

  /**
   * Get the singleton instance of the GUIChooser
   *
   * @return the singleton instance of the GUIChooser
   */
  public static GUIChooser getSingleton() {
<span class="nc" id="L251">    return m_chooser;</span>
  }
  
  /**
   * Creates the experiment environment gui with no initial experiment
   */
  public GUIChooser() {

<span class="nc" id="L259">    super(Messages.getInstance().getString(&quot;GUIChooser_Title_Text&quot;));</span>
    
<span class="nc" id="L261">    m_Self = this;</span>

    // filechoosers
<span class="nc" id="L264">    m_FileChooserGraphVisualizer.addChoosableFileFilter(</span>
<span class="nc" id="L265">	  new ExtensionFileFilter(&quot;.bif&quot;, Messages.getInstance().getString(&quot;GUIChooser_BIF_Files_Text&quot;)));</span>
<span class="nc" id="L266">    m_FileChooserGraphVisualizer.addChoosableFileFilter(</span>
<span class="nc" id="L267">	  new ExtensionFileFilter(&quot;.xml&quot;, Messages.getInstance().getString(&quot;GUIChooser_XML_Files_Text&quot;)));</span>

<span class="nc" id="L269">    m_FileChooserPlot.addChoosableFileFilter(</span>
<span class="nc" id="L270">	  new ExtensionFileFilter(</span>
<span class="nc" id="L271">	      Instances.FILE_EXTENSION,</span>
<span class="nc" id="L272">	      Messages.getInstance().getString(&quot;GUIChooser_ARFF_Files_Text_Front&quot;) + Instances.FILE_EXTENSION + Messages.getInstance().getString(&quot;GUIChooser_ARFF_Files_Text_End&quot;)));</span>
<span class="nc" id="L273">    m_FileChooserPlot.setMultiSelectionEnabled(true);</span>
    
<span class="nc" id="L275">    m_FileChooserROC.addChoosableFileFilter(</span>
<span class="nc" id="L276">	  new ExtensionFileFilter(</span>
<span class="nc" id="L277">	      Instances.FILE_EXTENSION,</span>
<span class="nc" id="L278">	      Messages.getInstance().getString(&quot;GUIChooser_ARFF_Files_Text_Front&quot;) + Instances.FILE_EXTENSION + Messages.getInstance().getString(&quot;GUIChooser_ARFF_Files_Text_End&quot;)));</span>

    // general layout
<span class="nc" id="L281">    m_Icon = Toolkit.getDefaultToolkit().getImage(</span>
<span class="nc" id="L282">	GUIChooser.class.getClassLoader().getResource(&quot;weka/gui/weka_icon_new_48.png&quot;));</span>
<span class="nc" id="L283">    setIconImage(m_Icon);</span>
<span class="nc" id="L284">    this.getContentPane().setLayout(new BorderLayout());</span>
    
<span class="nc" id="L286">    this.getContentPane().add(m_PanelApplications, BorderLayout.EAST);</span>

    // applications
<span class="nc" id="L289">    m_PanelApplications.setBorder(BorderFactory.createTitledBorder(Messages.getInstance().getString(&quot;GUIChooser_Applications_Text&quot;)));</span>
<span class="nc" id="L290">    m_PanelApplications.setLayout(new GridLayout(4, 1));</span>
<span class="nc" id="L291">    m_PanelApplications.add(m_ExplorerBut);</span>
<span class="nc" id="L292">    m_PanelApplications.add(m_ExperimenterBut);</span>
<span class="nc" id="L293">    m_PanelApplications.add(m_KnowledgeFlowBut);</span>
<span class="nc" id="L294">    m_PanelApplications.add(m_SimpleBut);</span>
    
    // Weka image plus copyright info
<span class="nc" id="L297">    JPanel wekaPan = new JPanel();</span>
<span class="nc" id="L298">    wekaPan.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));</span>
<span class="nc" id="L299">    wekaPan.setLayout(new BorderLayout());</span>
<span class="nc" id="L300">    wekaPan.setToolTipText(Messages.getInstance().getString(&quot;GUIChooser_Weka_Native_Bird_Text&quot;));</span>
<span class="nc" id="L301">    ImageIcon wii = new ImageIcon(m_weka);</span>
<span class="nc" id="L302">    JLabel wekaLab = new JLabel(wii);</span>
<span class="nc" id="L303">    wekaPan.add(wekaLab, BorderLayout.CENTER);</span>
<span class="nc" id="L304">    String infoString = Messages.getInstance().getString(&quot;GUIChooser_Information_Text_Front&quot;) + &quot; &quot; + Version.VERSION + &quot;&lt;br&gt;&quot;</span>
<span class="nc" id="L305">      + &quot;(c) &quot; + Copyright.getFromYear() + &quot; - &quot; + Copyright.getToYear() + &quot;&lt;br&gt;&quot; + Copyright.getOwner() + &quot;&lt;br&gt;&quot;</span>
<span class="nc" id="L306">      + Copyright.getAddress() + Messages.getInstance().getString(&quot;GUIChooser_Information_Text_End&quot;);</span>

<span class="nc" id="L308">    JLabel infoLab = new JLabel(infoString);</span>
<span class="nc" id="L309">    infoLab.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));</span>
<span class="nc" id="L310">    wekaPan.add(infoLab, BorderLayout.SOUTH);</span>
    
<span class="nc" id="L312">    this.getContentPane().add(wekaPan, BorderLayout.CENTER);</span>

    // Menu bar
<span class="nc" id="L315">    m_jMenuBar = new JMenuBar();</span>
    
    // Program
<span class="nc" id="L318">    m_jMenuProgram = new JMenu();</span>
<span class="nc" id="L319">    m_jMenuBar.add(m_jMenuProgram);</span>
<span class="nc" id="L320">    m_jMenuProgram.setText(Messages.getInstance().getString(&quot;GUIChooser_Program_Text&quot;));</span>
<span class="nc" id="L321">    m_jMenuProgram.setMnemonic('P');</span>
    
    // Program/LogWindow
<span class="nc" id="L324">    JMenuItem jMenuItemProgramLogWindow = new JMenuItem();</span>
<span class="nc" id="L325">    m_jMenuProgram.add(jMenuItemProgramLogWindow);</span>
<span class="nc" id="L326">    jMenuItemProgramLogWindow.setText(Messages.getInstance().getString(&quot;GUIChooser_LogWindow_Text&quot;));</span>
    //jMenuItemProgramLogWindow.setMnemonic('L');
<span class="nc" id="L328">    jMenuItemProgramLogWindow.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_L, KeyEvent.CTRL_MASK));</span>
<span class="nc" id="L329">    m_LogWindow.setIconImage(m_Icon);</span>
<span class="nc" id="L330">    jMenuItemProgramLogWindow.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L332">        m_LogWindow.setVisible(true);</span>
<span class="nc" id="L333">      }</span>
    });
    
<span class="nc" id="L336">    final JMenuItem jMenuItemProgramMemUsage = new JMenuItem();</span>
<span class="nc" id="L337">    m_jMenuProgram.add(jMenuItemProgramMemUsage);</span>
<span class="nc" id="L338">    jMenuItemProgramMemUsage.setText(Messages.getInstance().getString(&quot;GUIChooser_Memory_Usage_Text&quot;));</span>
    //jMenuItemProgramMemUsage.setMnemonic('M');
<span class="nc" id="L340">    jMenuItemProgramMemUsage.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_M, KeyEvent.CTRL_MASK));</span>
    
<span class="nc" id="L342">    jMenuItemProgramMemUsage.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L344" title="All 2 branches missed.">        if (m_MemoryUsageFrame == null) {</span>
<span class="nc" id="L345">          final MemoryUsagePanel panel = new MemoryUsagePanel(); </span>
<span class="nc" id="L346">          jMenuItemProgramMemUsage.setEnabled(false);</span>
<span class="nc" id="L347">          m_MemoryUsageFrame = new JFrame(Messages.getInstance().getString(&quot;GUIChooser_Memory_Usage_List_Text&quot;));</span>
<span class="nc" id="L348">          m_MemoryUsageFrame.setIconImage(m_Icon);</span>
<span class="nc" id="L349">          m_MemoryUsageFrame.getContentPane().setLayout(new BorderLayout());</span>
<span class="nc" id="L350">          m_MemoryUsageFrame.getContentPane().add(panel, BorderLayout.CENTER);</span>
<span class="nc" id="L351">          m_MemoryUsageFrame.addWindowListener(new WindowAdapter() {</span>
            public void windowClosing(WindowEvent w) {
<span class="nc" id="L353">              panel.stopMonitoring();</span>
<span class="nc" id="L354">              m_MemoryUsageFrame.dispose();</span>
<span class="nc" id="L355">              m_MemoryUsageFrame = null;</span>
<span class="nc" id="L356">              jMenuItemProgramMemUsage.setEnabled(true);</span>
<span class="nc" id="L357">              checkExit();</span>
<span class="nc" id="L358">            }</span>
          });
<span class="nc" id="L360">          m_MemoryUsageFrame.pack();</span>
<span class="nc" id="L361">          m_MemoryUsageFrame.setSize(400, 50);</span>
<span class="nc" id="L362">          Point l = panel.getFrameLocation();</span>
<span class="nc bnc" id="L363" title="All 4 branches missed.">          if ((l.x != -1) &amp;&amp; (l.y != -1))</span>
<span class="nc" id="L364">            m_MemoryUsageFrame.setLocation(l);</span>
<span class="nc" id="L365">          m_MemoryUsageFrame.setVisible(true);</span>
<span class="nc" id="L366">          Dimension size = m_MemoryUsageFrame.getPreferredSize();</span>
<span class="nc" id="L367">          m_MemoryUsageFrame.setSize(new Dimension((int) size.getWidth(), (int) size.getHeight()));</span>
        }
<span class="nc" id="L369">      }</span>
    });
    
<span class="nc" id="L372">    m_jMenuProgram.add(new JSeparator());</span>
    
    // Program/Exit
<span class="nc" id="L375">    JMenuItem jMenuItemProgramExit = new JMenuItem();</span>
<span class="nc" id="L376">    m_jMenuProgram.add(jMenuItemProgramExit);</span>
<span class="nc" id="L377">    jMenuItemProgramExit.setText(Messages.getInstance().getString(&quot;GUIChooser_Exit_Text&quot;));</span>
//    jMenuItemProgramExit.setMnemonic('E');
<span class="nc" id="L379">    jMenuItemProgramExit.</span>
<span class="nc" id="L380">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_E, KeyEvent.CTRL_MASK));</span>
<span class="nc" id="L381">    jMenuItemProgramExit.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L383">        dispose();</span>
<span class="nc" id="L384">        checkExit();</span>
<span class="nc" id="L385">      }</span>
    });
    
    // Visualization
<span class="nc" id="L389">    m_jMenuVisualization = new JMenu();</span>
<span class="nc" id="L390">    m_jMenuBar.add(m_jMenuVisualization);</span>
<span class="nc" id="L391">    m_jMenuVisualization.setText(Messages.getString(&quot;GUIChooser_Visualization_Text&quot;)); // &quot;Visualization&quot;</span>
<span class="nc" id="L392">    m_jMenuVisualization.setMnemonic('V');</span>
    
    // Visualization/Plot
<span class="nc" id="L395">    JMenuItem jMenuItemVisualizationPlot = new JMenuItem();</span>
<span class="nc" id="L396">    m_jMenuVisualization.add(jMenuItemVisualizationPlot);</span>
<span class="nc" id="L397">    jMenuItemVisualizationPlot.setText(Messages.getInstance().getString(&quot;GUIChooser_Plot_Text&quot;));</span>
    //jMenuItemVisualizationPlot.setMnemonic('P');
<span class="nc" id="L399">    jMenuItemVisualizationPlot.</span>
<span class="nc" id="L400">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_P, KeyEvent.CTRL_MASK));</span>
    
<span class="nc" id="L402">    jMenuItemVisualizationPlot.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
        // choose file
<span class="nc" id="L405">        int retVal = m_FileChooserPlot.showOpenDialog(m_Self);</span>
<span class="nc bnc" id="L406" title="All 2 branches missed.">        if (retVal != JFileChooser.APPROVE_OPTION)</span>
<span class="nc" id="L407">          return;</span>

        // build plot
<span class="nc" id="L410">        VisualizePanel panel = new VisualizePanel();</span>
<span class="nc" id="L411">        String filenames = &quot;&quot;;</span>
<span class="nc" id="L412">        File[] files = m_FileChooserPlot.getSelectedFiles();</span>
<span class="nc bnc" id="L413" title="All 2 branches missed.">        for (int j = 0; j &lt; files.length; j++) {</span>
<span class="nc" id="L414">          String filename = files[j].getAbsolutePath();</span>
<span class="nc bnc" id="L415" title="All 2 branches missed.">          if (j &gt; 0)</span>
<span class="nc" id="L416">            filenames += &quot;, &quot;;</span>
<span class="nc" id="L417">          filenames += filename;</span>
<span class="nc" id="L418">          System.err.println(Messages.getInstance().getString(&quot;GUIChooser_LoadingInstancesFrom_Error_Text&quot;) + filename);</span>
          
          try {
<span class="nc" id="L421">            Reader r = new java.io.BufferedReader(new FileReader(filename));</span>
<span class="nc" id="L422">            Instances i = new Instances(r);</span>
<span class="nc" id="L423">            i.setClassIndex(i.numAttributes()-1);</span>
<span class="nc" id="L424">            PlotData2D pd1 = new PlotData2D(i);</span>

<span class="nc bnc" id="L426" title="All 2 branches missed.">            if (j == 0) {</span>
<span class="nc" id="L427">              pd1.setPlotName(Messages.getInstance().getString(&quot;GUIChooser_MasterPlot_Text&quot;));</span>
<span class="nc" id="L428">              panel.setMasterPlot(pd1);</span>
            } else {
<span class="nc" id="L430">              pd1.setPlotName(Messages.getInstance().getString(&quot;GUIChooser_Plot_Text&quot;) + (j+1));</span>
<span class="nc" id="L431">              pd1.m_useCustomColour = true;</span>
<span class="nc bnc" id="L432" title="All 2 branches missed.">              pd1.m_customColour = (j % 2 == 0) ? Color.red : Color.blue; </span>
<span class="nc" id="L433">              panel.addPlot(pd1);</span>
            }
          }
<span class="nc" id="L436">          catch (Exception ex) {</span>
<span class="nc" id="L437">            ex.printStackTrace();</span>
<span class="nc" id="L438">            JOptionPane.showMessageDialog(</span>
<span class="nc" id="L439">                m_Self, Messages.getInstance().getString(&quot;GUIChooser_Plot_LoadingFile_Error_Text_Front&quot;) + files[j] + Messages.getInstance().getString(&quot;GUIChooser_Plot_LoadingFile_Error_Text_End&quot;) + ex.getMessage());</span>
<span class="nc" id="L440">            return;</span>
          }
        }

        // create frame
<span class="nc" id="L445">        final JFrame frame = new JFrame(Messages.getInstance().getString(&quot;GUIChooser_Plot_PlotName_Text&quot;) + filenames);</span>
<span class="nc" id="L446">        frame.setIconImage(m_Icon);</span>
<span class="nc" id="L447">        frame.getContentPane().setLayout(new BorderLayout());</span>
<span class="nc" id="L448">        frame.getContentPane().add(panel, BorderLayout.CENTER);</span>
<span class="nc" id="L449">        frame.addWindowListener(new WindowAdapter() {</span>
          public void windowClosing(WindowEvent e) {
<span class="nc" id="L451">            m_Plots.remove(frame);</span>
<span class="nc" id="L452">            frame.dispose();</span>
<span class="nc" id="L453">            checkExit();</span>
<span class="nc" id="L454">          }</span>
        });
<span class="nc" id="L456">        frame.pack();</span>
<span class="nc" id="L457">        frame.setSize(800, 600);</span>
<span class="nc" id="L458">        frame.setVisible(true);</span>
<span class="nc" id="L459">        m_Plots.add(frame);</span>
<span class="nc" id="L460">      }</span>
    });
    
    // Visualization/ROC
<span class="nc" id="L464">    JMenuItem jMenuItemVisualizationROC = new JMenuItem();</span>
<span class="nc" id="L465">    m_jMenuVisualization.add(jMenuItemVisualizationROC);</span>
<span class="nc" id="L466">    jMenuItemVisualizationROC.setText(Messages.getInstance().getString(&quot;GUIChooser_ROC_Text&quot;));</span>
    // jMenuItemVisualizationROC.setMnemonic('R');
<span class="nc" id="L468">    jMenuItemVisualizationROC.</span>
<span class="nc" id="L469">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_R, KeyEvent.CTRL_MASK));</span>
    
<span class="nc" id="L471">    jMenuItemVisualizationROC.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
        // choose file
<span class="nc" id="L474">        int retVal = m_FileChooserROC.showOpenDialog(m_Self);</span>
<span class="nc bnc" id="L475" title="All 2 branches missed.">        if (retVal != JFileChooser.APPROVE_OPTION)</span>
<span class="nc" id="L476">          return;</span>

        // create plot
<span class="nc" id="L479">        String filename  = m_FileChooserROC.getSelectedFile().getAbsolutePath();</span>
<span class="nc" id="L480">        Instances result = null;</span>
        try {
<span class="nc" id="L482">          result = new Instances(new BufferedReader(new FileReader(filename)));</span>
        }
<span class="nc" id="L484">        catch (Exception ex) {</span>
<span class="nc" id="L485">          ex.printStackTrace();</span>
<span class="nc" id="L486">          JOptionPane.showMessageDialog(</span>
<span class="nc" id="L487">              m_Self, Messages.getInstance().getString(&quot;GUIChooser_ROC_LoadingFile_Error_Text_Front&quot;) + filename + Messages.getInstance().getString(&quot;GUIChooser_ROC_LoadingFile_Error_Text_End&quot;) + ex.getMessage());</span>
<span class="nc" id="L488">          return;</span>
        }
<span class="nc" id="L490">        result.setClassIndex(result.numAttributes() - 1);</span>
<span class="nc" id="L491">        ThresholdVisualizePanel vmc = new ThresholdVisualizePanel();</span>
<span class="nc" id="L492">        vmc.setROCString(Messages.getInstance().getString(&quot;GUIChooser_ROC_AreaUnderROC_Text_Front&quot;) + </span>
<span class="nc" id="L493">            Utils.doubleToString(ThresholdCurve.getROCArea(result), 4) + Messages.getInstance().getString(&quot;GUIChooser_ROC_AreaUnderROC_Text_End&quot;));</span>
<span class="nc" id="L494">        vmc.setName(result.relationName());</span>
<span class="nc" id="L495">        PlotData2D tempd = new PlotData2D(result);</span>
<span class="nc" id="L496">        tempd.setPlotName(result.relationName());</span>
<span class="nc" id="L497">        tempd.addInstanceNumberAttribute();</span>
        try {
<span class="nc" id="L499">          vmc.addPlot(tempd);</span>
        }
<span class="nc" id="L501">        catch (Exception ex) {</span>
<span class="nc" id="L502">          ex.printStackTrace();</span>
<span class="nc" id="L503">          JOptionPane.showMessageDialog(</span>
<span class="nc" id="L504">              m_Self, Messages.getInstance().getString(&quot;GUIChooser_ROC_AddingPlot_Error_Text&quot;) + ex.getMessage());</span>
<span class="nc" id="L505">          return;</span>
        }

<span class="nc" id="L508">        final JFrame frame = new JFrame(Messages.getInstance().getString(&quot;GUIChooser_ROC_File_Text&quot;) + filename);</span>
<span class="nc" id="L509">        frame.setIconImage(m_Icon);</span>
<span class="nc" id="L510">        frame.getContentPane().setLayout(new BorderLayout());</span>
<span class="nc" id="L511">        frame.getContentPane().add(vmc, BorderLayout.CENTER);</span>
<span class="nc" id="L512">        frame.addWindowListener(new WindowAdapter() {</span>
          public void windowClosing(WindowEvent e) {
<span class="nc" id="L514">            m_ROCs.remove(frame);</span>
<span class="nc" id="L515">            frame.dispose();</span>
<span class="nc" id="L516">            checkExit();</span>
<span class="nc" id="L517">          }</span>
        });
<span class="nc" id="L519">        frame.pack();</span>
<span class="nc" id="L520">        frame.setSize(800, 600);</span>
<span class="nc" id="L521">        frame.setVisible(true);</span>
<span class="nc" id="L522">        m_ROCs.add(frame);</span>
<span class="nc" id="L523">      }</span>
    });
    
    // Visualization/TreeVisualizer
<span class="nc" id="L527">    JMenuItem jMenuItemVisualizationTree = new JMenuItem();</span>
<span class="nc" id="L528">    m_jMenuVisualization.add(jMenuItemVisualizationTree);</span>
<span class="nc" id="L529">    jMenuItemVisualizationTree.setText(Messages.getInstance().getString(&quot;GUIChooser_TreeVisualizer_Text&quot;));</span>
    // jMenuItemVisualizationTree.setMnemonic('T');
<span class="nc" id="L531">    jMenuItemVisualizationTree.</span>
<span class="nc" id="L532">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_T, KeyEvent.CTRL_MASK));</span>
    
<span class="nc" id="L534">    jMenuItemVisualizationTree.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
        // choose file
<span class="nc" id="L537">        int retVal = m_FileChooserTreeVisualizer.showOpenDialog(m_Self);</span>
<span class="nc bnc" id="L538" title="All 2 branches missed.">        if (retVal != JFileChooser.APPROVE_OPTION)</span>
<span class="nc" id="L539">          return;</span>

        // build tree
<span class="nc" id="L542">        String filename = m_FileChooserTreeVisualizer.getSelectedFile().getAbsolutePath();</span>
<span class="nc" id="L543">        TreeBuild builder = new TreeBuild();</span>
<span class="nc" id="L544">        Node top = null;</span>
<span class="nc" id="L545">        NodePlace arrange = new PlaceNode2();</span>
        try {
<span class="nc" id="L547">          top = builder.create(new FileReader(filename));</span>
        }
<span class="nc" id="L549">        catch (Exception ex) {</span>
<span class="nc" id="L550">          ex.printStackTrace();</span>
<span class="nc" id="L551">          JOptionPane.showMessageDialog(</span>
<span class="nc" id="L552">              m_Self, Messages.getInstance().getString(&quot;GUIChooser_TreeVisualizer_LoadingFile_Error_Text_Front&quot;) + filename + Messages.getInstance().getString(&quot;GUIChooser_TreeVisualizer_LoadingFile_Error_Text_End&quot;) + ex.getMessage());</span>
<span class="nc" id="L553">          return;</span>
        }

        // create frame
<span class="nc" id="L557">        final JFrame frame = new JFrame(Messages.getInstance().getString(&quot;GUIChooser_TreeVisualizer_File_Text&quot;) + filename);</span>
<span class="nc" id="L558">        frame.setIconImage(m_Icon);</span>
<span class="nc" id="L559">        frame.getContentPane().setLayout(new BorderLayout());</span>
<span class="nc" id="L560">        frame.getContentPane().add(new TreeVisualizer(null, top, arrange), BorderLayout.CENTER);</span>
<span class="nc" id="L561">        frame.addWindowListener(new WindowAdapter() {</span>
          public void windowClosing(WindowEvent e) {
<span class="nc" id="L563">            m_TreeVisualizers.remove(frame);</span>
<span class="nc" id="L564">            frame.dispose();</span>
<span class="nc" id="L565">            checkExit();</span>
<span class="nc" id="L566">          }</span>
        });
<span class="nc" id="L568">        frame.pack();</span>
<span class="nc" id="L569">        frame.setSize(800, 600);</span>
<span class="nc" id="L570">        frame.setVisible(true);</span>
<span class="nc" id="L571">        m_TreeVisualizers.add(frame);</span>
<span class="nc" id="L572">      }</span>
    });
    
    // Visualization/GraphVisualizer
<span class="nc" id="L576">    JMenuItem jMenuItemVisualizationGraph = new JMenuItem();</span>
<span class="nc" id="L577">    m_jMenuVisualization.add(jMenuItemVisualizationGraph);</span>
<span class="nc" id="L578">    jMenuItemVisualizationGraph.setText(Messages.getInstance().getString(&quot;GUIChooser_GraphVisualizer_Text&quot;));</span>
 //   jMenuItemVisualizationGraph.setMnemonic('G');
<span class="nc" id="L580">    jMenuItemVisualizationGraph.</span>
<span class="nc" id="L581">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_G, KeyEvent.CTRL_MASK));</span>
    
<span class="nc" id="L583">    jMenuItemVisualizationGraph.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
        // choose file
<span class="nc" id="L586">        int retVal = m_FileChooserGraphVisualizer.showOpenDialog(m_Self);</span>
<span class="nc bnc" id="L587" title="All 2 branches missed.">        if (retVal != JFileChooser.APPROVE_OPTION)</span>
<span class="nc" id="L588">          return;</span>

        // build graph
<span class="nc" id="L591">        String filename = m_FileChooserGraphVisualizer.getSelectedFile().getAbsolutePath();</span>
<span class="nc" id="L592">        GraphVisualizer panel = new GraphVisualizer();</span>
        try{
<span class="nc bnc" id="L594" title="All 2 branches missed.">          if (    filename.toLowerCase().endsWith(&quot;.xml&quot;) </span>
<span class="nc bnc" id="L595" title="All 2 branches missed.">              || filename.toLowerCase().endsWith(&quot;.bif&quot;) ) {</span>
<span class="nc" id="L596">            panel.readBIF(new FileInputStream(filename));</span>
          }
          else {
<span class="nc" id="L599">            panel.readDOT(new FileReader(filename));</span>
          }
        }
<span class="nc" id="L602">        catch (Exception ex) {</span>
<span class="nc" id="L603">          ex.printStackTrace();</span>
<span class="nc" id="L604">          JOptionPane.showMessageDialog(</span>
<span class="nc" id="L605">             m_Self, Messages.getInstance().getString(&quot;GUIChooser_GraphVisualizer_LoadingFile_Error_Text_Front&quot;) + filename + Messages.getInstance().getString(&quot;GUIChooser_GraphVisualizer_LoadingFile_Error_Text_End&quot;) + ex.getMessage());</span>
<span class="nc" id="L606">          return;</span>
        }

        // create frame
<span class="nc" id="L610">        final JFrame frame = new JFrame(Messages.getInstance().getString(&quot;GUIChooser_GraphVisualizer_File_Text&quot;) + filename);</span>
<span class="nc" id="L611">        frame.setIconImage(m_Icon);</span>
<span class="nc" id="L612">        frame.getContentPane().setLayout(new BorderLayout());</span>
<span class="nc" id="L613">        frame.getContentPane().add(panel, BorderLayout.CENTER);</span>
<span class="nc" id="L614">        frame.addWindowListener(new WindowAdapter() {</span>
          public void windowClosing(WindowEvent e) {
<span class="nc" id="L616">            m_GraphVisualizers.remove(frame);</span>
<span class="nc" id="L617">            frame.dispose();</span>
<span class="nc" id="L618">            checkExit();</span>
<span class="nc" id="L619">          }</span>
        });
<span class="nc" id="L621">        frame.pack();</span>
<span class="nc" id="L622">        frame.setSize(800, 600);</span>
<span class="nc" id="L623">        frame.setVisible(true);</span>
<span class="nc" id="L624">        m_GraphVisualizers.add(frame);</span>
<span class="nc" id="L625">      }</span>
    });
    
    // Visualization/BoundaryVisualizer
<span class="nc" id="L629">    final JMenuItem jMenuItemVisualizationBoundary = new JMenuItem();</span>
<span class="nc" id="L630">    m_jMenuVisualization.add(jMenuItemVisualizationBoundary);</span>
<span class="nc" id="L631">    jMenuItemVisualizationBoundary.setText(Messages.getInstance().getString(&quot;GUIChooser_BoundaryVisualizer_Text&quot;));</span>
    // jMenuItemVisualizationBoundary.setMnemonic('B');
<span class="nc" id="L633">    jMenuItemVisualizationBoundary.</span>
<span class="nc" id="L634">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_B, KeyEvent.CTRL_MASK));</span>
    
<span class="nc" id="L636">    jMenuItemVisualizationBoundary.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L638" title="All 2 branches missed.">        if (m_BoundaryVisualizerFrame == null) {</span>
<span class="nc" id="L639">          jMenuItemVisualizationBoundary.setEnabled(false);</span>
<span class="nc" id="L640">          m_BoundaryVisualizerFrame = new JFrame(Messages.getInstance().getString(&quot;GUIChooser_BoundaryVisualizer_JFrame_Text&quot;));</span>
<span class="nc" id="L641">          m_BoundaryVisualizerFrame.setIconImage(m_Icon);</span>
<span class="nc" id="L642">          m_BoundaryVisualizerFrame.getContentPane().setLayout(new BorderLayout());</span>
          
<span class="nc" id="L644">          final BoundaryVisualizer bv = new BoundaryVisualizer();</span>
<span class="nc" id="L645">          m_BoundaryVisualizerFrame.getContentPane().add(bv, BorderLayout.CENTER);</span>
<span class="nc" id="L646">          m_BoundaryVisualizerFrame.setSize(bv.getMinimumSize());</span>
<span class="nc" id="L647">          m_BoundaryVisualizerFrame.addWindowListener(new WindowAdapter() {</span>
            public void windowClosing(WindowEvent w) {
<span class="nc" id="L649">              bv.stopPlotting();</span>
<span class="nc" id="L650">              m_BoundaryVisualizerFrame.dispose();</span>
<span class="nc" id="L651">              m_BoundaryVisualizerFrame = null;</span>
<span class="nc" id="L652">              jMenuItemVisualizationBoundary.setEnabled(true);</span>
<span class="nc" id="L653">              checkExit();</span>
<span class="nc" id="L654">            }</span>
          });
<span class="nc" id="L656">          m_BoundaryVisualizerFrame.pack();</span>
          //m_BoundaryVisualizerFrame.setSize(800, 600);
<span class="nc" id="L658">          m_BoundaryVisualizerFrame.setResizable(false);</span>
<span class="nc" id="L659">          m_BoundaryVisualizerFrame.setVisible(true);</span>
          // dont' do a System.exit after last window got closed!
<span class="nc" id="L661">          BoundaryVisualizer.setExitIfNoWindowsOpen(false);</span>
        }
<span class="nc" id="L663">      }</span>
    });
    
    // Extensions
<span class="nc" id="L667">    JMenu jMenuExtensions = new JMenu(Messages.getInstance().getString(&quot;GUIChooser_Extensions_Text&quot;));</span>
<span class="nc" id="L668">    jMenuExtensions.setMnemonic(java.awt.event.KeyEvent.VK_E);</span>
<span class="nc" id="L669">    m_jMenuBar.add(jMenuExtensions);</span>
<span class="nc" id="L670">    jMenuExtensions.setVisible(false);</span>
    
<span class="nc" id="L672">    String extensions = GenericObjectEditor.EDITOR_PROPERTIES.getProperty(</span>
<span class="nc" id="L673">        MainMenuExtension.class.getName(), &quot;&quot;);</span>

<span class="nc bnc" id="L675" title="All 2 branches missed.">    if (extensions.length() &gt; 0) {</span>
<span class="nc" id="L676">      jMenuExtensions.setVisible(true);</span>
<span class="nc" id="L677">      String[] classnames = GenericObjectEditor.EDITOR_PROPERTIES.getProperty(</span>
<span class="nc" id="L678">          MainMenuExtension.class.getName(), &quot;&quot;).split(&quot;,&quot;);</span>
<span class="nc" id="L679">      Hashtable&lt;String,JMenu&gt; submenus = new Hashtable&lt;String,JMenu&gt;();</span>

      // add all extensions
<span class="nc bnc" id="L682" title="All 2 branches missed.">      for (int i = 0; i &lt; classnames.length; i++) {</span>
<span class="nc" id="L683">        String classname = classnames[i];</span>
        try {
<span class="nc" id="L685">          MainMenuExtension ext = (MainMenuExtension) Class.forName(classname).newInstance();</span>

          // menuitem in a submenu?
<span class="nc" id="L688">          JMenu submenu = null;</span>
<span class="nc bnc" id="L689" title="All 2 branches missed.">          if (ext.getSubmenuTitle() != null) {</span>
<span class="nc" id="L690">            submenu = submenus.get(ext.getSubmenuTitle());</span>
<span class="nc bnc" id="L691" title="All 2 branches missed.">            if (submenu == null) {</span>
<span class="nc" id="L692">              submenu = new JMenu(ext.getSubmenuTitle());</span>
<span class="nc" id="L693">              submenus.put(ext.getSubmenuTitle(), submenu);</span>
<span class="nc" id="L694">              insertMenuItem(jMenuExtensions, submenu);</span>
            }
          }

          // create menu item
<span class="nc" id="L699">          JMenuItem menuitem = new JMenuItem();</span>
<span class="nc" id="L700">          menuitem.setText(ext.getMenuTitle());</span>
          // does the extension need a frame or does it have its own ActionListener?
<span class="nc" id="L702">          ActionListener listener = ext.getActionListener(m_Self);</span>
<span class="nc bnc" id="L703" title="All 2 branches missed.">          if (listener != null) {</span>
<span class="nc" id="L704">            menuitem.addActionListener(listener);</span>
          }
          else {
<span class="nc" id="L707">            final JMenuItem finalMenuitem = menuitem;</span>
<span class="nc" id="L708">            final MainMenuExtension finalExt = ext;</span>
<span class="nc" id="L709">            menuitem.addActionListener(new ActionListener() {</span>
              public void actionPerformed(ActionEvent e) {
<span class="nc" id="L711">                Component frame = createFrame(</span>
<span class="nc" id="L712">                    m_Self, finalMenuitem.getText(), </span>
<span class="nc" id="L713">                    null, null, null, -1, -1, null, false, false);</span>
<span class="nc" id="L714">                finalExt.fillFrame(frame);</span>
<span class="nc" id="L715">                frame.setVisible(true);</span>
<span class="nc" id="L716">              }</span>
            });
          }

          // sorted insert of menu item
<span class="nc bnc" id="L721" title="All 2 branches missed.">          if (submenu != null)</span>
<span class="nc" id="L722">            insertMenuItem(submenu, menuitem);</span>
          else
<span class="nc" id="L724">            insertMenuItem(jMenuExtensions, menuitem);</span>
        }
<span class="nc" id="L726">        catch (Exception e) {</span>
<span class="nc" id="L727">          e.printStackTrace();</span>
        }
      }
    }
    
    // Tools
<span class="nc" id="L733">    m_jMenuTools = new JMenu();</span>
<span class="nc" id="L734">    m_jMenuBar.add(m_jMenuTools);</span>
<span class="nc" id="L735">    m_jMenuTools.setText(Messages.getInstance().getString(&quot;GUIChooser_Tools_Text&quot;));</span>
<span class="nc" id="L736">    m_jMenuTools.setMnemonic('T');</span>
    
    // Tools/ArffViewer
<span class="nc" id="L739">    JMenuItem jMenuItemToolsArffViewer = new JMenuItem();</span>
<span class="nc" id="L740">    m_jMenuTools.add(jMenuItemToolsArffViewer);</span>
<span class="nc" id="L741">    jMenuItemToolsArffViewer.setText(Messages.getInstance().getString(&quot;GUIChooser_ArffViewer_Text&quot;));</span>
    // jMenuItemToolsArffViewer.setMnemonic('A');
<span class="nc" id="L743">    jMenuItemToolsArffViewer.</span>
<span class="nc" id="L744">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_A, KeyEvent.CTRL_MASK));</span>
    
<span class="nc" id="L746">    jMenuItemToolsArffViewer.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L748">        final ArffViewer av = new ArffViewer();</span>
<span class="nc" id="L749">        av.addWindowListener(new WindowAdapter() {</span>
          public void windowClosing(WindowEvent w) {
<span class="nc" id="L751">            m_ArffViewers.remove(av);</span>
<span class="nc" id="L752">            checkExit();</span>
<span class="nc" id="L753">          }</span>
        });
<span class="nc" id="L755">        av.setVisible(true);</span>
<span class="nc" id="L756">        m_ArffViewers.add(av);</span>
<span class="nc" id="L757">      }</span>
    });
    
    // Tools/SqlViewer
<span class="nc" id="L761">    final JMenuItem jMenuItemToolsSql = new JMenuItem();</span>
<span class="nc" id="L762">    m_jMenuTools.add(jMenuItemToolsSql);</span>
<span class="nc" id="L763">    jMenuItemToolsSql.setText(Messages.getInstance().getString(&quot;GUIChooser_SqlViewer_Text&quot;));</span>
    // jMenuItemToolsSql.setMnemonic('S');
<span class="nc" id="L765">    jMenuItemToolsSql.</span>
<span class="nc" id="L766">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_S, KeyEvent.CTRL_MASK));</span>
    
<span class="nc" id="L768">    jMenuItemToolsSql.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L770" title="All 2 branches missed.">        if (m_SqlViewerFrame == null) {</span>
<span class="nc" id="L771">          jMenuItemToolsSql.setEnabled(false);</span>
<span class="nc" id="L772">          final SqlViewer sql = new SqlViewer(null);</span>
<span class="nc" id="L773">          m_SqlViewerFrame = new JFrame(Messages.getInstance().getString(&quot;GUIChooser_SqlViewer_JFrame_Text&quot;));</span>
<span class="nc" id="L774">          m_SqlViewerFrame.setIconImage(m_Icon);</span>
<span class="nc" id="L775">          m_SqlViewerFrame.getContentPane().setLayout(new BorderLayout());</span>
<span class="nc" id="L776">          m_SqlViewerFrame.getContentPane().add(sql, BorderLayout.CENTER);</span>
<span class="nc" id="L777">          m_SqlViewerFrame.addWindowListener(new WindowAdapter() {</span>
            public void windowClosing(WindowEvent w) {
<span class="nc" id="L779">              sql.saveSize();</span>
<span class="nc" id="L780">              m_SqlViewerFrame.dispose();</span>
<span class="nc" id="L781">              m_SqlViewerFrame = null;</span>
<span class="nc" id="L782">              jMenuItemToolsSql.setEnabled(true);</span>
<span class="nc" id="L783">              checkExit();</span>
<span class="nc" id="L784">            }</span>
          });
<span class="nc" id="L786">          m_SqlViewerFrame.pack();</span>
<span class="nc" id="L787">          m_SqlViewerFrame.setVisible(true);</span>
        }
<span class="nc" id="L789">      }</span>
    });
    
    // Tools/Bayes net editor
<span class="nc" id="L793">    final JMenuItem jMenuItemBayesNet = new JMenuItem();</span>
<span class="nc" id="L794">    m_jMenuTools.add(jMenuItemBayesNet);</span>
<span class="nc" id="L795">    jMenuItemBayesNet.setText(Messages.getInstance().getString(&quot;GUIChooser_BayesNetEditor_Text&quot;));</span>
<span class="nc" id="L796">    jMenuItemBayesNet.</span>
<span class="nc" id="L797">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_N, KeyEvent.CTRL_MASK));</span>
<span class="nc" id="L798">    jMenuItemBayesNet.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L800" title="All 2 branches missed.">        if (m_BayesNetGUIFrame == null) {</span>
<span class="nc" id="L801">          jMenuItemBayesNet.setEnabled(false);</span>
<span class="nc" id="L802">          final GUI bayesNetGUI = new GUI();</span>
<span class="nc" id="L803">          JMenuBar bayesBar = bayesNetGUI.getMenuBar();</span>
<span class="nc" id="L804">          m_BayesNetGUIFrame = new JFrame(Messages.getInstance().getString(&quot;GUIChooser_BayesNetworkEditor_JFrame_Text&quot;));</span>
<span class="nc" id="L805">          m_BayesNetGUIFrame.setIconImage(m_Icon);</span>
<span class="nc" id="L806">          m_BayesNetGUIFrame.setJMenuBar(bayesBar);</span>
<span class="nc" id="L807">          m_BayesNetGUIFrame.getContentPane().add(bayesNetGUI, BorderLayout.CENTER);</span>
<span class="nc" id="L808">          m_BayesNetGUIFrame.addWindowListener(new WindowAdapter() {</span>
            public void windowClosing(WindowEvent w) {
<span class="nc" id="L810">              m_BayesNetGUIFrame.dispose();</span>
<span class="nc" id="L811">              m_BayesNetGUIFrame = null;</span>
<span class="nc" id="L812">              jMenuItemBayesNet.setEnabled(true);</span>
<span class="nc" id="L813">              checkExit();</span>
<span class="nc" id="L814">            }</span>
          });
<span class="nc" id="L816">          m_BayesNetGUIFrame.setSize(800, 600);</span>
<span class="nc" id="L817">          m_BayesNetGUIFrame.setVisible(true);</span>
        }
<span class="nc" id="L819">      }</span>
    });
    
    // Help
<span class="nc" id="L823">    m_jMenuHelp = new JMenu();</span>
<span class="nc" id="L824">    m_jMenuBar.add(m_jMenuHelp);</span>
<span class="nc" id="L825">    m_jMenuHelp.setText(Messages.getInstance().getString(&quot;GUIChooser_Help_Text&quot;));</span>
<span class="nc" id="L826">    m_jMenuHelp.setMnemonic('H');</span>
    
    // Help/Homepage
<span class="nc" id="L829">    JMenuItem jMenuItemHelpHomepage = new JMenuItem();</span>
<span class="nc" id="L830">    m_jMenuHelp.add(jMenuItemHelpHomepage);</span>
<span class="nc" id="L831">    jMenuItemHelpHomepage.setText(Messages.getInstance().getString(&quot;GUIChooser_WekaHomepage_Text&quot;));</span>
    // jMenuItemHelpHomepage.setMnemonic('H');
<span class="nc" id="L833">    jMenuItemHelpHomepage.</span>
<span class="nc" id="L834">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_H, KeyEvent.CTRL_MASK));</span>
<span class="nc" id="L835">    jMenuItemHelpHomepage.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L837">        BrowserHelper.openURL(Messages.getInstance().getString(&quot;GUIChooser_WekaHomepage_URL_Text&quot;));</span>
<span class="nc" id="L838">      }</span>
    });
    
<span class="nc" id="L841">    m_jMenuHelp.add(new JSeparator());</span>
    
    // Help/WekaWiki
<span class="nc" id="L844">    JMenuItem jMenuItemHelpWekaWiki = new JMenuItem();</span>
<span class="nc" id="L845">    m_jMenuHelp.add(jMenuItemHelpWekaWiki);</span>
<span class="nc" id="L846">    jMenuItemHelpWekaWiki.setText(Messages.getInstance().getString(&quot;GUIChooser_WekaHOWTO_Text&quot;));</span>
    // jMenuItemHelpWekaWiki.setMnemonic('W');
<span class="nc" id="L848">    jMenuItemHelpWekaWiki.</span>
<span class="nc" id="L849">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_W, KeyEvent.CTRL_MASK));</span>
    
<span class="nc" id="L851">    jMenuItemHelpWekaWiki.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L853">        BrowserHelper.openURL(Messages.getInstance().getString(&quot;GUIChooser_WekaWiki_URL_Text&quot;));</span>
<span class="nc" id="L854">      }</span>
    });
    
    // Help/Sourceforge
<span class="nc" id="L858">    JMenuItem jMenuItemHelpSourceforge = new JMenuItem();</span>
<span class="nc" id="L859">    m_jMenuHelp.add(jMenuItemHelpSourceforge);</span>
<span class="nc" id="L860">    jMenuItemHelpSourceforge.setText(Messages.getInstance().getString(&quot;GUIChooser_WekaOnSourceforge_Text&quot;));</span>
//    jMenuItemHelpSourceforge.setMnemonic('F');
<span class="nc" id="L862">    jMenuItemHelpSourceforge.</span>
<span class="nc" id="L863">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_F, KeyEvent.CTRL_MASK));</span>
    
<span class="nc" id="L865">    jMenuItemHelpSourceforge.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L867">        BrowserHelper.openURL(Messages.getInstance().getString(&quot;GUIChooser_WekaOnSourceforge_URL_Text&quot;));</span>
<span class="nc" id="L868">      }</span>
    });
    
    // Help/SystemInfo
<span class="nc" id="L872">    final JMenuItem jMenuItemHelpSysInfo = new JMenuItem();</span>
<span class="nc" id="L873">    m_jMenuHelp.add(jMenuItemHelpSysInfo);</span>
<span class="nc" id="L874">    jMenuItemHelpSysInfo.setText(Messages.getInstance().getString(&quot;GUIChooser_SystemInfo_Text&quot;));</span>
//    jMenuItemHelpSysInfo.setMnemonic('S');
<span class="nc" id="L876">    jMenuItemHelpSysInfo.</span>
<span class="nc" id="L877">      setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_I, KeyEvent.CTRL_MASK));</span>
    
<span class="nc" id="L879">    jMenuItemHelpSysInfo.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L881" title="All 2 branches missed.">        if (m_SystemInfoFrame == null) {</span>
<span class="nc" id="L882">          jMenuItemHelpSysInfo.setEnabled(false);</span>
<span class="nc" id="L883">          m_SystemInfoFrame = new JFrame(Messages.getInstance().getString(&quot;GUIChooser_SystemInfo_JFrame_Text&quot;));</span>
<span class="nc" id="L884">          m_SystemInfoFrame.setIconImage(m_Icon);</span>
<span class="nc" id="L885">          m_SystemInfoFrame.getContentPane().setLayout(new BorderLayout());</span>

          // get info
<span class="nc" id="L888">          Hashtable info = new SystemInfo().getSystemInfo();</span>

          // sort names
<span class="nc" id="L891">          Vector names = new Vector();</span>
<span class="nc" id="L892">          Enumeration enm = info.keys();</span>
<span class="nc bnc" id="L893" title="All 2 branches missed.">          while (enm.hasMoreElements())</span>
<span class="nc" id="L894">            names.add(enm.nextElement());</span>
<span class="nc" id="L895">          Collections.sort(names);</span>

          // generate table
<span class="nc" id="L898">          String[][] data = new String[info.size()][2];</span>
<span class="nc bnc" id="L899" title="All 2 branches missed.">          for (int i = 0; i &lt; names.size(); i++) {</span>
<span class="nc" id="L900">            data[i][0] = names.get(i).toString();</span>
<span class="nc" id="L901">            data[i][1] = info.get(data[i][0]).toString();</span>
          }
   
<span class="nc" id="L904">          String[] titles = new String[]{Messages.getInstance().getString(&quot;GUIChooser_SystemInfo_TitleKey_Text&quot;), Messages.getInstance().getString(&quot;GUIChooser_SystemInfo_TitleValue_Text&quot;)};</span>
<span class="nc" id="L905">          JTable table = new JTable(data, titles);</span>

<span class="nc" id="L907">          m_SystemInfoFrame.getContentPane().add(new JScrollPane(table), BorderLayout.CENTER);</span>
<span class="nc" id="L908">          m_SystemInfoFrame.addWindowListener(new WindowAdapter() {</span>
            public void windowClosing(WindowEvent w) {
<span class="nc" id="L910">              m_SystemInfoFrame.dispose();</span>
<span class="nc" id="L911">              m_SystemInfoFrame = null;</span>
<span class="nc" id="L912">              jMenuItemHelpSysInfo.setEnabled(true);</span>
<span class="nc" id="L913">              checkExit();</span>
<span class="nc" id="L914">            }</span>
          });
<span class="nc" id="L916">          m_SystemInfoFrame.pack();</span>
<span class="nc" id="L917">          m_SystemInfoFrame.setSize(800, 600);</span>
<span class="nc" id="L918">          m_SystemInfoFrame.setVisible(true);</span>
        }
<span class="nc" id="L920">      }</span>
    });
    
    
    // applications

<span class="nc" id="L926">    m_ExplorerBut.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L928">        showExplorer(null);</span>
<span class="nc" id="L929">      }</span>
    });

<span class="nc" id="L932">    m_ExperimenterBut.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L934" title="All 2 branches missed.">	if (m_ExperimenterFrame == null) {</span>
<span class="nc" id="L935">		System.out.println(&quot;CALLED ExperimentEnvironment&quot;);</span>
		
<span class="nc" id="L937">	  m_ExperimenterBut.setEnabled(false);</span>
<span class="nc" id="L938">	  m_ExperimenterFrame = new JFrame(Messages.getInstance().getString(&quot;GUIChooser_WekaExperimentEnvironment_JFrame_Text&quot;));</span>
<span class="nc" id="L939">	  m_ExperimenterFrame.setIconImage(m_Icon);</span>
<span class="nc" id="L940">	  m_ExperimenterFrame.getContentPane().setLayout(new BorderLayout());</span>
<span class="nc" id="L941">	  m_ExperimenterFrame.getContentPane()</span>
<span class="nc" id="L942">	    .add(new Experimenter(false), BorderLayout.CENTER);</span>
<span class="nc" id="L943">	  m_ExperimenterFrame.addWindowListener(new WindowAdapter() {</span>
	    public void windowClosing(WindowEvent w) {
<span class="nc" id="L945">	      m_ExperimenterFrame.dispose();</span>
<span class="nc" id="L946">	      m_ExperimenterFrame = null;</span>
<span class="nc" id="L947">	      m_ExperimenterBut.setEnabled(true);</span>
<span class="nc" id="L948">	      checkExit();</span>
<span class="nc" id="L949">	    }</span>
	  });
<span class="nc" id="L951">	  m_ExperimenterFrame.pack();</span>
<span class="nc" id="L952">	  m_ExperimenterFrame.setSize(800, 600);</span>
<span class="nc" id="L953">	  m_ExperimenterFrame.setVisible(true);</span>
	}
<span class="nc" id="L955">      }</span>
    });

<span class="nc" id="L958">    KnowledgeFlowApp.addStartupListener(new weka.gui.beans.StartUpListener() {</span>
        public void startUpComplete() {
<span class="nc bnc" id="L960" title="All 2 branches missed.">          if (m_KnowledgeFlowFrame == null) {</span>
<span class="nc" id="L961">            final KnowledgeFlowApp kna = KnowledgeFlowApp.getSingleton();</span>
<span class="nc" id="L962">            m_KnowledgeFlowBut.setEnabled(false);</span>
<span class="nc bnc" id="L963" title="All 2 branches missed.">            if (m_pendingKnowledgeFlowLoad != null &amp;&amp; </span>
<span class="nc bnc" id="L964" title="All 2 branches missed.">                m_pendingKnowledgeFlowLoad.length() &gt; 0) {</span>
<span class="nc" id="L965">              KnowledgeFlowApp.getSingleton().</span>
<span class="nc" id="L966">                loadInitialLayout(m_pendingKnowledgeFlowLoad);</span>
<span class="nc" id="L967">              m_pendingKnowledgeFlowLoad = null;</span>
            }
<span class="nc" id="L969">            m_KnowledgeFlowFrame = new JFrame(Messages.getInstance().getString(&quot;GUIChooser_WekaKnowledgeFlowEnvironment_JFrame_Text&quot;));</span>
<span class="nc" id="L970">            m_KnowledgeFlowFrame.setIconImage(m_Icon);</span>
<span class="nc" id="L971">            m_KnowledgeFlowFrame.getContentPane().setLayout(new BorderLayout());</span>
<span class="nc" id="L972">            m_KnowledgeFlowFrame.getContentPane()</span>
<span class="nc" id="L973">              .add(kna, BorderLayout.CENTER);</span>
<span class="nc" id="L974">            m_KnowledgeFlowFrame.addWindowListener(new WindowAdapter() {</span>
                public void windowClosing(WindowEvent w) {
<span class="nc" id="L976">                  kna.clearLayout();</span>
<span class="nc" id="L977">                  m_KnowledgeFlowFrame.dispose();</span>
<span class="nc" id="L978">                  m_KnowledgeFlowFrame = null;</span>
<span class="nc" id="L979">                  m_KnowledgeFlowBut.setEnabled(true);</span>
<span class="nc" id="L980">                  checkExit();</span>
<span class="nc" id="L981">                }</span>
              });
<span class="nc" id="L983">            m_KnowledgeFlowFrame.pack();</span>
<span class="nc" id="L984">            m_KnowledgeFlowFrame.setSize(1000, 750);</span>
<span class="nc" id="L985">            m_KnowledgeFlowFrame.setVisible(true);</span>
          }
<span class="nc" id="L987">        }</span>
      });

<span class="nc" id="L990">    m_KnowledgeFlowBut.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L992">        showKnowledgeFlow(null);</span>
<span class="nc" id="L993">      }</span>
    });

<span class="nc" id="L996">    m_SimpleBut.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L998" title="All 2 branches missed.">        if (m_SimpleCLI == null) {</span>
<span class="nc" id="L999">          m_SimpleBut.setEnabled(false);</span>
          try {
<span class="nc" id="L1001">            m_SimpleCLI = new SimpleCLI();</span>
<span class="nc" id="L1002">            m_SimpleCLI.setIconImage(m_Icon);</span>
<span class="nc" id="L1003">          } catch (Exception ex) {</span>
<span class="nc" id="L1004">            throw new Error(Messages.getInstance().getString(&quot;GUIChooser_UnableToStartSimpleCLI_Error_Text&quot;));</span>
          }
<span class="nc" id="L1006">          m_SimpleCLI.addWindowListener(new WindowAdapter() {</span>
            public void windowClosing(WindowEvent w) {
<span class="nc" id="L1008">              m_SimpleCLI.dispose();</span>
<span class="nc" id="L1009">              m_SimpleCLI = null;</span>
<span class="nc" id="L1010">              m_SimpleBut.setEnabled(true);</span>
<span class="nc" id="L1011">              checkExit();</span>
<span class="nc" id="L1012">            }</span>
          });
<span class="nc" id="L1014">          m_SimpleCLI.setVisible(true);</span>
        }
<span class="nc" id="L1016">      }</span>
    });

    /*m_EnsembleLibraryBut.addActionListener(new ActionListener() {
      public void actionPerformed(ActionEvent e) {
	if (m_EnsembleLibraryFrame == null) {
	  m_EnsembleLibraryBut.setEnabled(false);
	  m_EnsembleLibraryFrame = new JFrame(&quot;EnsembleLibrary&quot;);
	  m_EnsembleLibraryFrame.setIconImage(m_Icon);
	  m_EnsembleLibraryFrame.getContentPane().setLayout(new BorderLayout());
	  EnsembleLibrary value = new EnsembleLibrary();
	  EnsembleLibraryEditor libraryEditor = new EnsembleLibraryEditor();
	  libraryEditor.setValue(value);
	  m_EnsembleLibraryFrame.getContentPane().add(libraryEditor.getCustomEditor(), BorderLayout.CENTER);
	  m_EnsembleLibraryFrame.addWindowListener(new WindowAdapter() {
	    public void windowClosing(WindowEvent w) {
	      m_EnsembleLibraryFrame.dispose();
	      m_EnsembleLibraryFrame = null;
	      m_EnsembleLibraryBut.setEnabled(true);
	      checkExit();
	    }
	  });
	  m_EnsembleLibraryFrame.pack();
	  m_EnsembleLibraryFrame.setSize(800, 600);
	  m_EnsembleLibraryFrame.setVisible(true);
	}
      }
    }); */
    
<span class="nc" id="L1045">    setJMenuBar(m_jMenuBar);</span>

<span class="nc" id="L1047">    addWindowListener(new WindowAdapter() {</span>
      public void windowClosing(WindowEvent w) {
<span class="nc" id="L1049">	dispose();</span>
<span class="nc" id="L1050">	checkExit();</span>
<span class="nc" id="L1051">      }</span>
    });
<span class="nc" id="L1053">    pack();</span>
<span class="nc" id="L1054">  }</span>
  
  public void showKnowledgeFlow(String fileToLoad) {
<span class="nc bnc" id="L1057" title="All 2 branches missed.">    if (m_KnowledgeFlowFrame == null) {</span>
<span class="nc" id="L1058">      KnowledgeFlow.startApp();</span>
<span class="nc" id="L1059">      m_pendingKnowledgeFlowLoad = fileToLoad;</span>
    } else {
<span class="nc bnc" id="L1061" title="All 2 branches missed.">      if (fileToLoad != null) {</span>
<span class="nc" id="L1062">        KnowledgeFlowApp.getSingleton().loadInitialLayout(fileToLoad);</span>
      }
    }
<span class="nc" id="L1065">  }</span>
  
  public void showExplorer(String fileToLoad) {
<span class="nc" id="L1068">    Explorer expl = null;</span>
<span class="nc bnc" id="L1069" title="All 2 branches missed.">    if (m_ExplorerFrame == null) {</span>
<span class="nc" id="L1070">      m_ExplorerBut.setEnabled(false);</span>
<span class="nc" id="L1071">      m_ExplorerFrame = new JFrame(&quot;Weka Explorer&quot;);</span>
<span class="nc" id="L1072">      m_ExplorerFrame.setIconImage(m_Icon);</span>
<span class="nc" id="L1073">      m_ExplorerFrame.getContentPane().setLayout(new BorderLayout());</span>
<span class="nc" id="L1074">      expl = new Explorer();</span>

<span class="nc" id="L1076">      m_ExplorerFrame.getContentPane().add(expl, BorderLayout.CENTER);</span>
<span class="nc" id="L1077">      m_ExplorerFrame.addWindowListener(new WindowAdapter() {</span>
          public void windowClosing(WindowEvent w) {
<span class="nc" id="L1079">            m_ExplorerFrame.dispose();</span>
<span class="nc" id="L1080">            m_ExplorerFrame = null;</span>
<span class="nc" id="L1081">            m_ExplorerBut.setEnabled(true);</span>
<span class="nc" id="L1082">            checkExit();</span>
<span class="nc" id="L1083">          }</span>
        });
<span class="nc" id="L1085">      m_ExplorerFrame.pack();</span>
<span class="nc" id="L1086">      m_ExplorerFrame.setSize(800, 600);</span>
<span class="nc" id="L1087">      m_ExplorerFrame.setVisible(true);</span>
    } else {
<span class="nc" id="L1089">      Object o = m_ExplorerFrame.getContentPane().getComponent(0);</span>
<span class="nc bnc" id="L1090" title="All 2 branches missed.">      if (o instanceof Explorer) {</span>
<span class="nc" id="L1091">        expl = (Explorer)o;</span>
      }
    }

<span class="nc bnc" id="L1095" title="All 2 branches missed.">    if (fileToLoad != null) {</span>
      try {
<span class="nc" id="L1097">        weka.core.converters.AbstractFileLoader loader = </span>
<span class="nc" id="L1098">          weka.core.converters.ConverterUtils.getLoaderForFile(fileToLoad);</span>
<span class="nc" id="L1099">        loader.setFile(new File(fileToLoad));</span>
<span class="nc" id="L1100">        expl.getPreprocessPanel().setInstancesFromFile(loader);</span>
<span class="nc" id="L1101">      } catch (Exception ex) {</span>
<span class="nc" id="L1102">        ex.printStackTrace();</span>
      }
    }
<span class="nc" id="L1105">  }</span>
  
  /**
   * insert the menu item in a sorted fashion.
   * 
   * @param menu        the menu to add the item to
   * @param menuitem    the menu item to add
   */
  protected void insertMenuItem(JMenu menu, JMenuItem menuitem) {
<span class="nc" id="L1114">    insertMenuItem(menu, menuitem, 0);</span>
<span class="nc" id="L1115">  }</span>
  
  /**
   * insert the menu item in a sorted fashion.
   * 
   * @param menu        the menu to add the item to
   * @param menuitem    the menu item to add
   * @param startIndex  the index in the menu to start with (0-based)
   */
  protected void insertMenuItem(JMenu menu, JMenuItem menuitem, int startIndex) {
    boolean     inserted;
    int         i;
    JMenuItem   current;
    String      currentStr;
    String      newStr;
    
<span class="nc" id="L1131">    inserted = false;</span>
<span class="nc" id="L1132">    newStr   = menuitem.getText().toLowerCase();</span>
    
    // try to find a spot inbetween
<span class="nc bnc" id="L1135" title="All 2 branches missed.">    for (i = startIndex; i &lt; menu.getMenuComponentCount(); i++) {</span>
<span class="nc bnc" id="L1136" title="All 2 branches missed.">      if (!(menu.getMenuComponent(i) instanceof JMenuItem))</span>
<span class="nc" id="L1137">        continue;</span>
      
<span class="nc" id="L1139">      current    = (JMenuItem) menu.getMenuComponent(i);</span>
<span class="nc" id="L1140">      currentStr = current.getText().toLowerCase();</span>
<span class="nc bnc" id="L1141" title="All 2 branches missed.">      if (currentStr.compareTo(newStr) &gt; 0) {</span>
<span class="nc" id="L1142">        inserted = true;</span>
<span class="nc" id="L1143">        menu.insert(menuitem, i);</span>
<span class="nc" id="L1144">        break;</span>
      }
    }
    
    // add it at the end if not yet inserted
<span class="nc bnc" id="L1149" title="All 2 branches missed.">    if (!inserted)</span>
<span class="nc" id="L1150">      menu.add(menuitem);</span>
<span class="nc" id="L1151">  }</span>
  
  /**
   * creates a frame and returns it.
   * 
   * @param parent              the parent of the generated frame
   * @param title               the title of the frame
   * @param c                   the component to place, can be null
   * @param layout              the layout to use, e.g., BorderLayout
   * @param layoutConstraints   the layout constraints, e.g., BorderLayout.CENTER
   * @param width               the width of the frame, ignored if -1
   * @param height              the height of the frame, ignored if -1
   * @param menu                an optional menu
   * @param listener            if true a default listener is added
   * @param visible             if true then the frame is made visible immediately
   * @return                    the generated frame
   */
  protected Container createFrame(
      GUIChooser parent, String title, Component c, LayoutManager layout, 
      Object layoutConstraints, int width, int height, JMenuBar menu,
      boolean listener, boolean visible) {

<span class="nc" id="L1173">    Container result = null;</span>


<span class="nc" id="L1176">    final ChildFrameSDI frame = new ChildFrameSDI(parent, title);</span>

    // layout
<span class="nc" id="L1179">    frame.setLayout(layout);</span>
<span class="nc bnc" id="L1180" title="All 2 branches missed.">    if (c != null)</span>
<span class="nc" id="L1181">      frame.getContentPane().add(c, layoutConstraints);</span>

    // menu
<span class="nc" id="L1184">    frame.setJMenuBar(menu);</span>

    // size
<span class="nc" id="L1187">    frame.pack();</span>
<span class="nc bnc" id="L1188" title="All 4 branches missed.">    if ((width &gt; -1) &amp;&amp; (height &gt; -1))</span>
<span class="nc" id="L1189">      frame.setSize(width, height);</span>
<span class="nc" id="L1190">    frame.validate();</span>

    // location
<span class="nc" id="L1193">    int screenHeight = getGraphicsConfiguration().getBounds().height;</span>
<span class="nc" id="L1194">    int screenWidth  = getGraphicsConfiguration().getBounds().width;</span>
<span class="nc" id="L1195">    frame.setLocation(</span>
<span class="nc" id="L1196">        (screenWidth - frame.getBounds().width) / 2,</span>
<span class="nc" id="L1197">        (screenHeight - frame.getBounds().height) / 2);</span>

    // listener?
<span class="nc bnc" id="L1200" title="All 2 branches missed.">    if (listener) {</span>
<span class="nc" id="L1201">      frame.addWindowListener(new WindowAdapter() {</span>
        public void windowClosing(WindowEvent e) {
<span class="nc" id="L1203">          frame.dispose();</span>
<span class="nc" id="L1204">        }</span>
      });
    }

    // display frame
<span class="nc bnc" id="L1209" title="All 2 branches missed.">    if (visible)</span>
<span class="nc" id="L1210">      frame.setVisible(true);</span>

<span class="nc" id="L1212">    result = frame;</span>


<span class="nc" id="L1215">    return result;</span>
  }
  
  /**
   * Specialized JFrame class.
   * 
   * @author  fracpete (fracpete at waikato dot ac dot nz)
   * @version $Revision: 9490 $
   */
  public static class ChildFrameSDI 
    extends JFrame {
    
    /** for serialization. */
    private static final long serialVersionUID = 8588293938686425618L;
    
    /** the parent frame. */
    protected GUIChooser m_Parent;
    
    /**
     * constructs a new internal frame that knows about its parent.
     * 
     * @param parent    the parent frame
     * @param title     the title of the frame
     */
    public ChildFrameSDI(GUIChooser parent, String title) {
<span class="nc" id="L1240">      super(title);</span>
      
<span class="nc" id="L1242">      m_Parent = parent;</span>

<span class="nc" id="L1244">      addWindowListener(new WindowAdapter() {</span>
        public void windowActivated(WindowEvent e) {
          // update title of parent
<span class="nc bnc" id="L1247" title="All 2 branches missed.">          if (getParentFrame() != null)</span>
<span class="nc" id="L1248">            getParentFrame().createTitle(getTitle());</span>
<span class="nc" id="L1249">        }</span>
      });
      
      // add to parent
<span class="nc bnc" id="L1253" title="All 2 branches missed.">      if (getParentFrame() != null) {</span>
<span class="nc" id="L1254">        getParentFrame().addChildFrame(this);</span>
<span class="nc" id="L1255">        setIconImage(getParentFrame().getIconImage());</span>
      }
<span class="nc" id="L1257">    }</span>
    
    /**
     * returns the parent frame, can be null.
     * 
     * @return          the parent frame
     */
    public GUIChooser getParentFrame() {
<span class="nc" id="L1265">      return m_Parent;</span>
    }
    
    /**
     * de-registers the child frame with the parent first.
     */
    public void dispose() {
<span class="nc bnc" id="L1272" title="All 2 branches missed.">      if (getParentFrame() != null) {</span>
<span class="nc" id="L1273">        getParentFrame().removeChildFrame(this);</span>
<span class="nc" id="L1274">        getParentFrame().createTitle(&quot;&quot;);</span>
      }
      
<span class="nc" id="L1277">      super.dispose();</span>
<span class="nc" id="L1278">    }</span>
  }
  
  /**
   * creates and displays the title.
   * 
   * @param title       the additional part of the title
   */
  protected void createTitle(String title) {
    String      newTitle;
    
<span class="nc" id="L1289">    newTitle = Messages.getInstance().getString(&quot;GUIChooser_CreateTitle_Text_Front&quot;) + new Version();</span>
<span class="nc bnc" id="L1290" title="All 2 branches missed.">    if (title.length() != 0)</span>
<span class="nc" id="L1291">      newTitle += Messages.getInstance().getString(&quot;GUIChooser_CreateTitle_Text_End&quot;) + title;</span>
    
<span class="nc" id="L1293">    setTitle(newTitle);</span>
<span class="nc" id="L1294">  }</span>
  
  /**
   * adds the given child frame to the list of frames.
   * 
   * @param c           the child frame to add
   */
  public void addChildFrame(Container c) {
<span class="nc" id="L1302">    m_ChildFrames.add(c);</span>
<span class="nc" id="L1303">  }</span>
  
  /**
   * tries to remove the child frame, it returns true if it could do such.
   * 
   * @param c           the child frame to remove
   * @return            true if the child frame could be removed
   */
  public boolean removeChildFrame(Container c) {
<span class="nc" id="L1312">    boolean result = m_ChildFrames.remove(c);</span>
<span class="nc" id="L1313">    return result;</span>
  }
  
  /**
   * Kills the JVM if all windows have been closed.
   */
  private void checkExit() {

<span class="nc bnc" id="L1321" title="All 2 branches missed.">    if (!isVisible()</span>
	// applications
<span class="nc bnc" id="L1323" title="All 2 branches missed.">	&amp;&amp; (m_ExplorerFrame == null)</span>
<span class="nc bnc" id="L1324" title="All 2 branches missed.">	&amp;&amp; (m_ExperimenterFrame == null)</span>
<span class="nc bnc" id="L1325" title="All 2 branches missed.">	&amp;&amp; (m_KnowledgeFlowFrame == null)</span>
<span class="nc bnc" id="L1326" title="All 2 branches missed.">	&amp;&amp; (m_SimpleCLI == null)</span>
	// tools
<span class="nc bnc" id="L1328" title="All 2 branches missed.">	&amp;&amp; (m_ArffViewers.size() == 0)</span>
<span class="nc bnc" id="L1329" title="All 2 branches missed.">	&amp;&amp; (m_SqlViewerFrame == null)</span>
<span class="nc bnc" id="L1330" title="All 2 branches missed.">	&amp;&amp; (m_EnsembleLibraryFrame == null)</span>
	// visualization
<span class="nc bnc" id="L1332" title="All 2 branches missed.">	&amp;&amp; (m_Plots.size() == 0)</span>
<span class="nc bnc" id="L1333" title="All 2 branches missed.">	&amp;&amp; (m_ROCs.size() == 0)</span>
<span class="nc bnc" id="L1334" title="All 2 branches missed.">	&amp;&amp; (m_TreeVisualizers.size() == 0)</span>
<span class="nc bnc" id="L1335" title="All 2 branches missed.">	&amp;&amp; (m_GraphVisualizers.size() == 0)</span>
<span class="nc bnc" id="L1336" title="All 2 branches missed.">	&amp;&amp; (m_BoundaryVisualizerFrame == null)</span>
	// help
<span class="nc bnc" id="L1338" title="All 2 branches missed.">	&amp;&amp; (m_SystemInfoFrame == null) ) {</span>
<span class="nc" id="L1339">      System.exit(0);</span>
    }
<span class="nc" id="L1341">  }</span>

  /** variable for the GUIChooser class which would be set to null by the memory 
      monitoring thread to free up some memory if we running out of memory
   */
  private static GUIChooser m_chooser;

  /** for monitoring the Memory consumption */
<span class="nc" id="L1349">  private static Memory m_Memory = new Memory(true);</span>

  /**
   * Tests out the GUIChooser environment.
   *
   * @param args ignored.
   */
  public static void main(String [] args) {

<span class="nc" id="L1358">    weka.core.logging.Logger.log(weka.core.logging.Logger.Level.INFO, Messages.getInstance().getString(&quot;GUIChooser_Main_LoggingStarted_Text&quot;));</span>
<span class="nc" id="L1359">    LookAndFeel.setLookAndFeel();</span>
    
    try {

      // uncomment to disable the memory management:
      //m_Memory.setEnabled(false);

      //m_chooser = new GUIChooser();
<span class="nc" id="L1367">      GUIChooser.createSingleton();</span>
<span class="nc" id="L1368">      m_chooser.setVisible(true);</span>
      
<span class="nc bnc" id="L1370" title="All 4 branches missed.">      if (args != null &amp;&amp; args.length &gt; 0) {</span>
<span class="nc" id="L1371">        m_chooser.showExplorer(args[0]);</span>
      }

<span class="nc" id="L1374">      Thread memMonitor = new Thread() {</span>
        public void run() {
<span class="nc" id="L1376">          while(true) {</span>
            try {
              //System.out.println(&quot;before sleeping&quot;);
<span class="nc" id="L1379">              this.sleep(4000);</span>
              
<span class="nc" id="L1381">              System.gc();</span>
              
<span class="nc bnc" id="L1383" title="All 2 branches missed.">              if (m_Memory.isOutOfMemory()) {</span>
                // clean up
<span class="nc" id="L1385">                m_chooser.dispose();</span>
<span class="nc bnc" id="L1386" title="All 2 branches missed.">                if(m_chooser.m_ExperimenterFrame!=null) {</span>
<span class="nc" id="L1387">                  m_chooser.m_ExperimenterFrame.dispose();</span>
<span class="nc" id="L1388">                  m_chooser.m_ExperimenterFrame =null;</span>
                }
<span class="nc bnc" id="L1390" title="All 2 branches missed.">                if(m_chooser.m_ExplorerFrame!=null) {</span>
<span class="nc" id="L1391">                  m_chooser.m_ExplorerFrame.dispose();</span>
<span class="nc" id="L1392">                  m_chooser.m_ExplorerFrame = null;</span>
                }
<span class="nc bnc" id="L1394" title="All 2 branches missed.">                if(m_chooser.m_KnowledgeFlowFrame!=null) {</span>
<span class="nc" id="L1395">                  m_chooser.m_KnowledgeFlowFrame.dispose();</span>
<span class="nc" id="L1396">                  m_chooser.m_KnowledgeFlowFrame = null;</span>
                }
<span class="nc bnc" id="L1398" title="All 2 branches missed.">                if(m_chooser.m_SimpleCLI!=null) {</span>
<span class="nc" id="L1399">                  m_chooser.m_SimpleCLI.dispose();</span>
<span class="nc" id="L1400">                  m_chooser.m_SimpleCLI = null;</span>
                }
<span class="nc bnc" id="L1402" title="All 2 branches missed.">                if (m_chooser.m_ArffViewers.size() &gt; 0) {</span>
<span class="nc bnc" id="L1403" title="All 2 branches missed.">                  for (int i = 0; i &lt; m_chooser.m_ArffViewers.size(); i++) {</span>
<span class="nc" id="L1404">                    ArffViewer av = (ArffViewer) </span>
<span class="nc" id="L1405">                                        m_chooser.m_ArffViewers.get(i);</span>
<span class="nc" id="L1406">                    av.dispose();</span>
                  }
<span class="nc" id="L1408">                  m_chooser.m_ArffViewers.clear();</span>
                }
<span class="nc" id="L1410">                m_chooser = null;</span>
<span class="nc" id="L1411">                System.gc();</span>

                // display error
<span class="nc" id="L1414">                m_chooser.m_LogWindow.setVisible(true);</span>
<span class="nc" id="L1415">                m_chooser.m_LogWindow.toFront();</span>
<span class="nc" id="L1416">                System.err.println(Messages.getInstance().getString(&quot;GUIChooser_Main_Error_Text_Front&quot;));</span>
<span class="nc" id="L1417">                m_Memory.showOutOfMemory();</span>
<span class="nc" id="L1418">                System.err.println(Messages.getInstance().getString(&quot;GUIChooser_Main_Error_Text_End&quot;));</span>
<span class="nc" id="L1419">                System.exit(-1);</span>
              }
            } 
<span class="nc" id="L1422">            catch(InterruptedException ex) { </span>
<span class="nc" id="L1423">              ex.printStackTrace(); </span>
            }
          }
        }
      };

<span class="nc" id="L1429">      memMonitor.setPriority(Thread.NORM_PRIORITY);</span>
<span class="nc" id="L1430">      memMonitor.start();    </span>
<span class="nc" id="L1431">    } catch (Exception ex) {</span>
<span class="nc" id="L1432">      ex.printStackTrace();</span>
<span class="nc" id="L1433">      System.err.println(ex.getMessage());</span>
    }
<span class="nc" id="L1435">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span>AllTests (Nov 28, 2015 2:34:31 PM)</div></body></html>
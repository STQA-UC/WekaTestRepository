<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>SimpleSetupPanel.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">AllTests (Nov 28, 2015 2:34:31 PM)</a> &gt; <a href="../../index.html" class="el_group">wekaproject</a> &gt; <a href="../index.html" class="el_bundle">src/src/main/java</a> &gt; <a href="index.source.html" class="el_package">weka.gui.experiment</a> &gt; <span class="el_source">SimpleSetupPanel.java</span></div><h1>SimpleSetupPanel.java</h1><pre class="source lang-java linenums"><span class="nc" id="L1">/*</span>
 *    This program is free software; you can redistribute it and/or modify
 *    it under the terms of the GNU General Public License as published by
 *    the Free Software Foundation; either version 2 of the License, or
 *    (at your option) any later version.
 *
 *    This program is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *    GNU General Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License
 *    along with this program; if not, write to the Free Software
 *    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 */

/*
 *    SimpleSetupPanel.java
 *    Copyright (C) 2002 University of Waikato, Hamilton, New Zealand
 *
 */

package weka.gui.experiment;

import weka.classifiers.Classifier;
import weka.core.xml.KOML;
import weka.experiment.CSVResultListener;
import weka.experiment.ClassifierSplitEvaluator;
import weka.experiment.CrossValidationResultProducer;
import weka.experiment.DatabaseResultListener;
import weka.experiment.Experiment;
import weka.experiment.InstancesResultListener;
import weka.experiment.PropertyNode;
import weka.experiment.RandomSplitResultProducer;
import weka.experiment.RegressionSplitEvaluator;
import weka.experiment.SplitEvaluator;
import weka.gui.DatabaseConnectionDialog;
import weka.gui.ExtensionFileFilter;

import java.awt.BorderLayout;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.GridLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.FocusAdapter;
import java.awt.event.FocusEvent;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.beans.IntrospectionException;
import java.beans.PropertyChangeListener;
import java.beans.PropertyChangeSupport;
import java.beans.PropertyDescriptor;
import java.io.File;

import javax.swing.BorderFactory;
import javax.swing.ButtonGroup;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JRadioButton;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.filechooser.FileFilter;

/** 
 * This panel controls the configuration of an experiment.
  * &lt;p&gt;
 * If &lt;a href=&quot;http://koala.ilog.fr/XML/serialization/&quot; target=&quot;_blank&quot;&gt;KOML&lt;/a&gt;
 * is in the classpath the experiments can also be serialized to XML instead of a
 * binary format.
*
 * @author Richard kirkby (rkirkby@cs.waikato.ac.nz)
 * @author FracPete (fracpete at waikato dot ac dot nz) 
 * @version $Revision: 7059 $
 */
<span class="nc" id="L87">public class SimpleSetupPanel</span>
  extends JPanel {

  /** for serialization */
  private static final long serialVersionUID = 5257424515609176509L;

  /** The experiment being configured */
  protected Experiment m_Exp;

  /** The panel which switched between simple and advanced setup modes */
<span class="nc" id="L97">  protected SetupModePanel m_modePanel = null;</span>

  /** The database destination URL to store results into */
  protected String m_destinationDatabaseURL;

  /** The filename to store results into */
<span class="nc" id="L103">  protected String m_destinationFilename = &quot;&quot;;</span>

  /** The number of folds for a cross-validation experiment */
<span class="nc" id="L106">  protected int m_numFolds = 10;</span>

  /** The training percentage for a train/test split experiment */
<span class="nc" id="L109">  protected double m_trainPercent = 66;</span>

  /** The number of times to repeat the sub-experiment */
<span class="nc" id="L112">  protected int m_numRepetitions = 10;</span>

  /** Whether or not the user has consented for the experiment to be simplified */
  protected boolean m_userHasBeenAskedAboutConversion;

  /** Filter for choosing CSV files */
<span class="nc" id="L118">  protected ExtensionFileFilter m_csvFileFilter =</span>
<span class="nc" id="L119">    new ExtensionFileFilter(&quot;.csv&quot;, Messages.getInstance().getString(&quot;SimpleSetupPanel_CsvFileFilter_Text&quot;));</span>

  /** FIlter for choosing ARFF files */
<span class="nc" id="L122">  protected ExtensionFileFilter m_arffFileFilter =</span>
<span class="nc" id="L123">    new ExtensionFileFilter(&quot;.arff&quot;, Messages.getInstance().getString(&quot;SimpleSetupPanel_ArffFileFilter_Text&quot;));</span>

  /** Click to load an experiment */
<span class="nc" id="L126">  protected JButton m_OpenBut = new JButton(Messages.getInstance().getString(&quot;SimpleSetupPanel_OpenBut_JButton_Text&quot;));</span>

  /** Click to save an experiment */
<span class="nc" id="L129">  protected JButton m_SaveBut = new JButton(Messages.getInstance().getString(&quot;SimpleSetupPanel_SaveBut_JButton_Text&quot;));</span>

  /** Click to create a new experiment with default settings */
<span class="nc" id="L132">  protected JButton m_NewBut = new JButton(Messages.getInstance().getString(&quot;SimpleSetupPanel_NewBut_JButton_Text&quot;));</span>

  /** A filter to ensure only experiment files get shown in the chooser */
<span class="nc" id="L135">  protected FileFilter m_ExpFilter = </span>
<span class="nc" id="L136">    new ExtensionFileFilter(Experiment.FILE_EXTENSION, </span>
<span class="nc" id="L137">    		Messages.getInstance().getString(&quot;SimpleSetupPanel_ExpFilter_ExtensionFileFilter_Text_First&quot;) + Experiment.FILE_EXTENSION + Messages.getInstance().getString(&quot;SimpleSetupPanel_ExpFilter_ExtensionFileFilter_Text_Second&quot;));</span>

  /** A filter to ensure only experiment (in KOML format) files get shown in the chooser */
<span class="nc" id="L140">  protected FileFilter m_KOMLFilter = </span>
<span class="nc" id="L141">    new ExtensionFileFilter(KOML.FILE_EXTENSION, </span>
<span class="nc" id="L142">    		Messages.getInstance().getString(&quot;SimpleSetupPanel_KOMLFilter_ExtensionFileFilter_Text_First&quot;) + KOML.FILE_EXTENSION + Messages.getInstance().getString(&quot;SimpleSetupPanel_KOMLFilter_ExtensionFileFilter_Text_Second&quot;));</span>

  /** A filter to ensure only experiment (in XML format) files get shown in the chooser */
<span class="nc" id="L145">  protected FileFilter m_XMLFilter = </span>
<span class="nc" id="L146">    new ExtensionFileFilter(&quot;.xml&quot;, </span>
<span class="nc" id="L147">    		Messages.getInstance().getString(&quot;SimpleSetupPanel_XMLFilter_ExtensionFileFilter_Text&quot;));</span>

  /** The file chooser for selecting experiments */
<span class="nc" id="L150">  protected JFileChooser m_FileChooser =</span>
<span class="nc" id="L151">    new JFileChooser(new File(System.getProperty(&quot;user.dir&quot;)));</span>

  /** The file chooser for selecting result destinations */
<span class="nc" id="L154">  protected JFileChooser m_DestFileChooser =</span>
<span class="nc" id="L155">    new JFileChooser(new File(System.getProperty(&quot;user.dir&quot;)));</span>

  /** Combo box for choosing experiment destination type */
<span class="nc" id="L158">  protected JComboBox m_ResultsDestinationCBox = new JComboBox();</span>

  /** Label for destination field */
<span class="nc" id="L161">  protected JLabel m_ResultsDestinationPathLabel = new JLabel(Messages.getInstance().getString(&quot;SimpleSetupPanel_ResultsDestinationPathLabel_JLabel_Text&quot;));</span>

  /** Input field for result destination path */ 
<span class="nc" id="L164">  protected JTextField m_ResultsDestinationPathTField = new JTextField();</span>

  /** Button for browsing destination files */
<span class="nc" id="L167">  protected JButton m_BrowseDestinationButton = new JButton(Messages.getInstance().getString(&quot;SimpleSetupPanel_BrowseDestinationButton_JButton_Text&quot;));</span>

  /** Combo box for choosing experiment type */
<span class="nc" id="L170">  protected JComboBox m_ExperimentTypeCBox = new JComboBox();</span>

  /** Label for parameter field */
<span class="nc" id="L173">  protected JLabel m_ExperimentParameterLabel = new JLabel(Messages.getInstance().getString(&quot;SimpleSetupPanel_ExperimentParameterLabel_JLabel_Text&quot;));</span>

  /** Input field for experiment parameter */
<span class="nc" id="L176">  protected JTextField m_ExperimentParameterTField = new JTextField(); </span>

  /** Radio button for choosing classification experiment */
<span class="nc" id="L179">  protected JRadioButton m_ExpClassificationRBut = </span>
<span class="nc" id="L180">    new JRadioButton(Messages.getInstance().getString(&quot;SimpleSetupPanel_ExpClassificationRBut_JRadioButton_Text&quot;));</span>

  /** Radio button for choosing regression experiment */
<span class="nc" id="L183">  protected JRadioButton m_ExpRegressionRBut = </span>
<span class="nc" id="L184">    new JRadioButton(Messages.getInstance().getString(&quot;SimpleSetupPanel_ExpRegressionRBut_JRadioButton_Text&quot;));</span>

  /** Input field for number of repetitions */
<span class="nc" id="L187">  protected JTextField m_NumberOfRepetitionsTField = new JTextField();  </span>

  /** Radio button for choosing datasets first in order of execution */ 
<span class="nc" id="L190">  protected JRadioButton m_OrderDatasetsFirstRBut = </span>
<span class="nc" id="L191">    new JRadioButton(Messages.getInstance().getString(&quot;SimpleSetupPanel_OrderDatasetsFirstRBut_JRadioButton_Text&quot;));</span>

  /** Radio button for choosing algorithms first in order of execution */ 
<span class="nc" id="L194">  protected JRadioButton m_OrderAlgorithmsFirstRBut = </span>
<span class="nc" id="L195">    new JRadioButton(Messages.getInstance().getString(&quot;SimpleSetupPanel_OrderAlgorithmsFirstRBut_JRadioButton_Text&quot;));</span>

  /** The strings used to identify the combo box choices */
<span class="nc" id="L198">  protected static String DEST_DATABASE_TEXT = (Messages.getInstance().getString(&quot;SimpleSetupPanel_DEST_DATABASE_TEXT_Text&quot;));</span>
<span class="nc" id="L199">  protected static String DEST_ARFF_TEXT = (Messages.getInstance().getString(&quot;SimpleSetupPanel_DEST_ARFF_TEXT_Text&quot;));</span>
<span class="nc" id="L200">  protected static String DEST_CSV_TEXT = (Messages.getInstance().getString(&quot;SimpleSetupPanel_DEST_CSV_TEXT_Text&quot;));</span>
<span class="nc" id="L201">  protected static String TYPE_CROSSVALIDATION_TEXT = (Messages.getInstance().getString(&quot;SimpleSetupPanel_TYPE_CROSSVALIDATION_TEXT_Text&quot;));</span>
<span class="nc" id="L202">  protected static String TYPE_RANDOMSPLIT_TEXT = (Messages.getInstance().getString(&quot;SimpleSetupPanel_TYPE_RANDOMSPLIT_TEXT_Text&quot;));</span>
<span class="nc" id="L203">  protected static String TYPE_FIXEDSPLIT_TEXT = (Messages.getInstance().getString(&quot;SimpleSetupPanel_TYPE_FIXEDSPLIT_TEXT_Text&quot;));</span>

  /** The panel for configuring selected datasets */
<span class="nc" id="L206">  protected DatasetListPanel m_DatasetListPanel = new DatasetListPanel();</span>

  /** The panel for configuring selected algorithms */
<span class="nc" id="L209">  protected AlgorithmListPanel m_AlgorithmListPanel = new AlgorithmListPanel();</span>

  /** A button for bringing up the notes */
<span class="nc" id="L212">  protected JButton m_NotesButton =  new JButton(Messages.getInstance().getString(&quot;SimpleSetupPanel_NotesButton_JButton_Text&quot;));</span>

  /** Frame for the notes */
<span class="nc" id="L215">  protected JFrame m_NotesFrame = new JFrame(Messages.getInstance().getString(&quot;SimpleSetupPanel_NotesFrame_JFrame_Text&quot;));</span>

  /** Area for user notes Default of 10 rows */
<span class="nc" id="L218">  protected JTextArea m_NotesText = new JTextArea(null, 10, 0);</span>

  /**
   * Manages sending notifications to people when we change the experiment,
   * at this stage, only the resultlistener so the resultpanel can update.
   */
<span class="nc" id="L224">  protected PropertyChangeSupport m_Support = new PropertyChangeSupport(this);</span>
  
  /**
   * Creates the setup panel with the supplied initial experiment.
   *
   * @param exp a value of type 'Experiment'
   */
  public SimpleSetupPanel(Experiment exp) {

<span class="nc" id="L233">    this();</span>
<span class="nc" id="L234">    setExperiment(exp);</span>
<span class="nc" id="L235">  }</span>
  
  /**
   * Creates the setup panel with no initial experiment.
   */
<span class="nc" id="L240">  public SimpleSetupPanel() {</span>

    // everything disabled on startup
<span class="nc" id="L243">    m_ResultsDestinationCBox.setEnabled(false);</span>
<span class="nc" id="L244">    m_ResultsDestinationPathLabel.setEnabled(false);</span>
<span class="nc" id="L245">    m_ResultsDestinationPathTField.setEnabled(false);</span>
<span class="nc" id="L246">    m_BrowseDestinationButton.setEnabled(false); </span>
<span class="nc" id="L247">    m_ExperimentTypeCBox.setEnabled(false);</span>
<span class="nc" id="L248">    m_ExperimentParameterLabel.setEnabled(false);</span>
<span class="nc" id="L249">    m_ExperimentParameterTField.setEnabled(false);</span>
<span class="nc" id="L250">    m_ExpClassificationRBut.setEnabled(false);</span>
<span class="nc" id="L251">    m_ExpRegressionRBut.setEnabled(false);</span>
<span class="nc" id="L252">    m_NumberOfRepetitionsTField.setEnabled(false);</span>
<span class="nc" id="L253">    m_OrderDatasetsFirstRBut.setEnabled(false);</span>
<span class="nc" id="L254">    m_OrderAlgorithmsFirstRBut.setEnabled(false);</span>

    // get sensible default database address
    try {
<span class="nc" id="L258">      m_destinationDatabaseURL = (new DatabaseResultListener()).getDatabaseURL();</span>
<span class="nc" id="L259">    } catch (Exception e) {}</span>

    // create action listeners
<span class="nc" id="L262">    m_NewBut.setMnemonic('N');</span>
<span class="nc" id="L263">    m_NewBut.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L265">	  Experiment newExp = new Experiment();</span>
<span class="nc" id="L266">	  CrossValidationResultProducer cvrp = new CrossValidationResultProducer();</span>
<span class="nc" id="L267">	  cvrp.setNumFolds(10);</span>
<span class="nc" id="L268">	  cvrp.setSplitEvaluator(new ClassifierSplitEvaluator());</span>
<span class="nc" id="L269">	  newExp.setResultProducer(cvrp);</span>
<span class="nc" id="L270">	  newExp.setPropertyArray(new Classifier[0]);</span>
<span class="nc" id="L271">	  newExp.setUsePropertyIterator(true);</span>
<span class="nc" id="L272">	  setExperiment(newExp);</span>

          // defaults
<span class="nc bnc" id="L275" title="All 2 branches missed.">          if (ExperimenterDefaults.getUseClassification())</span>
<span class="nc" id="L276">            m_ExpClassificationRBut.setSelected(true);</span>
          else
<span class="nc" id="L278">            m_ExpRegressionRBut.setSelected(true);</span>
          
<span class="nc" id="L280">          setSelectedItem(</span>
<span class="nc" id="L281">              m_ResultsDestinationCBox, ExperimenterDefaults.getDestination());</span>
<span class="nc" id="L282">          destinationTypeChanged();</span>
          
<span class="nc" id="L284">          setSelectedItem(</span>
<span class="nc" id="L285">              m_ExperimentTypeCBox, ExperimenterDefaults.getExperimentType());</span>
          
<span class="nc" id="L287">          m_numRepetitions = ExperimenterDefaults.getRepetitions();</span>
<span class="nc" id="L288">          m_NumberOfRepetitionsTField.setText(</span>
<span class="nc" id="L289">              &quot;&quot; + m_numRepetitions);</span>
          
<span class="nc bnc" id="L291" title="All 2 branches missed.">          if (ExperimenterDefaults.getExperimentType().equals(</span>
<span class="nc" id="L292">                TYPE_CROSSVALIDATION_TEXT)) {</span>
<span class="nc" id="L293">            m_numFolds = ExperimenterDefaults.getFolds();</span>
<span class="nc" id="L294">            m_ExperimentParameterTField.setText(</span>
<span class="nc" id="L295">                &quot;&quot; + m_numFolds);</span>
          }
          else {
<span class="nc" id="L298">            m_trainPercent = ExperimenterDefaults.getTrainPercentage();</span>
<span class="nc" id="L299">            m_ExperimentParameterTField.setText(</span>
<span class="nc" id="L300">                &quot;&quot; + m_trainPercent);</span>
          }
          
<span class="nc bnc" id="L303" title="All 2 branches missed.">          if (ExperimenterDefaults.getDatasetsFirst())</span>
<span class="nc" id="L304">            m_OrderDatasetsFirstRBut.setSelected(true);</span>
          else
<span class="nc" id="L306">            m_OrderAlgorithmsFirstRBut.setSelected(true);</span>

<span class="nc" id="L308">          expTypeChanged();</span>
<span class="nc" id="L309">	}</span>
      });
<span class="nc" id="L311">    m_SaveBut.setEnabled(false);</span>
<span class="nc" id="L312">    m_SaveBut.setMnemonic('S');</span>
<span class="nc" id="L313">    m_SaveBut.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L315">	  saveExperiment();</span>
<span class="nc" id="L316">	}</span>
      });
<span class="nc" id="L318">    m_OpenBut.setMnemonic('O');</span>
<span class="nc" id="L319">    m_OpenBut.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L321">	  openExperiment();</span>
<span class="nc" id="L322">	}</span>
      });
<span class="nc" id="L324">    m_FileChooser.addChoosableFileFilter(m_ExpFilter);</span>
<span class="nc bnc" id="L325" title="All 2 branches missed.">    if (KOML.isPresent())</span>
<span class="nc" id="L326">       m_FileChooser.addChoosableFileFilter(m_KOMLFilter);</span>
<span class="nc" id="L327">    m_FileChooser.addChoosableFileFilter(m_XMLFilter);</span>
<span class="nc bnc" id="L328" title="All 2 branches missed.">    if (ExperimenterDefaults.getExtension().equals(&quot;.xml&quot;))</span>
<span class="nc" id="L329">      m_FileChooser.setFileFilter(m_XMLFilter);</span>
<span class="nc bnc" id="L330" title="All 4 branches missed.">    else if (KOML.isPresent() &amp;&amp; ExperimenterDefaults.getExtension().equals(KOML.FILE_EXTENSION))</span>
<span class="nc" id="L331">      m_FileChooser.setFileFilter(m_KOMLFilter);</span>
    else
<span class="nc" id="L333">      m_FileChooser.setFileFilter(m_ExpFilter);</span>
<span class="nc" id="L334">    m_FileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);</span>
<span class="nc" id="L335">    m_DestFileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);</span>

<span class="nc" id="L337">    m_BrowseDestinationButton.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
	  //using this button for both browsing file &amp; setting username/password
<span class="nc bnc" id="L340" title="All 2 branches missed.">	  if (m_ResultsDestinationCBox.getSelectedItem() == DEST_DATABASE_TEXT){</span>
<span class="nc" id="L341">	    chooseURLUsername();</span>
	  } else {
<span class="nc" id="L343">	    chooseDestinationFile();</span>
	  }
<span class="nc" id="L345">	}</span>
      });

<span class="nc" id="L348">    m_ExpClassificationRBut.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L350">	  expTypeChanged();</span>
<span class="nc" id="L351">	}</span>
      });
  
<span class="nc" id="L354">    m_ExpRegressionRBut.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L356">	  expTypeChanged();</span>
<span class="nc" id="L357">	}</span>
      });

<span class="nc" id="L360">    m_OrderDatasetsFirstRBut.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L362" title="All 2 branches missed.">	  if (m_Exp != null) {</span>
<span class="nc" id="L363">	    m_Exp.setAdvanceDataSetFirst(true);</span>
<span class="nc" id="L364">	    m_Support.firePropertyChange(&quot;&quot;, null, null);</span>
	  }
<span class="nc" id="L366">	}</span>
      });
    
<span class="nc" id="L369">    m_OrderAlgorithmsFirstRBut.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L371" title="All 2 branches missed.">	  if (m_Exp != null) {</span>
<span class="nc" id="L372">	    m_Exp.setAdvanceDataSetFirst(false);</span>
<span class="nc" id="L373">	    m_Support.firePropertyChange(&quot;&quot;, null, null);</span>
	  }
<span class="nc" id="L375">	}</span>
      });

<span class="nc" id="L378">    m_ResultsDestinationPathTField.getDocument().addDocumentListener(new DocumentListener() {</span>
<span class="nc" id="L379">	public void insertUpdate(DocumentEvent e) {destinationAddressChanged();}</span>
<span class="nc" id="L380">	public void removeUpdate(DocumentEvent e) {destinationAddressChanged();}</span>
<span class="nc" id="L381">	public void changedUpdate(DocumentEvent e) {destinationAddressChanged();}</span>
      });

<span class="nc" id="L384">    m_ExperimentParameterTField.getDocument().addDocumentListener(new DocumentListener() {</span>
<span class="nc" id="L385">	public void insertUpdate(DocumentEvent e) {expParamChanged();}</span>
<span class="nc" id="L386">	public void removeUpdate(DocumentEvent e) {expParamChanged();}</span>
<span class="nc" id="L387">	public void changedUpdate(DocumentEvent e) {expParamChanged();}</span>
      });

<span class="nc" id="L390">    m_NumberOfRepetitionsTField.getDocument().addDocumentListener(new DocumentListener() {</span>
<span class="nc" id="L391">	public void insertUpdate(DocumentEvent e) {numRepetitionsChanged();}</span>
<span class="nc" id="L392">	public void removeUpdate(DocumentEvent e) {numRepetitionsChanged();}</span>
<span class="nc" id="L393">	public void changedUpdate(DocumentEvent e) {numRepetitionsChanged();}</span>
      });

<span class="nc" id="L396">    m_NotesFrame.addWindowListener(new WindowAdapter() {</span>
	public void windowClosing(WindowEvent e) {
<span class="nc" id="L398">	  m_NotesButton.setEnabled(true);</span>
<span class="nc" id="L399">	}</span>
      });
<span class="nc" id="L401">    m_NotesFrame.getContentPane().add(new JScrollPane(m_NotesText));</span>
<span class="nc" id="L402">    m_NotesFrame.setSize(600, 400);</span>

<span class="nc" id="L404">    m_NotesButton.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L406">	  m_NotesButton.setEnabled(false);</span>
<span class="nc" id="L407">	  m_NotesFrame.setVisible(true);</span>
<span class="nc" id="L408">	}</span>
      });
<span class="nc" id="L410">    m_NotesButton.setEnabled(false);</span>

<span class="nc" id="L412">    m_NotesText.setEditable(true);</span>
    //m_NotesText.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
<span class="nc" id="L414">    m_NotesText.addKeyListener(new KeyAdapter() {</span>
	public void keyReleased(KeyEvent e) {
<span class="nc" id="L416">	  m_Exp.setNotes(m_NotesText.getText());</span>
<span class="nc" id="L417">	}</span>
      });
<span class="nc" id="L419">    m_NotesText.addFocusListener(new FocusAdapter() {</span>
	public void focusLost(FocusEvent e) {
<span class="nc" id="L421">	  m_Exp.setNotes(m_NotesText.getText());</span>
<span class="nc" id="L422">	}</span>
      });
    
    // Set up the GUI layout
<span class="nc" id="L426">    JPanel buttons = new JPanel();</span>
<span class="nc" id="L427">    GridBagLayout gb = new GridBagLayout();</span>
<span class="nc" id="L428">    GridBagConstraints constraints = new GridBagConstraints();</span>
<span class="nc" id="L429">    buttons.setBorder(BorderFactory.createEmptyBorder(10, 5, 10, 5));</span>
<span class="nc" id="L430">    buttons.setLayout(gb);</span>
<span class="nc" id="L431">    constraints.gridx=0;constraints.gridy=0;constraints.weightx=5;</span>
<span class="nc" id="L432">    constraints.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L433">    constraints.gridwidth=1;constraints.gridheight=1;</span>
<span class="nc" id="L434">    constraints.insets = new Insets(0,2,0,2);</span>
<span class="nc" id="L435">    buttons.add(m_OpenBut,constraints);</span>
<span class="nc" id="L436">    constraints.gridx=1;constraints.gridy=0;constraints.weightx=5;</span>
<span class="nc" id="L437">    constraints.gridwidth=1;constraints.gridheight=1;</span>
<span class="nc" id="L438">    buttons.add(m_SaveBut,constraints);</span>
<span class="nc" id="L439">    constraints.gridx=2;constraints.gridy=0;constraints.weightx=5;</span>
<span class="nc" id="L440">    constraints.gridwidth=1;constraints.gridheight=1;</span>
<span class="nc" id="L441">    buttons.add(m_NewBut,constraints);</span>

<span class="nc" id="L443">    JPanel destName = new JPanel();</span>
<span class="nc" id="L444">    destName.setLayout(new BorderLayout(5, 5));</span>
<span class="nc" id="L445">    destName.add(m_ResultsDestinationPathLabel, BorderLayout.WEST);</span>
<span class="nc" id="L446">    destName.add(m_ResultsDestinationPathTField, BorderLayout.CENTER);</span>
    
<span class="nc" id="L448">    m_ResultsDestinationCBox.addItem(DEST_ARFF_TEXT);</span>
<span class="nc" id="L449">    m_ResultsDestinationCBox.addItem(DEST_CSV_TEXT);</span>
<span class="nc" id="L450">    m_ResultsDestinationCBox.addItem(DEST_DATABASE_TEXT);</span>
    
<span class="nc" id="L452">    m_ResultsDestinationCBox.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L454">	  destinationTypeChanged();</span>
<span class="nc" id="L455">	}</span>
      });

<span class="nc" id="L458">    JPanel destInner = new JPanel();</span>
<span class="nc" id="L459">    destInner.setLayout(new BorderLayout(5, 5));</span>
<span class="nc" id="L460">    destInner.add(m_ResultsDestinationCBox, BorderLayout.WEST);</span>
<span class="nc" id="L461">    destInner.add(destName, BorderLayout.CENTER);</span>
<span class="nc" id="L462">    destInner.add(m_BrowseDestinationButton, BorderLayout.EAST);</span>

<span class="nc" id="L464">    JPanel dest = new JPanel();</span>
<span class="nc" id="L465">    dest.setLayout(new BorderLayout());</span>
<span class="nc" id="L466">    dest.setBorder(BorderFactory.createCompoundBorder(</span>
<span class="nc" id="L467">		  BorderFactory.createTitledBorder(Messages.getInstance().getString(&quot;SimpleSetupPanel_Dest_JPanel_BorderFactoryCreateTitledBorder_Text&quot;)),</span>
<span class="nc" id="L468">		  BorderFactory.createEmptyBorder(0, 5, 5, 5)</span>
		  ));
<span class="nc" id="L470">    dest.add(destInner, BorderLayout.NORTH);</span>

<span class="nc" id="L472">    JPanel expParam = new JPanel();</span>
<span class="nc" id="L473">    expParam.setLayout(new BorderLayout(5, 5));</span>
<span class="nc" id="L474">    expParam.add(m_ExperimentParameterLabel, BorderLayout.WEST);</span>
<span class="nc" id="L475">    expParam.add(m_ExperimentParameterTField, BorderLayout.CENTER);</span>

<span class="nc" id="L477">    ButtonGroup typeBG = new ButtonGroup();</span>
<span class="nc" id="L478">    typeBG.add(m_ExpClassificationRBut);</span>
<span class="nc" id="L479">    typeBG.add(m_ExpRegressionRBut);</span>
<span class="nc" id="L480">    m_ExpClassificationRBut.setSelected(true);</span>

<span class="nc" id="L482">    JPanel typeRButtons = new JPanel();</span>
<span class="nc" id="L483">    typeRButtons.setLayout(new GridLayout(1,0));</span>
<span class="nc" id="L484">    typeRButtons.add(m_ExpClassificationRBut);</span>
<span class="nc" id="L485">    typeRButtons.add(m_ExpRegressionRBut);</span>

<span class="nc" id="L487">    m_ExperimentTypeCBox.addItem(TYPE_CROSSVALIDATION_TEXT);</span>
<span class="nc" id="L488">    m_ExperimentTypeCBox.addItem(TYPE_RANDOMSPLIT_TEXT);</span>
<span class="nc" id="L489">    m_ExperimentTypeCBox.addItem(TYPE_FIXEDSPLIT_TEXT);</span>

<span class="nc" id="L491">    m_ExperimentTypeCBox.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L493">	  expTypeChanged();</span>
<span class="nc" id="L494">	}</span>
      });

<span class="nc" id="L497">    JPanel typeInner = new JPanel();</span>
<span class="nc" id="L498">    typeInner.setLayout(new GridLayout(0,1));</span>
<span class="nc" id="L499">    typeInner.add(m_ExperimentTypeCBox);</span>
<span class="nc" id="L500">    typeInner.add(expParam);</span>
<span class="nc" id="L501">    typeInner.add(typeRButtons);</span>

<span class="nc" id="L503">    JPanel type = new JPanel();</span>
<span class="nc" id="L504">    type.setLayout(new BorderLayout());</span>
<span class="nc" id="L505">    type.setBorder(BorderFactory.createCompoundBorder(</span>
<span class="nc" id="L506">		  BorderFactory.createTitledBorder(Messages.getInstance().getString(&quot;SimpleSetupPanel_Type_JPanel_BorderFactoryCreateTitledBorder_Text&quot;)),</span>
<span class="nc" id="L507">		  BorderFactory.createEmptyBorder(0, 5, 5, 5)</span>
		  ));
<span class="nc" id="L509">    type.add(typeInner, BorderLayout.NORTH);</span>

<span class="nc" id="L511">    ButtonGroup iterBG = new ButtonGroup();</span>
<span class="nc" id="L512">    iterBG.add(m_OrderDatasetsFirstRBut);</span>
<span class="nc" id="L513">    iterBG.add(m_OrderAlgorithmsFirstRBut);</span>
<span class="nc" id="L514">    m_OrderDatasetsFirstRBut.setSelected(true);</span>

<span class="nc" id="L516">    JPanel numIter = new JPanel();</span>
<span class="nc" id="L517">    numIter.setLayout(new BorderLayout(5, 5));</span>
<span class="nc" id="L518">    numIter.add(new JLabel(Messages.getInstance().getString(&quot;SimpleSetupPanel_NumIter_JPanel_Add_JLabel_Text&quot;)), BorderLayout.WEST);</span>
<span class="nc" id="L519">    numIter.add(m_NumberOfRepetitionsTField, BorderLayout.CENTER);</span>

<span class="nc" id="L521">    JPanel controlInner = new JPanel();</span>
<span class="nc" id="L522">    controlInner.setLayout(new GridLayout(0,1));</span>
<span class="nc" id="L523">    controlInner.add(numIter);</span>
<span class="nc" id="L524">    controlInner.add(m_OrderDatasetsFirstRBut);</span>
<span class="nc" id="L525">    controlInner.add(m_OrderAlgorithmsFirstRBut);</span>

<span class="nc" id="L527">    JPanel control = new JPanel();</span>
<span class="nc" id="L528">    control.setLayout(new BorderLayout());</span>
<span class="nc" id="L529">    control.setBorder(BorderFactory.createCompoundBorder(</span>
<span class="nc" id="L530">		  BorderFactory.createTitledBorder(Messages.getInstance().getString(&quot;SimpleSetupPanel_Control_JPanel_BorderFactoryCreateTitledBorder_Text&quot;)),</span>
<span class="nc" id="L531">		  BorderFactory.createEmptyBorder(0, 5, 5, 5)</span>
		  ));
<span class="nc" id="L533">    control.add(controlInner, BorderLayout.NORTH);</span>

<span class="nc" id="L535">    JPanel type_control = new JPanel();</span>
<span class="nc" id="L536">    type_control.setLayout(new GridLayout(1,0));</span>
<span class="nc" id="L537">    type_control.add(type);</span>
<span class="nc" id="L538">    type_control.add(control);</span>

<span class="nc" id="L540">    JPanel notes = new JPanel();</span>
<span class="nc" id="L541">    notes.setLayout(new BorderLayout());</span>
<span class="nc" id="L542">    notes.add(m_NotesButton, BorderLayout.CENTER);</span>

<span class="nc" id="L544">    JPanel top1 = new JPanel();</span>
<span class="nc" id="L545">    top1.setLayout(new BorderLayout());</span>
<span class="nc" id="L546">    top1.add(dest, BorderLayout.NORTH);</span>
<span class="nc" id="L547">    top1.add(type_control, BorderLayout.CENTER);</span>

<span class="nc" id="L549">    JPanel top = new JPanel();</span>
<span class="nc" id="L550">    top.setLayout(new BorderLayout());</span>
<span class="nc" id="L551">    top.add(buttons, BorderLayout.NORTH);</span>
<span class="nc" id="L552">    top.add(top1, BorderLayout.CENTER);  </span>

<span class="nc" id="L554">    JPanel datasets = new JPanel();</span>
<span class="nc" id="L555">    datasets.setLayout(new BorderLayout());</span>
<span class="nc" id="L556">    datasets.add(m_DatasetListPanel, BorderLayout.CENTER);</span>

<span class="nc" id="L558">    JPanel algorithms = new JPanel();</span>
<span class="nc" id="L559">    algorithms.setLayout(new BorderLayout());</span>
<span class="nc" id="L560">    algorithms.add(m_AlgorithmListPanel, BorderLayout.CENTER);</span>

<span class="nc" id="L562">    JPanel schemes = new JPanel();</span>
<span class="nc" id="L563">    schemes.setLayout(new GridLayout(1,0));</span>
<span class="nc" id="L564">    schemes.add(datasets);</span>
<span class="nc" id="L565">    schemes.add(algorithms);</span>

<span class="nc" id="L567">    setLayout(new BorderLayout());</span>
<span class="nc" id="L568">    add(top, BorderLayout.NORTH);</span>
<span class="nc" id="L569">    add(schemes, BorderLayout.CENTER);</span>
<span class="nc" id="L570">    add(notes, BorderLayout.SOUTH);</span>
<span class="nc" id="L571">  }</span>
  
  /**
   * Sets the selected item of an combobox, since using setSelectedItem(...)
   * doesn't work, if one checks object references!
   *
   * @param cb      the combobox to set the item for
   * @param item    the item to set active
   */
  protected void setSelectedItem(JComboBox cb, String item) {
    int       i;

<span class="nc bnc" id="L583" title="All 2 branches missed.">    for (i = 0; i &lt; cb.getItemCount(); i++) {</span>
<span class="nc bnc" id="L584" title="All 2 branches missed.">      if (cb.getItemAt(i).toString().equals(item)) {</span>
<span class="nc" id="L585">        cb.setSelectedIndex(i);</span>
<span class="nc" id="L586">        break;</span>
      }
    }
<span class="nc" id="L589">  }</span>
  
  /**
   * Deletes the notes frame.
   */
  protected void removeNotesFrame() {
<span class="nc" id="L595">    m_NotesFrame.setVisible(false);</span>
<span class="nc" id="L596">  }</span>

  /**
   * Gets te users consent for converting the experiment to a simpler form.
   *
   * @return true if the user has given consent, false otherwise
   */  
  private boolean userWantsToConvert() {
    
<span class="nc bnc" id="L605" title="All 2 branches missed.">    if (m_userHasBeenAskedAboutConversion) return true;</span>
<span class="nc" id="L606">    m_userHasBeenAskedAboutConversion = true;</span>
<span class="nc bnc" id="L607" title="All 2 branches missed.">    return (JOptionPane.showConfirmDialog(this,</span>
<span class="nc" id="L608">    		Messages.getInstance().getString(&quot;SimpleSetupPanel_UserWantsToConvert_JOptionPaneShowConfirmDialog_Text_First&quot;),</span>
<span class="nc" id="L609">					  Messages.getInstance().getString(&quot;SimpleSetupPanel_UserWantsToConvert_JOptionPaneShowConfirmDialog_Text_Second&quot;),</span>
<span class="nc" id="L610">					  JOptionPane.YES_NO_OPTION,</span>
<span class="nc" id="L611">					  JOptionPane.WARNING_MESSAGE) == JOptionPane.YES_OPTION);</span>
  }

  /**
   * Sets the panel used to switch between simple and advanced modes.
   *
   * @param modePanel the panel
   */
  public void setModePanel(SetupModePanel modePanel) {

<span class="nc" id="L621">    m_modePanel = modePanel;</span>
<span class="nc" id="L622">  }</span>

  /**
   * Sets the experiment to configure.
   *
   * @param exp a value of type 'Experiment'
   * @return true if experiment could be configured, false otherwise
   */
  public boolean setExperiment(Experiment exp) {
    
<span class="nc" id="L632">    m_userHasBeenAskedAboutConversion = false;</span>
<span class="nc" id="L633">    m_Exp = null; // hold off until we are sure we want conversion</span>
<span class="nc" id="L634">    m_SaveBut.setEnabled(true);</span>

<span class="nc bnc" id="L636" title="All 2 branches missed.">    if (exp.getResultListener() instanceof DatabaseResultListener) {</span>
<span class="nc" id="L637">      m_ResultsDestinationCBox.setSelectedItem(DEST_DATABASE_TEXT);</span>
<span class="nc" id="L638">      m_ResultsDestinationPathLabel.setText(Messages.getInstance().getString(&quot;SimpleSetupPanel_SetExperiment_DatabaseResultListener_ResultsDestinationPathLabel_Text&quot;));</span>
<span class="nc" id="L639">      m_destinationDatabaseURL = ((DatabaseResultListener)exp.getResultListener()).getDatabaseURL();</span>
<span class="nc" id="L640">      m_ResultsDestinationPathTField.setText(m_destinationDatabaseURL);</span>
<span class="nc" id="L641">      m_BrowseDestinationButton.setEnabled(true);</span>
<span class="nc bnc" id="L642" title="All 2 branches missed.">    } else if (exp.getResultListener() instanceof InstancesResultListener) {</span>
<span class="nc" id="L643">      m_ResultsDestinationCBox.setSelectedItem(DEST_ARFF_TEXT);</span>
<span class="nc" id="L644">      m_ResultsDestinationPathLabel.setText(Messages.getInstance().getString(&quot;SimpleSetupPanel_SetExperiment_InstancesResultListener_Text&quot;));</span>
<span class="nc" id="L645">      m_destinationFilename = ((InstancesResultListener)exp.getResultListener()).outputFileName();</span>
<span class="nc" id="L646">      m_ResultsDestinationPathTField.setText(m_destinationFilename);</span>
<span class="nc" id="L647">      m_BrowseDestinationButton.setEnabled(true);</span>
<span class="nc bnc" id="L648" title="All 2 branches missed.">    } else if (exp.getResultListener() instanceof CSVResultListener) {</span>
<span class="nc" id="L649">      m_ResultsDestinationCBox.setSelectedItem(DEST_CSV_TEXT);</span>
<span class="nc" id="L650">      m_ResultsDestinationPathLabel.setText(Messages.getInstance().getString(&quot;SimpleSetupPanel_SetExperiment_CSVResultListener_Text&quot;));</span>
<span class="nc" id="L651">      m_destinationFilename = ((CSVResultListener)exp.getResultListener()).outputFileName();</span>
<span class="nc" id="L652">      m_ResultsDestinationPathTField.setText(m_destinationFilename);</span>
<span class="nc" id="L653">      m_BrowseDestinationButton.setEnabled(true);</span>
    } else {
      // unrecognised result listener 
<span class="nc" id="L656">      System.out.println(Messages.getInstance().getString(&quot;SimpleSetupPanel_SetExperiment_UnrecognisedResultListener_Text&quot;));</span>
<span class="nc bnc" id="L657" title="All 2 branches missed.">      if (userWantsToConvert()) {</span>
<span class="nc" id="L658">	m_ResultsDestinationCBox.setSelectedItem(DEST_ARFF_TEXT);</span>
<span class="nc" id="L659">	m_ResultsDestinationPathLabel.setText(Messages.getInstance().getString(&quot;SimpleSetupPanel_SetExperiment_UnrecognisedResultListener_UserWantsToConvert_Text&quot;));</span>
<span class="nc" id="L660">	m_destinationFilename = &quot;&quot;;</span>
<span class="nc" id="L661">	m_ResultsDestinationPathTField.setText(m_destinationFilename);</span>
<span class="nc" id="L662">	m_BrowseDestinationButton.setEnabled(true);</span>
      } else {
<span class="nc" id="L664">	return false;</span>
      }
    }
<span class="nc" id="L667">    m_ResultsDestinationCBox.setEnabled(true);</span>
<span class="nc" id="L668">    m_ResultsDestinationPathLabel.setEnabled(true);</span>
<span class="nc" id="L669">    m_ResultsDestinationPathTField.setEnabled(true);</span>

<span class="nc bnc" id="L671" title="All 2 branches missed.">    if (exp.getResultProducer() instanceof CrossValidationResultProducer) {</span>
<span class="nc" id="L672">      CrossValidationResultProducer cvrp = (CrossValidationResultProducer) exp.getResultProducer();</span>
<span class="nc" id="L673">      m_numFolds = cvrp.getNumFolds();</span>
<span class="nc" id="L674">      m_ExperimentParameterTField.setText(&quot;&quot; + m_numFolds);</span>
      
<span class="nc bnc" id="L676" title="All 2 branches missed.">      if (cvrp.getSplitEvaluator() instanceof ClassifierSplitEvaluator) {</span>
<span class="nc" id="L677">	m_ExpClassificationRBut.setSelected(true);</span>
<span class="nc" id="L678">	m_ExpRegressionRBut.setSelected(false);</span>
<span class="nc bnc" id="L679" title="All 2 branches missed.">      } else if (cvrp.getSplitEvaluator() instanceof RegressionSplitEvaluator) {</span>
<span class="nc" id="L680">	m_ExpClassificationRBut.setSelected(false);</span>
<span class="nc" id="L681">	m_ExpRegressionRBut.setSelected(true);</span>
      } else {
	// unknown split evaluator
<span class="nc" id="L684">	System.out.println(Messages.getInstance().getString(&quot;SimpleSetupPanel_SetExperiment_UnknownSplitEvaluator_Text&quot;));</span>
<span class="nc bnc" id="L685" title="All 2 branches missed.">	if (userWantsToConvert()) {</span>
<span class="nc" id="L686">	  m_ExpClassificationRBut.setSelected(true);</span>
<span class="nc" id="L687">	  m_ExpRegressionRBut.setSelected(false);</span>
	} else {
<span class="nc" id="L689">	  return false;</span>
	}
      }
<span class="nc" id="L692">      m_ExperimentTypeCBox.setSelectedItem(TYPE_CROSSVALIDATION_TEXT);</span>
<span class="nc bnc" id="L693" title="All 2 branches missed.">    } else if (exp.getResultProducer() instanceof RandomSplitResultProducer) {</span>
<span class="nc" id="L694">      RandomSplitResultProducer rsrp = (RandomSplitResultProducer) exp.getResultProducer();</span>
<span class="nc bnc" id="L695" title="All 2 branches missed.">      if (rsrp.getRandomizeData()) {</span>
<span class="nc" id="L696">	m_ExperimentTypeCBox.setSelectedItem(TYPE_RANDOMSPLIT_TEXT);</span>
      } else {
<span class="nc" id="L698">	m_ExperimentTypeCBox.setSelectedItem(TYPE_FIXEDSPLIT_TEXT);</span>
      }
<span class="nc bnc" id="L700" title="All 2 branches missed.">      if (rsrp.getSplitEvaluator() instanceof ClassifierSplitEvaluator) {</span>
<span class="nc" id="L701">	m_ExpClassificationRBut.setSelected(true);</span>
<span class="nc" id="L702">	m_ExpRegressionRBut.setSelected(false);</span>
<span class="nc bnc" id="L703" title="All 2 branches missed.">      } else if (rsrp.getSplitEvaluator() instanceof RegressionSplitEvaluator) {</span>
<span class="nc" id="L704">	m_ExpClassificationRBut.setSelected(false);</span>
<span class="nc" id="L705">	m_ExpRegressionRBut.setSelected(true);</span>
      } else {
	// unknown split evaluator
<span class="nc" id="L708">	System.out.println(Messages.getInstance().getString(&quot;SimpleSetupPanel_SetExperiment_UnknownSplitEvaluator_Text_First&quot;));</span>
<span class="nc bnc" id="L709" title="All 2 branches missed.">	if (userWantsToConvert()) {</span>
<span class="nc" id="L710">	  m_ExpClassificationRBut.setSelected(true);</span>
<span class="nc" id="L711">	  m_ExpRegressionRBut.setSelected(false);</span>
	} else {
<span class="nc" id="L713">	  return false;</span>
	}
      }
<span class="nc" id="L716">      m_trainPercent = rsrp.getTrainPercent();</span>
<span class="nc" id="L717">      m_ExperimentParameterTField.setText(&quot;&quot; + m_trainPercent);</span>
      
    } else {
      // unknown experiment type
<span class="nc" id="L721">      System.out.println(Messages.getInstance().getString(&quot;SimpleSetupPanel_SetExperiment_UnknownPropertyIteration_Text&quot;));</span>
<span class="nc bnc" id="L722" title="All 2 branches missed.">      if (userWantsToConvert()) {</span>
<span class="nc" id="L723">	m_ExperimentTypeCBox.setSelectedItem(TYPE_CROSSVALIDATION_TEXT);</span>
<span class="nc" id="L724">	m_ExpClassificationRBut.setSelected(true);</span>
<span class="nc" id="L725">	m_ExpRegressionRBut.setSelected(false);</span>
      } else {
<span class="nc" id="L727">	return false;</span>
      }
    }

<span class="nc" id="L731">    m_ExperimentTypeCBox.setEnabled(true);</span>
<span class="nc" id="L732">    m_ExperimentParameterLabel.setEnabled(true);</span>
<span class="nc" id="L733">    m_ExperimentParameterTField.setEnabled(true);</span>
<span class="nc" id="L734">    m_ExpClassificationRBut.setEnabled(true);</span>
<span class="nc" id="L735">    m_ExpRegressionRBut.setEnabled(true);</span>
    
<span class="nc bnc" id="L737" title="All 2 branches missed.">    if (exp.getRunLower() == 1) {</span>
<span class="nc" id="L738">      m_numRepetitions = exp.getRunUpper();</span>
<span class="nc" id="L739">      m_NumberOfRepetitionsTField.setText(&quot;&quot; + m_numRepetitions);</span>
    } else {
      // unsupported iterations
<span class="nc" id="L742">      System.out.println(Messages.getInstance().getString(&quot;SimpleSetupPanel_SetExperiment_UnknownPropertyIteration_Text_Alpha&quot;));</span>
<span class="nc bnc" id="L743" title="All 2 branches missed.">      if (userWantsToConvert()) {</span>
<span class="nc" id="L744">	exp.setRunLower(1);</span>
<span class="nc bnc" id="L745" title="All 2 branches missed.">	if (m_ExperimentTypeCBox.getSelectedItem() == TYPE_FIXEDSPLIT_TEXT) {</span>
<span class="nc" id="L746">	  exp.setRunUpper(1);</span>
<span class="nc" id="L747">	  m_NumberOfRepetitionsTField.setEnabled(false);</span>
<span class="nc" id="L748">	  m_NumberOfRepetitionsTField.setText(&quot;1&quot;);</span>
	} else {
<span class="nc" id="L750">	  exp.setRunUpper(10);</span>
<span class="nc" id="L751">	  m_numRepetitions = 10;</span>
<span class="nc" id="L752">	  m_NumberOfRepetitionsTField.setText(&quot;&quot; + m_numRepetitions);</span>
	}
	
      } else {
<span class="nc" id="L756">	return false;</span>
      }
    }
<span class="nc" id="L759">    m_NumberOfRepetitionsTField.setEnabled(true);</span>

<span class="nc" id="L761">    m_OrderDatasetsFirstRBut.setSelected(exp.getAdvanceDataSetFirst());</span>
<span class="nc bnc" id="L762" title="All 2 branches missed.">    m_OrderAlgorithmsFirstRBut.setSelected(!exp.getAdvanceDataSetFirst());</span>
<span class="nc" id="L763">    m_OrderDatasetsFirstRBut.setEnabled(true);</span>
<span class="nc" id="L764">    m_OrderAlgorithmsFirstRBut.setEnabled(true);</span>

<span class="nc" id="L766">    m_NotesText.setText(exp.getNotes());</span>
<span class="nc" id="L767">    m_NotesButton.setEnabled(true);</span>

<span class="nc bnc" id="L769" title="All 4 branches missed.">    if (!exp.getUsePropertyIterator() || !(exp.getPropertyArray() instanceof Classifier[])) {</span>
      // unknown property iteration
<span class="nc" id="L771">      System.out.println(Messages.getInstance().getString(&quot;SimpleSetupPanel_SetExperiment_UnknownPropertyIteration_Text_First&quot;));</span>
<span class="nc bnc" id="L772" title="All 2 branches missed.">      if (userWantsToConvert()) {</span>
<span class="nc" id="L773">	exp.setPropertyArray(new Classifier[0]);</span>
<span class="nc" id="L774">	exp.setUsePropertyIterator(true);</span>
      } else {
<span class="nc" id="L776">	return false;</span>
      }
    }

<span class="nc" id="L780">    m_DatasetListPanel.setExperiment(exp);</span>
<span class="nc" id="L781">    m_AlgorithmListPanel.setExperiment(exp);</span>
    
<span class="nc" id="L783">    m_Exp = exp;</span>
<span class="nc" id="L784">    expTypeChanged(); // recreate experiment</span>
    
<span class="nc" id="L786">    m_Support.firePropertyChange(&quot;&quot;, null, null);</span>
    
<span class="nc" id="L788">    return true;</span>
  }

  /**
   * Gets the currently configured experiment.
   *
   * @return the currently configured experiment.
   */
  public Experiment getExperiment() {

<span class="nc" id="L798">    return m_Exp;</span>
  }
  
  /**
   * Prompts the user to select an experiment file and loads it.
   */
  private void openExperiment() {
    
<span class="nc" id="L806">    int returnVal = m_FileChooser.showOpenDialog(this);</span>
<span class="nc bnc" id="L807" title="All 2 branches missed.">    if (returnVal != JFileChooser.APPROVE_OPTION) {</span>
<span class="nc" id="L808">      return;</span>
    }
<span class="nc" id="L810">    File expFile = m_FileChooser.getSelectedFile();</span>
    
    // add extension if necessary
<span class="nc bnc" id="L813" title="All 2 branches missed.">    if (m_FileChooser.getFileFilter() == m_ExpFilter) {</span>
<span class="nc bnc" id="L814" title="All 2 branches missed.">      if (!expFile.getName().toLowerCase().endsWith(Experiment.FILE_EXTENSION))</span>
<span class="nc" id="L815">        expFile = new File(expFile.getParent(), expFile.getName() + Experiment.FILE_EXTENSION);</span>
    }
<span class="nc bnc" id="L817" title="All 2 branches missed.">    else if (m_FileChooser.getFileFilter() == m_KOMLFilter) {</span>
<span class="nc bnc" id="L818" title="All 2 branches missed.">      if (!expFile.getName().toLowerCase().endsWith(KOML.FILE_EXTENSION))</span>
<span class="nc" id="L819">        expFile = new File(expFile.getParent(), expFile.getName() + KOML.FILE_EXTENSION);</span>
    }
<span class="nc bnc" id="L821" title="All 2 branches missed.">    else if (m_FileChooser.getFileFilter() == m_XMLFilter) {</span>
<span class="nc bnc" id="L822" title="All 2 branches missed.">      if (!expFile.getName().toLowerCase().endsWith(&quot;.xml&quot;))</span>
<span class="nc" id="L823">        expFile = new File(expFile.getParent(), expFile.getName() + &quot;.xml&quot;);</span>
    }
    
    try {
<span class="nc" id="L827">      Experiment exp = Experiment.read(expFile.getAbsolutePath());</span>
<span class="nc bnc" id="L828" title="All 2 branches missed.">      if (!setExperiment(exp)) {</span>
<span class="nc bnc" id="L829" title="All 2 branches missed.">	if (m_modePanel != null) m_modePanel.switchToAdvanced(exp);</span>
      }
<span class="nc" id="L831">      System.err.println(Messages.getInstance().getString(&quot;SimpleSetupPanel_OpenExperiment_Exception_JOptionPaneShowMessageDialog_Text&quot;) + exp);</span>
<span class="nc" id="L832">    } catch (Exception ex) {</span>
<span class="nc" id="L833">      ex.printStackTrace();</span>
<span class="nc" id="L834">      JOptionPane.showMessageDialog(this, Messages.getInstance().getString(&quot;SimpleSetupPanel_OpenExperiment_Exception_JOptionPaneShowMessageDialog_Text_First&quot;)</span>
<span class="nc" id="L835">				    + expFile</span>
<span class="nc" id="L836">				    + Messages.getInstance().getString(&quot;SimpleSetupPanel_OpenExperiment_Exception_JOptionPaneShowMessageDialog_Text_Second&quot;) + ex.getMessage(),</span>
<span class="nc" id="L837">				    Messages.getInstance().getString(&quot;SimpleSetupPanel_OpenExperiment_Exception_JOptionPaneShowMessageDialog_Text_Third&quot;),</span>
<span class="nc" id="L838">				    JOptionPane.ERROR_MESSAGE);</span>
      // Pop up error dialog
    }
<span class="nc" id="L841">  }</span>

  /**
   * Prompts the user for a filename to save the experiment to, then saves
   * the experiment.
   */
  private void saveExperiment() {

<span class="nc" id="L849">    int returnVal = m_FileChooser.showSaveDialog(this);</span>
<span class="nc bnc" id="L850" title="All 2 branches missed.">    if (returnVal != JFileChooser.APPROVE_OPTION) {</span>
<span class="nc" id="L851">      return;</span>
    }
<span class="nc" id="L853">    File expFile = m_FileChooser.getSelectedFile();</span>
    
    // add extension if necessary
<span class="nc bnc" id="L856" title="All 2 branches missed.">    if (m_FileChooser.getFileFilter() == m_ExpFilter) {</span>
<span class="nc bnc" id="L857" title="All 2 branches missed.">      if (!expFile.getName().toLowerCase().endsWith(Experiment.FILE_EXTENSION))</span>
<span class="nc" id="L858">        expFile = new File(expFile.getParent(), expFile.getName() + Experiment.FILE_EXTENSION);</span>
    }
<span class="nc bnc" id="L860" title="All 2 branches missed.">    else if (m_FileChooser.getFileFilter() == m_KOMLFilter) {</span>
<span class="nc bnc" id="L861" title="All 2 branches missed.">      if (!expFile.getName().toLowerCase().endsWith(KOML.FILE_EXTENSION))</span>
<span class="nc" id="L862">        expFile = new File(expFile.getParent(), expFile.getName() + KOML.FILE_EXTENSION);</span>
    }
<span class="nc bnc" id="L864" title="All 2 branches missed.">    else if (m_FileChooser.getFileFilter() == m_XMLFilter) {</span>
<span class="nc bnc" id="L865" title="All 2 branches missed.">      if (!expFile.getName().toLowerCase().endsWith(&quot;.xml&quot;))</span>
<span class="nc" id="L866">        expFile = new File(expFile.getParent(), expFile.getName() + &quot;.xml&quot;);</span>
    }
    
    try {
<span class="nc" id="L870">      Experiment.write(expFile.getAbsolutePath(), m_Exp);</span>
<span class="nc" id="L871">      System.err.println(Messages.getInstance().getString(&quot;SimpleSetupPanel_SaveExperiment_Error_Text&quot;) + m_Exp);</span>
<span class="nc" id="L872">    } catch (Exception ex) {</span>
<span class="nc" id="L873">      ex.printStackTrace();</span>
<span class="nc" id="L874">      JOptionPane.showMessageDialog(this, Messages.getInstance().getString(&quot;SimpleSetupPanel_SaveExperiment_Exception_JOptionPaneShowMessageDialog_Text_First&quot;)</span>
<span class="nc" id="L875">				    + expFile</span>
<span class="nc" id="L876">				    + Messages.getInstance().getString(&quot;SimpleSetupPanel_SaveExperiment_Exception_JOptionPaneShowMessageDialog_Text_Second&quot;) + ex.getMessage(),</span>
<span class="nc" id="L877">				    Messages.getInstance().getString(&quot;SimpleSetupPanel_SaveExperiment_Exception_JOptionPaneShowMessageDialog_Text_Third&quot;),</span>
<span class="nc" id="L878">				    JOptionPane.ERROR_MESSAGE);</span>
    }
<span class="nc" id="L880">  }</span>

  /**
   * Adds a PropertyChangeListener who will be notified of value changes.
   *
   * @param l a value of type 'PropertyChangeListener'
   */
  public void addPropertyChangeListener(PropertyChangeListener l) {
<span class="nc" id="L888">    m_Support.addPropertyChangeListener(l);</span>
<span class="nc" id="L889">  }</span>

  /**
   * Removes a PropertyChangeListener.
   *
   * @param l a value of type 'PropertyChangeListener'
   */
  public void removePropertyChangeListener(PropertyChangeListener l) {
<span class="nc" id="L897">    m_Support.removePropertyChangeListener(l);</span>
<span class="nc" id="L898">  }</span>

  /**
   * Responds to a change in the destination type.
   */
  private void destinationTypeChanged() {

<span class="nc bnc" id="L905" title="All 2 branches missed.">    if (m_Exp == null) return;</span>

<span class="nc" id="L907">    String str = &quot;&quot;;</span>

<span class="nc bnc" id="L909" title="All 2 branches missed.">    if (m_ResultsDestinationCBox.getSelectedItem() == DEST_DATABASE_TEXT) {</span>
<span class="nc" id="L910">      m_ResultsDestinationPathLabel.setText(Messages.getInstance().getString(&quot;SimpleSetupPanel_DestinationTypeChanged_DEST_DATABASE_TEXT_ResultsDestinationPathLabel_Text_First&quot;));</span>
<span class="nc" id="L911">      str = m_destinationDatabaseURL;</span>
<span class="nc" id="L912">      m_BrowseDestinationButton.setEnabled(true); //!!!</span>
<span class="nc" id="L913">      m_BrowseDestinationButton.setText(Messages.getInstance().getString(&quot;SimpleSetupPanel_DestinationTypeChanged_DEST_DATABASE_TEXT_BrowseDestinationButton_Text&quot;));</span>
    } else {
<span class="nc" id="L915">      m_ResultsDestinationPathLabel.setText(Messages.getInstance().getString(&quot;SimpleSetupPanel_DestinationTypeChanged_DEST_DATABASE_TEXT_ResultsDestinationPathLabel_Text_Second&quot;));</span>
<span class="nc bnc" id="L916" title="All 2 branches missed.">      if (m_ResultsDestinationCBox.getSelectedItem() == DEST_ARFF_TEXT) {</span>
<span class="nc" id="L917">	int ind = m_destinationFilename.lastIndexOf(&quot;.csv&quot;);</span>
<span class="nc bnc" id="L918" title="All 2 branches missed.">	if (ind &gt; -1) {</span>
<span class="nc" id="L919">	  m_destinationFilename = m_destinationFilename.substring(0, ind) + &quot;.arff&quot;;</span>
	}
      }
<span class="nc bnc" id="L922" title="All 2 branches missed.">      if (m_ResultsDestinationCBox.getSelectedItem() == DEST_CSV_TEXT) {</span>
<span class="nc" id="L923">	int ind = m_destinationFilename.lastIndexOf(&quot;.arff&quot;);</span>
<span class="nc bnc" id="L924" title="All 2 branches missed.">	if (ind &gt; -1) {</span>
<span class="nc" id="L925">	  m_destinationFilename = m_destinationFilename.substring(0, ind) + &quot;.csv&quot;;</span>
	}
      }
<span class="nc" id="L928">      str = m_destinationFilename;</span>
<span class="nc bnc" id="L929" title="All 2 branches missed.">      if (m_ResultsDestinationCBox.getSelectedItem() == DEST_ARFF_TEXT) {</span>
<span class="nc" id="L930">	int ind = str.lastIndexOf(&quot;.csv&quot;);</span>
<span class="nc bnc" id="L931" title="All 2 branches missed.">	if (ind &gt; -1) {</span>
<span class="nc" id="L932">	  str = str.substring(0, ind) + &quot;.arff&quot;;</span>
	}
      }
<span class="nc bnc" id="L935" title="All 2 branches missed.">      if (m_ResultsDestinationCBox.getSelectedItem() == DEST_CSV_TEXT) {</span>
<span class="nc" id="L936">	int ind = str.lastIndexOf(&quot;.arff&quot;);</span>
<span class="nc bnc" id="L937" title="All 2 branches missed.">	if (ind &gt; -1) {</span>
<span class="nc" id="L938">	  str = str.substring(0, ind) + &quot;.csv&quot;;</span>
	}
      }
<span class="nc" id="L941">      m_BrowseDestinationButton.setEnabled(true);</span>
<span class="nc" id="L942">      m_BrowseDestinationButton.setText(Messages.getInstance().getString(&quot;SimpleSetupPanel_DestinationTypeChanged_BrowseDestinationButton_Text&quot;));</span>
    }

<span class="nc bnc" id="L945" title="All 2 branches missed.">    if (m_ResultsDestinationCBox.getSelectedItem() == DEST_DATABASE_TEXT) {</span>
<span class="nc" id="L946">      DatabaseResultListener drl = null;</span>
      try {
<span class="nc" id="L948">	drl = new DatabaseResultListener();</span>
<span class="nc" id="L949">      } catch (Exception e) {</span>
<span class="nc" id="L950">	e.printStackTrace();</span>
      }
<span class="nc" id="L952">      drl.setDatabaseURL(m_destinationDatabaseURL);</span>
<span class="nc" id="L953">      m_Exp.setResultListener(drl);</span>
    } else {
<span class="nc bnc" id="L955" title="All 2 branches missed.">      if (m_ResultsDestinationCBox.getSelectedItem() == DEST_ARFF_TEXT) {</span>
<span class="nc" id="L956">	InstancesResultListener irl = new InstancesResultListener();</span>
<span class="nc bnc" id="L957" title="All 2 branches missed.">	if (!m_destinationFilename.equals(&quot;&quot;)) {</span>
<span class="nc" id="L958">	  irl.setOutputFile(new File(m_destinationFilename));</span>
	}
<span class="nc" id="L960">	m_Exp.setResultListener(irl);</span>
<span class="nc bnc" id="L961" title="All 2 branches missed.">      } else if (m_ResultsDestinationCBox.getSelectedItem() == DEST_CSV_TEXT) {</span>
<span class="nc" id="L962">	CSVResultListener crl = new CSVResultListener();</span>
<span class="nc bnc" id="L963" title="All 2 branches missed.">	if (!m_destinationFilename.equals(&quot;&quot;)) {</span>
<span class="nc" id="L964">	  crl.setOutputFile(new File(m_destinationFilename));</span>
	}
<span class="nc" id="L966">	m_Exp.setResultListener(crl);</span>
      }
    }

<span class="nc" id="L970">    m_ResultsDestinationPathTField.setText(str);</span>

<span class="nc" id="L972">    m_Support.firePropertyChange(&quot;&quot;, null, null);</span>
<span class="nc" id="L973">  }</span>

  /**
   * Responds to a change in the destination address.
   */
  private void destinationAddressChanged() {

<span class="nc bnc" id="L980" title="All 2 branches missed.">    if (m_Exp == null) return;</span>

<span class="nc bnc" id="L982" title="All 2 branches missed.">    if (m_ResultsDestinationCBox.getSelectedItem() == DEST_DATABASE_TEXT) {</span>
<span class="nc" id="L983">      m_destinationDatabaseURL = m_ResultsDestinationPathTField.getText();</span>
<span class="nc bnc" id="L984" title="All 2 branches missed.">      if (m_Exp.getResultListener() instanceof DatabaseResultListener) {</span>
<span class="nc" id="L985">	((DatabaseResultListener)m_Exp.getResultListener()).setDatabaseURL(m_destinationDatabaseURL);</span>
      }
    } else {
<span class="nc" id="L988">      File resultsFile = null;</span>
<span class="nc" id="L989">      m_destinationFilename = m_ResultsDestinationPathTField.getText();</span>

      // Use temporary file if no file name is provided
<span class="nc bnc" id="L992" title="All 2 branches missed.">      if (m_destinationFilename.equals(&quot;&quot;)) {</span>
	try {
<span class="nc bnc" id="L994" title="All 2 branches missed.">	  if (m_ResultsDestinationCBox.getSelectedItem() == DEST_ARFF_TEXT) {</span>
<span class="nc" id="L995">	    resultsFile = File.createTempFile(&quot;weka_experiment&quot;, &quot;.arff&quot;);</span>
	  }
<span class="nc bnc" id="L997" title="All 2 branches missed.">	  if (m_ResultsDestinationCBox.getSelectedItem() == DEST_CSV_TEXT) {</span>
<span class="nc" id="L998">	    resultsFile = File.createTempFile(&quot;weka_experiment&quot;, &quot;.csv&quot;);</span>
	  }
<span class="nc" id="L1000">	  resultsFile.deleteOnExit();</span>
<span class="nc" id="L1001">	} catch (Exception e) {</span>
<span class="nc" id="L1002">	  System.err.println(Messages.getInstance().getString(&quot;SimpleSetupPanel_DestinationAddressChanged_Exception_Text&quot;));</span>
<span class="nc" id="L1003">	  resultsFile = new File(&quot;-&quot;);</span>
	}
      } else {
<span class="nc bnc" id="L1006" title="All 2 branches missed.">	if (m_ResultsDestinationCBox.getSelectedItem() == DEST_ARFF_TEXT) {</span>
<span class="nc bnc" id="L1007" title="All 2 branches missed.">	  if (!m_destinationFilename.endsWith(&quot;.arff&quot;)) {</span>
<span class="nc" id="L1008">	    m_destinationFilename += &quot;.arff&quot;;</span>
	  }
	}
<span class="nc bnc" id="L1011" title="All 2 branches missed.">	if (m_ResultsDestinationCBox.getSelectedItem() == DEST_CSV_TEXT) {</span>
<span class="nc bnc" id="L1012" title="All 2 branches missed.">	  if (!m_destinationFilename.endsWith(&quot;.csv&quot;)) {</span>
<span class="nc" id="L1013">	    m_destinationFilename += &quot;.csv&quot;;</span>
	  }
	}
<span class="nc" id="L1016">	resultsFile = new File(m_destinationFilename);</span>
      }
<span class="nc" id="L1018">      ((CSVResultListener)m_Exp.getResultListener()).setOutputFile(resultsFile);</span>
<span class="nc" id="L1019">      ((CSVResultListener)m_Exp.getResultListener()).setOutputFileName(m_destinationFilename);</span>
    }

<span class="nc" id="L1022">    m_Support.firePropertyChange(&quot;&quot;, null, null);</span>
<span class="nc" id="L1023">  }</span>

  /**
   * Responds to a change in the experiment type.
   */
  private void expTypeChanged() {

<span class="nc bnc" id="L1030" title="All 2 branches missed.">    if (m_Exp == null) return;</span>

    // update parameter ui
<span class="nc bnc" id="L1033" title="All 2 branches missed.">    if (m_ExperimentTypeCBox.getSelectedItem() == TYPE_CROSSVALIDATION_TEXT) {</span>
<span class="nc" id="L1034">      m_ExperimentParameterLabel.setText(Messages.getInstance().getString(&quot;SimpleSetupPanel_ExpTypeChanged_TYPE_CROSSVALIDATION_TEXT_ExperimentParameterLabel_Text_First&quot;));</span>
<span class="nc" id="L1035">      m_ExperimentParameterTField.setText(&quot;&quot; + m_numFolds);</span>
    } else {
<span class="nc" id="L1037">      m_ExperimentParameterLabel.setText(Messages.getInstance().getString(&quot;SimpleSetupPanel_ExpTypeChanged_TYPE_CROSSVALIDATION_TEXT_ExperimentParameterLabel_Text_Second&quot;));</span>
<span class="nc" id="L1038">      m_ExperimentParameterTField.setText(&quot;&quot; + m_trainPercent);</span>
    }

    // update iteration ui
<span class="nc bnc" id="L1042" title="All 2 branches missed.">    if (m_ExperimentTypeCBox.getSelectedItem() == TYPE_FIXEDSPLIT_TEXT) {</span>
<span class="nc" id="L1043">      m_NumberOfRepetitionsTField.setEnabled(false);</span>
<span class="nc" id="L1044">      m_NumberOfRepetitionsTField.setText(&quot;1&quot;);</span>
<span class="nc" id="L1045">      m_Exp.setRunLower(1);</span>
<span class="nc" id="L1046">      m_Exp.setRunUpper(1);</span>
    } else {
<span class="nc" id="L1048">      m_NumberOfRepetitionsTField.setText(&quot;&quot; + m_numRepetitions);</span>
<span class="nc" id="L1049">      m_NumberOfRepetitionsTField.setEnabled(true);</span>
<span class="nc" id="L1050">      m_Exp.setRunLower(1);</span>
<span class="nc" id="L1051">      m_Exp.setRunUpper(m_numRepetitions);</span>
    }

<span class="nc" id="L1054">    SplitEvaluator se = null;</span>
<span class="nc" id="L1055">    Classifier sec = null;</span>
<span class="nc bnc" id="L1056" title="All 2 branches missed.">    if (m_ExpClassificationRBut.isSelected()) {</span>
<span class="nc" id="L1057">      se = new ClassifierSplitEvaluator();</span>
<span class="nc" id="L1058">      sec = ((ClassifierSplitEvaluator)se).getClassifier();</span>
    } else {
<span class="nc" id="L1060">      se = new RegressionSplitEvaluator();</span>
<span class="nc" id="L1061">      sec = ((RegressionSplitEvaluator)se).getClassifier();</span>
    }
    
    // build new ResultProducer
<span class="nc bnc" id="L1065" title="All 2 branches missed.">    if (m_ExperimentTypeCBox.getSelectedItem() == TYPE_CROSSVALIDATION_TEXT) {</span>
<span class="nc" id="L1066">      CrossValidationResultProducer cvrp = new CrossValidationResultProducer();</span>
<span class="nc" id="L1067">      cvrp.setNumFolds(m_numFolds);</span>
<span class="nc" id="L1068">      cvrp.setSplitEvaluator(se);</span>
      
<span class="nc" id="L1070">      PropertyNode[] propertyPath = new PropertyNode[2];</span>
      try {
<span class="nc" id="L1072">	propertyPath[0] = new PropertyNode(se, new PropertyDescriptor(&quot;splitEvaluator&quot;,</span>
<span class="nc" id="L1073">								      CrossValidationResultProducer.class),</span>
<span class="nc" id="L1074">					   CrossValidationResultProducer.class);</span>
<span class="nc" id="L1075">	propertyPath[1] = new PropertyNode(sec, new PropertyDescriptor(&quot;classifier&quot;,</span>
<span class="nc" id="L1076">								       se.getClass()),</span>
<span class="nc" id="L1077">					   se.getClass());</span>
<span class="nc" id="L1078">      } catch (IntrospectionException e) {</span>
<span class="nc" id="L1079">	e.printStackTrace();</span>
      }
      
<span class="nc" id="L1082">      m_Exp.setResultProducer(cvrp);</span>
<span class="nc" id="L1083">      m_Exp.setPropertyPath(propertyPath);</span>

    } else {
<span class="nc" id="L1086">      RandomSplitResultProducer rsrp = new RandomSplitResultProducer();</span>
<span class="nc bnc" id="L1087" title="All 2 branches missed.">      rsrp.setRandomizeData(m_ExperimentTypeCBox.getSelectedItem() == TYPE_RANDOMSPLIT_TEXT);</span>
<span class="nc" id="L1088">      rsrp.setTrainPercent(m_trainPercent);</span>
<span class="nc" id="L1089">      rsrp.setSplitEvaluator(se);</span>

<span class="nc" id="L1091">      PropertyNode[] propertyPath = new PropertyNode[2];</span>
      try {
<span class="nc" id="L1093">	propertyPath[0] = new PropertyNode(se, new PropertyDescriptor(&quot;splitEvaluator&quot;,</span>
<span class="nc" id="L1094">								      RandomSplitResultProducer.class),</span>
<span class="nc" id="L1095">					   RandomSplitResultProducer.class);</span>
<span class="nc" id="L1096">	propertyPath[1] = new PropertyNode(sec, new PropertyDescriptor(&quot;classifier&quot;,</span>
<span class="nc" id="L1097">								       se.getClass()),</span>
<span class="nc" id="L1098">					   se.getClass());</span>
<span class="nc" id="L1099">      } catch (IntrospectionException e) {</span>
<span class="nc" id="L1100">	e.printStackTrace();</span>
      }

<span class="nc" id="L1103">      m_Exp.setResultProducer(rsrp);</span>
<span class="nc" id="L1104">      m_Exp.setPropertyPath(propertyPath);</span>

    }

<span class="nc" id="L1108">    m_Exp.setUsePropertyIterator(true);</span>
<span class="nc" id="L1109">    m_Support.firePropertyChange(&quot;&quot;, null, null);</span>
<span class="nc" id="L1110">  }</span>

  /**
   * Responds to a change in the experiment parameter.
   */
  private void expParamChanged() {

<span class="nc bnc" id="L1117" title="All 2 branches missed.">    if (m_Exp == null) return;</span>

<span class="nc bnc" id="L1119" title="All 2 branches missed.">    if (m_ExperimentTypeCBox.getSelectedItem() == TYPE_CROSSVALIDATION_TEXT) {</span>
      try {
<span class="nc" id="L1121">	m_numFolds = Integer.parseInt(m_ExperimentParameterTField.getText());</span>
<span class="nc" id="L1122">      } catch (NumberFormatException e) {</span>
<span class="nc" id="L1123">	return;</span>
      }
    } else {
      try {
<span class="nc" id="L1127">	m_trainPercent = Double.parseDouble(m_ExperimentParameterTField.getText());</span>
<span class="nc" id="L1128">      } catch (NumberFormatException e) {</span>
<span class="nc" id="L1129">	return;</span>
      }
    }

<span class="nc bnc" id="L1133" title="All 2 branches missed.">    if (m_ExperimentTypeCBox.getSelectedItem() == TYPE_CROSSVALIDATION_TEXT) {</span>

<span class="nc bnc" id="L1135" title="All 2 branches missed.">      if (m_Exp.getResultProducer() instanceof CrossValidationResultProducer) {</span>
<span class="nc" id="L1136">	CrossValidationResultProducer cvrp = (CrossValidationResultProducer) m_Exp.getResultProducer();</span>
<span class="nc" id="L1137">	cvrp.setNumFolds(m_numFolds);</span>
      } else {
<span class="nc" id="L1139">	return;</span>
      }

    } else {
      
<span class="nc bnc" id="L1144" title="All 2 branches missed.">      if (m_Exp.getResultProducer() instanceof RandomSplitResultProducer) {</span>
<span class="nc" id="L1145">	RandomSplitResultProducer rsrp = (RandomSplitResultProducer) m_Exp.getResultProducer();</span>
<span class="nc bnc" id="L1146" title="All 2 branches missed.">	rsrp.setRandomizeData(m_ExperimentTypeCBox.getSelectedItem() == TYPE_RANDOMSPLIT_TEXT);</span>
<span class="nc" id="L1147">	rsrp.setTrainPercent(m_trainPercent);</span>
      } else {
	//System.err.println(&quot;not rsrp&quot;);
<span class="nc" id="L1150">	return;</span>
      }
    }

<span class="nc" id="L1154">    m_Support.firePropertyChange(&quot;&quot;, null, null);</span>
<span class="nc" id="L1155">  }</span>

  /**
   * Responds to a change in the number of repetitions.
   */
  private void numRepetitionsChanged() {

<span class="nc bnc" id="L1162" title="All 4 branches missed.">    if (m_Exp == null || !m_NumberOfRepetitionsTField.isEnabled()) return;</span>

    try {
<span class="nc" id="L1165">      m_numRepetitions = Integer.parseInt(m_NumberOfRepetitionsTField.getText());</span>
<span class="nc" id="L1166">    } catch (NumberFormatException e) {</span>
<span class="nc" id="L1167">      return;</span>
    }

<span class="nc" id="L1170">    m_Exp.setRunLower(1);</span>
<span class="nc" id="L1171">    m_Exp.setRunUpper(m_numRepetitions);</span>

<span class="nc" id="L1173">    m_Support.firePropertyChange(&quot;&quot;, null, null);</span>
<span class="nc" id="L1174">  }</span>

  /**
   * Lets user enter username/password/URL.
   */
  private void chooseURLUsername() {
<span class="nc" id="L1180">    String dbaseURL=((DatabaseResultListener)m_Exp.getResultListener()).getDatabaseURL();</span>
<span class="nc" id="L1181">    String username=((DatabaseResultListener)m_Exp.getResultListener()).getUsername();</span>
<span class="nc" id="L1182">    DatabaseConnectionDialog dbd= new DatabaseConnectionDialog(null,dbaseURL,username);</span>
<span class="nc" id="L1183">    dbd.setVisible(true);</span>
      
    //if (dbaseURL == null) {
<span class="nc bnc" id="L1186" title="All 2 branches missed.">    if (dbd.getReturnValue()==JOptionPane.CLOSED_OPTION) {</span>
<span class="nc" id="L1187">      return;</span>
    }

<span class="nc" id="L1190">    ((DatabaseResultListener)m_Exp.getResultListener()).setUsername(dbd.getUsername());</span>
<span class="nc" id="L1191">    ((DatabaseResultListener)m_Exp.getResultListener()).setPassword(dbd.getPassword());</span>
<span class="nc" id="L1192">    ((DatabaseResultListener)m_Exp.getResultListener()).setDatabaseURL(dbd.getURL());</span>
<span class="nc" id="L1193">    ((DatabaseResultListener)m_Exp.getResultListener()).setDebug(dbd.getDebug());</span>
<span class="nc" id="L1194">    m_ResultsDestinationPathTField.setText(dbd.getURL());</span>
<span class="nc" id="L1195">  }</span>
  /**
   * Lets user browse for a destination file..
   */
  private void chooseDestinationFile() {

<span class="nc" id="L1201">    FileFilter fileFilter = null;</span>
<span class="nc bnc" id="L1202" title="All 2 branches missed.">    if (m_ResultsDestinationCBox.getSelectedItem() == DEST_CSV_TEXT) {</span>
<span class="nc" id="L1203">      fileFilter = m_csvFileFilter;</span>
    } else {
<span class="nc" id="L1205">      fileFilter = m_arffFileFilter;</span>
    }
<span class="nc" id="L1207">    m_DestFileChooser.setFileFilter(fileFilter);</span>
<span class="nc" id="L1208">    int returnVal = m_DestFileChooser.showSaveDialog(this);</span>
<span class="nc bnc" id="L1209" title="All 2 branches missed.">    if (returnVal != JFileChooser.APPROVE_OPTION) {</span>
<span class="nc" id="L1210">      return;</span>
    }
<span class="nc" id="L1212">    m_ResultsDestinationPathTField.setText(m_DestFileChooser.getSelectedFile().toString());</span>
<span class="nc" id="L1213">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span>AllTests (Nov 28, 2015 2:34:31 PM)</div></body></html>
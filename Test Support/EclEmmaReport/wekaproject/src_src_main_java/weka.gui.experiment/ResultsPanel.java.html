<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>ResultsPanel.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">AllTests (Nov 28, 2015 2:34:31 PM)</a> &gt; <a href="../../index.html" class="el_group">wekaproject</a> &gt; <a href="../index.html" class="el_bundle">src/src/main/java</a> &gt; <a href="index.source.html" class="el_package">weka.gui.experiment</a> &gt; <span class="el_source">ResultsPanel.java</span></div><h1>ResultsPanel.java</h1><pre class="source lang-java linenums"><span class="nc" id="L1">/*</span>
 *    This program is free software; you can redistribute it and/or modify
 *    it under the terms of the GNU General Public License as published by
 *    the Free Software Foundation; either version 2 of the License, or
 *    (at your option) any later version.
 *
 *    This program is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *    GNU General Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License
 *    along with this program; if not, write to the Free Software
 *    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 */

/*
 *    ResultsPanel.java
 *    Copyright (C) 1999 University of Waikato, Hamilton, New Zealand
 *
 */

package weka.gui.experiment;

import weka.core.Attribute;
import weka.core.Instance;
import weka.core.Instances;
import weka.core.Range;
import weka.core.converters.CSVLoader;
import weka.experiment.CSVResultListener;
import weka.experiment.DatabaseResultListener;
import weka.experiment.Experiment;
import weka.experiment.InstanceQuery;
import weka.experiment.PairedCorrectedTTester;
import weka.experiment.ResultMatrix;
import weka.experiment.ResultMatrixPlainText;
import weka.experiment.Tester;
import weka.gui.DatabaseConnectionDialog;
import weka.gui.ExtensionFileFilter;
import weka.gui.GenericObjectEditor;
import weka.gui.ListSelectorDialog;
import weka.gui.ResultHistoryPanel;
import weka.gui.SaveBuffer;

import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.GridLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.Reader;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.StringTokenizer;
import java.util.Vector;

import javax.swing.BorderFactory;
import javax.swing.DefaultComboBoxModel;
import javax.swing.DefaultListModel;
import javax.swing.JButton;
import javax.swing.JCheckBox;
import javax.swing.JComboBox;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JList;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JSplitPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.ListSelectionModel;
import javax.swing.SwingConstants;
import javax.swing.SwingUtilities;

/** 
 * This panel controls simple analysis of experimental results.
 *
 * @author Len Trigg (trigg@cs.waikato.ac.nz)
 * @version $Revision: 7059 $
 */
<span class="nc" id="L91">public class ResultsPanel</span>
  extends JPanel {

  /** for serialization. */
  private static final long serialVersionUID = -4913007978534178569L;

  /** Message shown when no experimental results have been loaded. */
<span class="nc" id="L98">  protected static final String NO_SOURCE = Messages.getInstance().getString(&quot;ResultsPanel_FromFileBut_JButton_Text&quot;);</span>

  /** Click to load results from a file. */
<span class="nc" id="L101">  protected JButton m_FromFileBut = new JButton(Messages.getInstance().getString(&quot;ResultsPanel_FromFileBut_JButton_Text&quot;));</span>

  /** Click to load results from a database. */
<span class="nc" id="L104">  protected JButton m_FromDBaseBut = new JButton(Messages.getInstance().getString(&quot;ResultsPanel_FromDBaseBut_JButton_Text&quot;));</span>

  /** Click to get results from the destination given in the experiment. */
<span class="nc" id="L107">  protected JButton m_FromExpBut = new JButton(Messages.getInstance().getString(&quot;ResultsPanel_FromExpBut_JButton_Text&quot;));</span>

  /** Displays a message about the current result set. */
<span class="nc" id="L110">  protected JLabel m_FromLab = new JLabel(NO_SOURCE);</span>

  /**
   * This is needed to get around a bug in Swing &lt;= 1.1 -- Once everyone
   * is using Swing 1.1.1 or higher just remove this variable and use the
   * no-arg constructor to DefaultComboBoxModel.
   */
<span class="nc" id="L117">  private static String [] FOR_JFC_1_1_DCBM_BUG = {&quot;&quot;};</span>

  /** The model embedded in m_DatasetCombo. */
<span class="nc" id="L120">  protected DefaultComboBoxModel m_DatasetModel =</span>
<span class="nc" id="L121">    new DefaultComboBoxModel(FOR_JFC_1_1_DCBM_BUG);</span>
  
  /** The model embedded in m_CompareCombo. */
<span class="nc" id="L124">  protected DefaultComboBoxModel m_CompareModel = </span>
<span class="nc" id="L125">    new DefaultComboBoxModel(FOR_JFC_1_1_DCBM_BUG);</span>
  
  /** The model embedded in m_SortCombo. */
<span class="nc" id="L128">  protected DefaultComboBoxModel m_SortModel = </span>
<span class="nc" id="L129">    new DefaultComboBoxModel(FOR_JFC_1_1_DCBM_BUG);</span>
  
  /** The model embedded in m_TestsList. */
<span class="nc" id="L132">  protected DefaultListModel m_TestsModel = new DefaultListModel();</span>
  
  /** The model embedded in m_DisplayedList. */
<span class="nc" id="L135">  protected DefaultListModel m_DisplayedModel = new DefaultListModel();</span>

  /** Displays the currently selected Tester-Class. */
<span class="nc" id="L138">  protected JLabel m_TesterClassesLabel = new JLabel(Messages.getInstance().getString(&quot;ResultsPanel_TesterClassesLabel_JButton_Text&quot;),</span>
<span class="nc" id="L139">						 SwingConstants.RIGHT);</span>
  
  /** Contains all the available classes implementing the Tester-Interface 
   * (the display names).
   * @see Tester */
<span class="nc" id="L144">  protected static DefaultComboBoxModel m_TesterClassesModel = </span>
<span class="nc" id="L145">    new DefaultComboBoxModel(FOR_JFC_1_1_DCBM_BUG);</span>

  /** Contains all the available classes implementing the Tester-Interface
   * (the actual Classes).
   * @see Tester */
<span class="nc" id="L150">  protected static Vector m_Testers = null;</span>
  
  /** determine all classes implementing the Tester interface (in the same
   * package!).
   * @see Tester
   * @see ClassDiscovery */
  static {
<span class="nc" id="L157">    Vector classes = GenericObjectEditor.getClassnames(Tester.class.getName());</span>

    // set names and classes
<span class="nc" id="L160">    m_Testers            = new Vector();</span>
<span class="nc" id="L161">    m_TesterClassesModel = new DefaultComboBoxModel();</span>
<span class="nc bnc" id="L162" title="All 2 branches missed.">    for (int i = 0; i &lt; classes.size(); i++) {</span>
      try {
<span class="nc" id="L164">        Class cls = Class.forName(classes.get(i).toString());</span>
<span class="nc" id="L165">        Tester tester = (Tester) cls.newInstance();</span>
<span class="nc" id="L166">        m_Testers.add(cls);</span>
<span class="nc" id="L167">        m_TesterClassesModel.addElement(tester.getDisplayName());</span>
      }
<span class="nc" id="L169">      catch (Exception e) {</span>
<span class="nc" id="L170">        e.printStackTrace();</span>
      }
    }
  }

  /** Lists all the available classes implementing the Tester-Interface.
   * @see Tester */
<span class="nc" id="L177">  protected JComboBox m_TesterClasses = </span>
<span class="nc" id="L178">    new JComboBox(m_TesterClassesModel);</span>

  /** Displays the currently selected column names for the scheme &amp; options. */
<span class="nc" id="L181">  protected JLabel m_DatasetKeyLabel = new JLabel(Messages.getInstance().getString(&quot;ResultsPanel_DatasetKeyLabel_JButton_Text&quot;),</span>
<span class="nc" id="L182">						 SwingConstants.RIGHT);</span>

  /** Click to edit the columns used to determine the scheme. */
<span class="nc" id="L185">  protected JButton m_DatasetKeyBut = new JButton(Messages.getInstance().getString(&quot;ResultsPanel_DatasetKeyBut_JButton_Text&quot;));</span>

  /** Stores the list of attributes for selecting the scheme columns. */
<span class="nc" id="L188">  protected DefaultListModel m_DatasetKeyModel = new DefaultListModel();</span>

  /** Displays the list of selected columns determining the scheme. */
<span class="nc" id="L191">  protected JList m_DatasetKeyList = new JList(m_DatasetKeyModel);</span>

  /** Displays the currently selected column names for the scheme &amp; options. */
<span class="nc" id="L194">  protected JLabel m_ResultKeyLabel = new JLabel(Messages.getInstance().getString(&quot;ResultsPanel_ResultKeyLabel_JButton_Text&quot;),</span>
<span class="nc" id="L195">						 SwingConstants.RIGHT);</span>

  /** Click to edit the columns used to determine the scheme. */
<span class="nc" id="L198">  protected JButton m_ResultKeyBut = new JButton(Messages.getInstance().getString(&quot;ResultsPanel_ResultKeyBut_JButton_Text&quot;));</span>

  /** Stores the list of attributes for selecting the scheme columns. */
<span class="nc" id="L201">  protected DefaultListModel m_ResultKeyModel = new DefaultListModel();</span>

  /** Displays the list of selected columns determining the scheme. */
<span class="nc" id="L204">  protected JList m_ResultKeyList = new JList(m_ResultKeyModel);</span>

  /** Lets the user select which scheme to base comparisons against. */
<span class="nc" id="L207">  protected JButton m_TestsButton = new JButton(Messages.getInstance().getString(&quot;ResultsPanel_TestsButton_JButton_Text&quot;));</span>

  /** Lets the user select which schemes are compared to base. */
<span class="nc" id="L210">  protected JButton m_DisplayedButton = new JButton(Messages.getInstance().getString(&quot;ResultsPanel_DisplayedButton_JButton_Text&quot;));</span>

  /** Holds the list of schemes to base the test against. */
<span class="nc" id="L213">  protected JList m_TestsList = new JList(m_TestsModel);</span>

  /** Holds the list of schemes to display. */
<span class="nc" id="L216">  protected JList m_DisplayedList = new JList(m_DisplayedModel);</span>

  /** Lets the user select which performance measure to analyze. */
<span class="nc" id="L219">  protected JComboBox m_CompareCombo = new JComboBox(m_CompareModel);</span>

  /** Lets the user select which column to use for sorting. */
<span class="nc" id="L222">  protected JComboBox m_SortCombo = new JComboBox(m_SortModel);</span>

  /** Lets the user edit the test significance. */
<span class="nc" id="L225">  protected JTextField m_SigTex = new JTextField(</span>
<span class="nc" id="L226">      &quot;&quot; + ExperimenterDefaults.getSignificance());</span>

  /** Lets the user select whether standard deviations are to be output
      or not. */
<span class="nc" id="L230">  protected JCheckBox m_ShowStdDevs = </span>
<span class="nc" id="L231">    new JCheckBox(&quot;&quot;);</span>
  
  /** lets the user choose the format for the output. */
<span class="nc" id="L234">  protected JButton m_OutputFormatButton = new JButton(Messages.getInstance().getString(&quot;ResultsPanel_OutputFormatButton_JButton_Text&quot;));</span>

  /** Click to start the test. */
<span class="nc" id="L237">  protected JButton m_PerformBut = new JButton(Messages.getInstance().getString(&quot;ResultsPanel_PerformBut_JButton_Text&quot;));</span>
  
  /** Click to save test output to a file. */
<span class="nc" id="L240">  protected JButton m_SaveOutBut = new JButton(Messages.getInstance().getString(&quot;ResultsPanel_SaveOutBut_JButton_Text&quot;));</span>

  /** The buffer saving object for saving output. */
<span class="nc" id="L243">  SaveBuffer m_SaveOut = new SaveBuffer(null, this);</span>

  /** Displays the output of tests. */
<span class="nc" id="L246">  protected JTextArea m_OutText = new JTextArea();</span>

  /** A panel controlling results viewing. */
<span class="nc" id="L249">  protected ResultHistoryPanel m_History = new ResultHistoryPanel(m_OutText);</span>
  
  /** The file chooser for selecting result files. */
<span class="nc" id="L252">  protected JFileChooser m_FileChooser = new JFileChooser(new File(System.getProperty(&quot;user.dir&quot;)));</span>
 
  // File filters for various file types.
  /** CSV file filter. */
<span class="nc" id="L256">  protected ExtensionFileFilter m_csvFileFilter = </span>
<span class="nc" id="L257">    new ExtensionFileFilter(CSVLoader.FILE_EXTENSION, Messages.getInstance().getString(&quot;ResultsPanel_CsvFileFilter_ExtensionFileFilter_Text&quot;));</span>

  /** ARFF file filter. */
<span class="nc" id="L260">  protected ExtensionFileFilter m_arffFileFilter = </span>
<span class="nc" id="L261">    new ExtensionFileFilter(Instances.FILE_EXTENSION, Messages.getInstance().getString(&quot;ResultsPanel_ArffFileFilter_ExtensionFileFilter_Text&quot;));</span>

  /** The PairedTTester object. */
<span class="nc" id="L264">  protected Tester m_TTester = new PairedCorrectedTTester();</span>
  
  /** The instances we're extracting results from. */
  protected Instances m_Instances;

  /** Does any database querying for us. */
  protected InstanceQuery m_InstanceQuery;

  /** A thread to load results instances from a file or database. */
  protected Thread m_LoadThread;
  
  /** An experiment (used for identifying a result source) -- optional. */
  protected Experiment m_Exp;

  /** the size for a combobox. */
<span class="nc" id="L279">  private Dimension COMBO_SIZE = new Dimension(150, m_ResultKeyBut.getPreferredSize().height);</span>

  /** the initial result matrix. */
<span class="nc" id="L282">  protected ResultMatrix m_ResultMatrix = new ResultMatrixPlainText();</span>
  
  /**
   * Creates the results panel with no initial experiment.
   */
<span class="nc" id="L287">  public ResultsPanel() {</span>

    // defaults
<span class="nc" id="L290">    m_TTester.setSignificanceLevel(ExperimenterDefaults.getSignificance());</span>
<span class="nc" id="L291">    m_TTester.setShowStdDevs(ExperimenterDefaults.getShowStdDevs());</span>
    try {
<span class="nc" id="L293">      m_ResultMatrix = (ResultMatrix) Class.forName(</span>
<span class="nc" id="L294">          ExperimenterDefaults.getOutputFormat()).newInstance();</span>
    }
<span class="nc" id="L296">    catch (Exception e) {</span>
<span class="nc" id="L297">      m_ResultMatrix = new ResultMatrixPlainText();</span>
    }
<span class="nc" id="L299">    m_ResultMatrix.setShowStdDev(ExperimenterDefaults.getShowStdDevs());</span>
<span class="nc" id="L300">    m_ResultMatrix.setMeanPrec(ExperimenterDefaults.getMeanPrecision());</span>
<span class="nc" id="L301">    m_ResultMatrix.setStdDevPrec(ExperimenterDefaults.getStdDevPrecision());</span>
<span class="nc" id="L302">    m_ResultMatrix.setRemoveFilterName(ExperimenterDefaults.getRemoveFilterClassnames());</span>
<span class="nc" id="L303">    m_ResultMatrix.setShowAverage(ExperimenterDefaults.getShowAverage());</span>

    // Create/Configure/Connect components
    
<span class="nc" id="L307">    m_FileChooser.</span>
<span class="nc" id="L308">      addChoosableFileFilter(m_csvFileFilter);</span>
<span class="nc" id="L309">    m_FileChooser.</span>
<span class="nc" id="L310">      addChoosableFileFilter(m_arffFileFilter);</span>

<span class="nc" id="L312">    m_FileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);</span>
<span class="nc" id="L313">    m_FromExpBut.setEnabled(false);</span>
<span class="nc" id="L314">    m_FromExpBut.setMnemonic('E');</span>
<span class="nc" id="L315">    m_FromExpBut.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L317" title="All 2 branches missed.">	if (m_LoadThread == null) {</span>
<span class="nc" id="L318">	  m_LoadThread = new Thread() {</span>
	    public void run() {
<span class="nc" id="L320">	      setInstancesFromExp(m_Exp);</span>
<span class="nc" id="L321">	      m_LoadThread = null;</span>
<span class="nc" id="L322">	    }</span>
	  };
<span class="nc" id="L324">	  m_LoadThread.start();</span>
	}
<span class="nc" id="L326">      }</span>
    });
<span class="nc" id="L328">    m_FromDBaseBut.setMnemonic('D');</span>
<span class="nc" id="L329">    m_FromDBaseBut.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L331" title="All 2 branches missed.">	if (m_LoadThread == null) {</span>
<span class="nc" id="L332">	  m_LoadThread = new Thread() {</span>
	    public void run() {
<span class="nc" id="L334">	      setInstancesFromDBaseQuery();</span>
<span class="nc" id="L335">	    m_LoadThread = null;</span>
<span class="nc" id="L336">	    }</span>
	  };
<span class="nc" id="L338">	  m_LoadThread.start();</span>
	}
<span class="nc" id="L340">      }</span>
    });
<span class="nc" id="L342">    m_FromFileBut.setMnemonic('F');</span>
<span class="nc" id="L343">    m_FromFileBut.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L345">	int returnVal = m_FileChooser.showOpenDialog(ResultsPanel.this);</span>
<span class="nc bnc" id="L346" title="All 2 branches missed.">	if (returnVal == JFileChooser.APPROVE_OPTION) {</span>
<span class="nc" id="L347">	  final File selected = m_FileChooser.getSelectedFile();</span>
<span class="nc bnc" id="L348" title="All 2 branches missed.">	  if (m_LoadThread == null) {</span>
<span class="nc" id="L349">	    m_LoadThread = new Thread() {</span>
	      public void run() {
<span class="nc" id="L351">		setInstancesFromFile(selected);</span>
<span class="nc" id="L352">		m_LoadThread = null;</span>
<span class="nc" id="L353">	      }</span>
	    };
<span class="nc" id="L355">	    m_LoadThread.start();</span>
	  }
	}
<span class="nc" id="L358">      }</span>
    });
<span class="nc" id="L360">    setComboSizes();</span>
<span class="nc" id="L361">    m_TesterClasses.setEnabled(false);</span>
<span class="nc" id="L362">    m_DatasetKeyBut.setEnabled(false);</span>
<span class="nc" id="L363">    m_DatasetKeyBut.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L365">	setDatasetKeyFromDialog();</span>
<span class="nc" id="L366">      }</span>
    });
<span class="nc" id="L368">    m_DatasetKeyList.setSelectionMode(ListSelectionModel</span>
				      .MULTIPLE_INTERVAL_SELECTION);
<span class="nc" id="L370">    m_ResultKeyBut.setEnabled(false);</span>
<span class="nc" id="L371">    m_ResultKeyBut.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L373">	setResultKeyFromDialog();</span>
<span class="nc" id="L374">      }</span>
    });
<span class="nc" id="L376">    m_ResultKeyList.setSelectionMode(ListSelectionModel</span>
				     .MULTIPLE_INTERVAL_SELECTION);
<span class="nc" id="L378">    m_CompareCombo.setEnabled(false);</span>
<span class="nc" id="L379">    m_SortCombo.setEnabled(false);</span>

<span class="nc" id="L381">    m_SigTex.setEnabled(false);</span>
<span class="nc" id="L382">    m_TestsButton.setEnabled(false);</span>
<span class="nc" id="L383">    m_TestsButton.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L385">	  setTestBaseFromDialog();</span>
<span class="nc" id="L386">	}</span>
      });

<span class="nc" id="L389">    m_DisplayedButton.setEnabled(false);</span>
<span class="nc" id="L390">    m_DisplayedButton.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L392">        setDisplayedFromDialog();</span>
<span class="nc" id="L393">      }</span>
      });

<span class="nc" id="L396">    m_ShowStdDevs.setEnabled(false);</span>
<span class="nc" id="L397">    m_ShowStdDevs.setSelected(ExperimenterDefaults.getShowStdDevs());</span>
<span class="nc" id="L398">    m_OutputFormatButton.setEnabled(false);</span>
<span class="nc" id="L399">    m_OutputFormatButton.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L401">        setOutputFormatFromDialog();</span>
<span class="nc" id="L402">      }</span>
      });
    
<span class="nc" id="L405">    m_PerformBut.setEnabled(false);</span>
<span class="nc" id="L406">    m_PerformBut.addActionListener(new ActionListener() {</span>
      public void actionPerformed(ActionEvent e) {
<span class="nc" id="L408">	performTest();</span>
<span class="nc" id="L409">	m_SaveOutBut.setEnabled(true);</span>
<span class="nc" id="L410">      }</span>
    });

<span class="nc" id="L413">    m_PerformBut.setToolTipText(m_TTester.getToolTipText());</span>

<span class="nc" id="L415">    m_SaveOutBut.setEnabled(false);</span>
<span class="nc" id="L416">    m_SaveOutBut.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L418">	  saveBuffer();</span>
<span class="nc" id="L419">	}</span>
      });
<span class="nc" id="L421">    m_OutText.setFont(new Font(&quot;Monospaced&quot;, Font.PLAIN, 12));</span>
<span class="nc" id="L422">    m_OutText.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));</span>
<span class="nc" id="L423">    m_OutText.setEditable(false);</span>
<span class="nc" id="L424">    m_History.setBorder(BorderFactory.createTitledBorder(Messages.getInstance().getString(&quot;ResultsPanel_OutText_SetBorder_BorderFactoryCreateTitledBorder_Text&quot;)));</span>


    // Set up the GUI layout
<span class="nc" id="L428">    JPanel p1 = new JPanel();</span>
<span class="nc" id="L429">    p1.setBorder(BorderFactory.createTitledBorder(Messages.getInstance().getString(&quot;ResultsPanel_OutText_SetBorder_BorderFactoryCreateTitledBorder_Text_First&quot;)));</span>
<span class="nc" id="L430">    JPanel p2 = new JPanel();</span>
<span class="nc" id="L431">    GridBagLayout gb = new GridBagLayout();</span>
<span class="nc" id="L432">    GridBagConstraints constraints = new GridBagConstraints();</span>
<span class="nc" id="L433">    p2.setBorder(BorderFactory.createEmptyBorder(5, 5, 10, 5));</span>
    //    p2.setLayout(new GridLayout(1, 3));
<span class="nc" id="L435">    p2.setLayout(gb);</span>
<span class="nc" id="L436">    constraints.gridx=0;constraints.gridy=0;constraints.weightx=5;</span>
<span class="nc" id="L437">    constraints.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L438">    constraints.gridwidth=1;constraints.gridheight=1;</span>
<span class="nc" id="L439">    constraints.insets = new Insets(0,2,0,2);</span>
<span class="nc" id="L440">    p2.add(m_FromFileBut,constraints);</span>
<span class="nc" id="L441">    constraints.gridx=1;constraints.gridy=0;constraints.weightx=5;</span>
<span class="nc" id="L442">    constraints.gridwidth=1;constraints.gridheight=1;</span>
<span class="nc" id="L443">    p2.add(m_FromDBaseBut,constraints);</span>
<span class="nc" id="L444">    constraints.gridx=2;constraints.gridy=0;constraints.weightx=5;</span>
<span class="nc" id="L445">    constraints.gridwidth=1;constraints.gridheight=1;</span>
<span class="nc" id="L446">    p2.add(m_FromExpBut,constraints);</span>
<span class="nc" id="L447">    p1.setLayout(new BorderLayout());</span>
<span class="nc" id="L448">    p1.add(m_FromLab, BorderLayout.CENTER);</span>
<span class="nc" id="L449">    p1.add(p2, BorderLayout.EAST);</span>

<span class="nc" id="L451">    JPanel p3 = new JPanel();</span>
<span class="nc" id="L452">    p3.setBorder(BorderFactory.createTitledBorder(Messages.getInstance().getString(&quot;ResultsPanel_P3_SetBorder_BorderFactoryCreateTitledBorder_Text&quot;)));</span>
<span class="nc" id="L453">    GridBagLayout gbL = new GridBagLayout();</span>
<span class="nc" id="L454">    p3.setLayout(gbL);</span>

<span class="nc" id="L456">    int y = 0;</span>
<span class="nc" id="L457">    GridBagConstraints gbC = new GridBagConstraints();</span>
<span class="nc" id="L458">    gbC.anchor = GridBagConstraints.EAST;</span>
<span class="nc" id="L459">    gbC.gridy = y;     gbC.gridx = 0;</span>
<span class="nc" id="L460">    gbC.insets = new Insets(2, 10, 2, 10);</span>
<span class="nc" id="L461">    gbL.setConstraints(m_TesterClassesLabel,gbC);</span>
<span class="nc" id="L462">    m_TesterClassesLabel.setDisplayedMnemonic('w');</span>
<span class="nc" id="L463">    m_TesterClassesLabel.setLabelFor(m_TesterClasses);</span>
<span class="nc" id="L464">    p3.add(m_TesterClassesLabel);</span>
<span class="nc" id="L465">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L466">    gbC.gridy = y;     gbC.gridx = 1;  gbC.weightx = 100;</span>
<span class="nc" id="L467">    gbC.insets = new Insets(5,0,5,0);</span>
<span class="nc" id="L468">    gbC.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L469">    gbL.setConstraints(m_TesterClasses, gbC);</span>
<span class="nc" id="L470">    p3.add(m_TesterClasses);</span>
<span class="nc" id="L471">    m_TesterClasses.addActionListener(new ActionListener() {</span>
	public void actionPerformed(ActionEvent e) {
<span class="nc" id="L473">	  setTester();</span>
<span class="nc" id="L474">	}</span>
      });
<span class="nc" id="L476">    setSelectedItem(m_TesterClasses, ExperimenterDefaults.getTester());</span>
    
<span class="nc" id="L478">    y++;</span>
<span class="nc" id="L479">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L480">    gbC.anchor = GridBagConstraints.EAST;</span>
<span class="nc" id="L481">    gbC.gridy = y;     gbC.gridx = 0;</span>
<span class="nc" id="L482">    gbC.insets = new Insets(2, 10, 2, 10);</span>
<span class="nc" id="L483">    gbL.setConstraints(m_DatasetKeyLabel,gbC);</span>
<span class="nc" id="L484">    m_DatasetKeyLabel.setDisplayedMnemonic('R');</span>
<span class="nc" id="L485">    m_DatasetKeyLabel.setLabelFor(m_DatasetKeyBut);</span>
<span class="nc" id="L486">    p3.add(m_DatasetKeyLabel);</span>
<span class="nc" id="L487">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L488">    gbC.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L489">    gbC.gridy = y;     gbC.gridx = 1;  gbC.weightx = 100;</span>
<span class="nc" id="L490">    gbC.insets = new Insets(5,0,5,0);</span>
<span class="nc" id="L491">    gbL.setConstraints(m_DatasetKeyBut, gbC);</span>
<span class="nc" id="L492">    p3.add(m_DatasetKeyBut);</span>
    
<span class="nc" id="L494">    y++;</span>
<span class="nc" id="L495">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L496">    gbC.anchor = GridBagConstraints.EAST;</span>
<span class="nc" id="L497">    gbC.gridy = y;     gbC.gridx = 0;</span>
<span class="nc" id="L498">    gbC.insets = new Insets(2, 10, 2, 10);</span>
<span class="nc" id="L499">    gbL.setConstraints(m_ResultKeyLabel, gbC);</span>
<span class="nc" id="L500">    m_ResultKeyLabel.setDisplayedMnemonic('C');</span>
<span class="nc" id="L501">    m_ResultKeyLabel.setLabelFor(m_ResultKeyBut);</span>
<span class="nc" id="L502">    p3.add(m_ResultKeyLabel);</span>
<span class="nc" id="L503">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L504">    gbC.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L505">    gbC.gridy = y;     gbC.gridx = 1;  gbC.weightx = 100;</span>
<span class="nc" id="L506">    gbC.insets = new Insets(5,0,5,0);</span>
<span class="nc" id="L507">    gbL.setConstraints(m_ResultKeyBut, gbC);</span>
<span class="nc" id="L508">    p3.add(m_ResultKeyBut);</span>
    
<span class="nc" id="L510">    y++;</span>
<span class="nc" id="L511">    JLabel lab = new JLabel(Messages.getInstance().getString(&quot;ResultsPanel_Lab_JLabel_Text_First&quot;), SwingConstants.RIGHT);</span>
<span class="nc" id="L512">    lab.setDisplayedMnemonic('m');</span>
<span class="nc" id="L513">    lab.setLabelFor(m_CompareCombo);</span>
<span class="nc" id="L514">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L515">    gbC.anchor = GridBagConstraints.EAST;</span>
<span class="nc" id="L516">    gbC.gridy = y;     gbC.gridx = 0;</span>
<span class="nc" id="L517">    gbC.insets = new Insets(2, 10, 2, 10);</span>
<span class="nc" id="L518">    gbL.setConstraints(lab, gbC);</span>
<span class="nc" id="L519">    p3.add(lab);</span>
<span class="nc" id="L520">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L521">    gbC.gridy = y;     gbC.gridx = 1;  gbC.weightx = 100;</span>
<span class="nc" id="L522">    gbC.insets = new Insets(5,0,5,0);</span>
<span class="nc" id="L523">    gbC.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L524">    gbL.setConstraints(m_CompareCombo, gbC);</span>
<span class="nc" id="L525">    p3.add(m_CompareCombo);</span>
    
<span class="nc" id="L527">    y++;</span>
<span class="nc" id="L528">    lab = new JLabel(Messages.getInstance().getString(&quot;ResultsPanel_Lab_JLabel_Text_Second&quot;), SwingConstants.RIGHT);</span>
<span class="nc" id="L529">    lab.setDisplayedMnemonic('g');</span>
<span class="nc" id="L530">    lab.setLabelFor(m_SigTex);</span>
<span class="nc" id="L531">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L532">    gbC.anchor = GridBagConstraints.EAST;</span>
<span class="nc" id="L533">    gbC.gridy = y;     gbC.gridx = 0;</span>
<span class="nc" id="L534">    gbC.insets = new Insets(2, 10, 2, 10);</span>
<span class="nc" id="L535">    gbL.setConstraints(lab, gbC);</span>
<span class="nc" id="L536">    p3.add(lab);</span>
<span class="nc" id="L537">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L538">    gbC.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L539">    gbC.gridy = y;     gbC.gridx = 1;  gbC.weightx = 100;</span>
<span class="nc" id="L540">    gbL.setConstraints(m_SigTex, gbC);</span>
<span class="nc" id="L541">    p3.add(m_SigTex);</span>
    
<span class="nc" id="L543">    y++;</span>
<span class="nc" id="L544">    lab = new JLabel(Messages.getInstance().getString(&quot;ResultsPanel_Lab_JLabel_Text_Third&quot;), SwingConstants.RIGHT);</span>
<span class="nc" id="L545">    lab.setDisplayedMnemonic('S');</span>
<span class="nc" id="L546">    lab.setLabelFor(m_SortCombo);</span>
<span class="nc" id="L547">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L548">    gbC.anchor = GridBagConstraints.EAST;</span>
<span class="nc" id="L549">    gbC.gridy = y;     gbC.gridx = 0;</span>
<span class="nc" id="L550">    gbC.insets = new Insets(2, 10, 2, 10);</span>
<span class="nc" id="L551">    gbL.setConstraints(lab, gbC);</span>
<span class="nc" id="L552">    p3.add(lab);</span>
<span class="nc" id="L553">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L554">    gbC.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L555">    gbC.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L556">    gbC.gridy = y;     gbC.gridx = 1;  gbC.weightx = 100;</span>
<span class="nc" id="L557">    gbC.insets = new Insets(5,0,5,0);</span>
<span class="nc" id="L558">    gbL.setConstraints(m_SortCombo, gbC);</span>
<span class="nc" id="L559">    p3.add(m_SortCombo);</span>
    
<span class="nc" id="L561">    y++;</span>
<span class="nc" id="L562">    lab = new JLabel(Messages.getInstance().getString(&quot;ResultsPanel_Lab_JLabel_Text_Fourth&quot;), SwingConstants.RIGHT);</span>
<span class="nc" id="L563">    lab.setDisplayedMnemonic('b');</span>
<span class="nc" id="L564">    lab.setLabelFor(m_TestsButton);</span>
<span class="nc" id="L565">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L566">    gbC.anchor = GridBagConstraints.EAST;</span>
<span class="nc" id="L567">    gbC.gridy = y;     gbC.gridx = 0;</span>
<span class="nc" id="L568">    gbC.insets = new Insets(2, 10, 2, 10);</span>
<span class="nc" id="L569">    gbL.setConstraints(lab, gbC);</span>
<span class="nc" id="L570">    p3.add(lab);</span>
<span class="nc" id="L571">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L572">    gbC.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L573">    gbC.gridy = y;     gbC.gridx = 1;  gbC.weightx = 100;</span>
<span class="nc" id="L574">    gbC.insets = new Insets(5,0,5,0);</span>
<span class="nc" id="L575">    gbL.setConstraints(m_TestsButton, gbC);</span>
<span class="nc" id="L576">    p3.add(m_TestsButton);</span>

<span class="nc" id="L578">    y++;</span>
<span class="nc" id="L579">    lab = new JLabel(Messages.getInstance().getString(&quot;ResultsPanel_Lab_JLabel_Text_Fifth&quot;), SwingConstants.RIGHT);</span>
<span class="nc" id="L580">    lab.setDisplayedMnemonic('i');</span>
<span class="nc" id="L581">    lab.setLabelFor(m_DisplayedButton);</span>
<span class="nc" id="L582">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L583">    gbC.anchor = GridBagConstraints.EAST;</span>
<span class="nc" id="L584">    gbC.gridy = y;     gbC.gridx = 0;</span>
<span class="nc" id="L585">    gbC.insets = new Insets(2, 10, 2, 10);</span>
<span class="nc" id="L586">    gbL.setConstraints(lab, gbC);</span>
<span class="nc" id="L587">    p3.add(lab);</span>
<span class="nc" id="L588">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L589">    gbC.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L590">    gbC.gridy = y;     gbC.gridx = 1;  gbC.weightx = 100;</span>
<span class="nc" id="L591">    gbC.insets = new Insets(5,0,5,0);</span>
<span class="nc" id="L592">    gbL.setConstraints(m_DisplayedButton, gbC);</span>
<span class="nc" id="L593">    p3.add(m_DisplayedButton);</span>

<span class="nc" id="L595">    y++;</span>
<span class="nc" id="L596">    lab = new JLabel(Messages.getInstance().getString(&quot;ResultsPanel_Lab_JLabel_Text_Sixth&quot;), SwingConstants.RIGHT);</span>
<span class="nc" id="L597">    lab.setDisplayedMnemonic('a');</span>
<span class="nc" id="L598">    lab.setLabelFor(m_ShowStdDevs);</span>
<span class="nc" id="L599">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L600">    gbC.anchor = GridBagConstraints.EAST;</span>
<span class="nc" id="L601">    gbC.gridy = y;     gbC.gridx = 0;</span>
<span class="nc" id="L602">    gbC.insets = new Insets(2, 10, 2, 10);</span>
<span class="nc" id="L603">    gbL.setConstraints(lab, gbC);</span>
<span class="nc" id="L604">    p3.add(lab);</span>
<span class="nc" id="L605">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L606">    gbC.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L607">    gbC.gridy = y;     gbC.gridx = 1;  gbC.weightx = 100;</span>
<span class="nc" id="L608">    gbC.insets = new Insets(5,0,5,0);</span>
<span class="nc" id="L609">    gbL.setConstraints(m_ShowStdDevs, gbC);</span>
<span class="nc" id="L610">    p3.add(m_ShowStdDevs);</span>

<span class="nc" id="L612">    y++;</span>
<span class="nc" id="L613">    lab = new JLabel(Messages.getInstance().getString(&quot;ResultsPanel_Lab_JLabel_Text_Seventh&quot;), SwingConstants.RIGHT);</span>
<span class="nc" id="L614">    lab.setDisplayedMnemonic('O');</span>
<span class="nc" id="L615">    lab.setLabelFor(m_OutputFormatButton);</span>
<span class="nc" id="L616">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L617">    gbC.anchor = GridBagConstraints.EAST;</span>
<span class="nc" id="L618">    gbC.gridy = y;     gbC.gridx = 0;</span>
<span class="nc" id="L619">    gbC.insets = new Insets(2, 10, 2, 10);</span>
<span class="nc" id="L620">    gbL.setConstraints(lab, gbC);</span>
<span class="nc" id="L621">    p3.add(lab);</span>
<span class="nc" id="L622">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L623">    gbC.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L624">    gbC.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L625">    gbC.gridy = y;     gbC.gridx = 1;  gbC.weightx = 100;</span>
<span class="nc" id="L626">    gbC.insets = new Insets(5,0,5,0);</span>
<span class="nc" id="L627">    gbL.setConstraints(m_OutputFormatButton, gbC);</span>
<span class="nc" id="L628">    p3.add(m_OutputFormatButton);</span>
    
<span class="nc" id="L630">    JPanel output = new JPanel();</span>
<span class="nc" id="L631">    output.setLayout(new BorderLayout());</span>
<span class="nc" id="L632">    output.setBorder(BorderFactory.createTitledBorder(Messages.getInstance().getString(&quot;ResultsPanel_Output_SetBorder_BorderFactoryCreateTitledBorder_Text&quot;)));</span>
<span class="nc" id="L633">    output.add(new JScrollPane(m_OutText), BorderLayout.CENTER);</span>

<span class="nc" id="L635">    JPanel mondo = new JPanel();</span>
<span class="nc" id="L636">    gbL = new GridBagLayout();</span>
<span class="nc" id="L637">    mondo.setLayout(gbL);</span>
<span class="nc" id="L638">    gbC = new GridBagConstraints();</span>
    //    gbC.anchor = GridBagConstraints.WEST;
    //    gbC.fill = GridBagConstraints.HORIZONTAL;
<span class="nc" id="L641">    gbC.gridy = 0;     gbC.gridx = 0;</span>
<span class="nc" id="L642">    gbL.setConstraints(p3, gbC);</span>
<span class="nc" id="L643">    mondo.add(p3);</span>

<span class="nc" id="L645">    JPanel bts = new JPanel();</span>
<span class="nc" id="L646">    m_PerformBut.setMnemonic('t');</span>
<span class="nc" id="L647">    m_SaveOutBut.setMnemonic('S');</span>
<span class="nc" id="L648">    bts.setLayout(new GridLayout(1,2,5,5));</span>
<span class="nc" id="L649">    bts.add(m_PerformBut);</span>
<span class="nc" id="L650">    bts.add(m_SaveOutBut);</span>

<span class="nc" id="L652">    gbC = new GridBagConstraints();</span>
<span class="nc" id="L653">    gbC.anchor = GridBagConstraints.NORTH;</span>
<span class="nc" id="L654">    gbC.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L655">    gbC.gridy = 1;     gbC.gridx = 0;</span>
<span class="nc" id="L656">    gbC.insets = new Insets(5,5,5,5);</span>
<span class="nc" id="L657">    gbL.setConstraints(bts, gbC);</span>
<span class="nc" id="L658">    mondo.add(bts);</span>
<span class="nc" id="L659">    gbC = new GridBagConstraints();</span>
    //gbC.anchor = GridBagConstraints.NORTH;
<span class="nc" id="L661">    gbC.fill = GridBagConstraints.BOTH;</span>
<span class="nc" id="L662">    gbC.gridy = 2;     gbC.gridx = 0; gbC.weightx = 0;</span>
<span class="nc" id="L663">    gbC.weighty = 100;</span>
<span class="nc" id="L664">    gbL.setConstraints(m_History, gbC);</span>
<span class="nc" id="L665">    mondo.add(m_History);</span>
    /*gbC = new GridBagConstraints();
    gbC.fill = GridBagConstraints.BOTH;
    gbC.gridy = 0;     gbC.gridx = 1;
    gbC.gridheight = 3;
    gbC.weightx = 100; gbC.weighty = 100;
    gbL.setConstraints(output, gbC);*/
    //mondo.add(output);
<span class="nc" id="L673">    JSplitPane splitPane = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT,</span>
<span class="nc" id="L674">					  mondo, output);</span>
<span class="nc" id="L675">    splitPane.setOneTouchExpandable(true);</span>
    //splitPane.setDividerLocation(100);

<span class="nc" id="L678">    setLayout(new BorderLayout());</span>
<span class="nc" id="L679">    add(p1, BorderLayout.NORTH);</span>
    //add(mondo , BorderLayout.CENTER);
<span class="nc" id="L681">    add(splitPane , BorderLayout.CENTER);</span>
<span class="nc" id="L682">  }</span>

  /**
   * Sets the combo-boxes to a fixed size so they don't take up too much room
   * that would be better devoted to the test output box.
   */
  protected void setComboSizes() {
    
<span class="nc" id="L690">    m_TesterClasses.setPreferredSize(COMBO_SIZE);</span>
<span class="nc" id="L691">    m_DatasetKeyBut.setPreferredSize(COMBO_SIZE);</span>
<span class="nc" id="L692">    m_ResultKeyBut.setPreferredSize(COMBO_SIZE);</span>
<span class="nc" id="L693">    m_CompareCombo.setPreferredSize(COMBO_SIZE);</span>
<span class="nc" id="L694">    m_SigTex.setPreferredSize(COMBO_SIZE);</span>
<span class="nc" id="L695">    m_SortCombo.setPreferredSize(COMBO_SIZE);</span>

<span class="nc" id="L697">    m_TesterClasses.setMaximumSize(COMBO_SIZE);</span>
<span class="nc" id="L698">    m_DatasetKeyBut.setMaximumSize(COMBO_SIZE);</span>
<span class="nc" id="L699">    m_ResultKeyBut.setMaximumSize(COMBO_SIZE);</span>
<span class="nc" id="L700">    m_CompareCombo.setMaximumSize(COMBO_SIZE);</span>
<span class="nc" id="L701">    m_SigTex.setMaximumSize(COMBO_SIZE);</span>
<span class="nc" id="L702">    m_SortCombo.setMaximumSize(COMBO_SIZE);</span>

<span class="nc" id="L704">    m_TesterClasses.setMinimumSize(COMBO_SIZE);</span>
<span class="nc" id="L705">    m_DatasetKeyBut.setMinimumSize(COMBO_SIZE);</span>
<span class="nc" id="L706">    m_ResultKeyBut.setMinimumSize(COMBO_SIZE);</span>
<span class="nc" id="L707">    m_CompareCombo.setMinimumSize(COMBO_SIZE);</span>
<span class="nc" id="L708">    m_SigTex.setMinimumSize(COMBO_SIZE);</span>
<span class="nc" id="L709">    m_SortCombo.setMinimumSize(COMBO_SIZE);</span>
<span class="nc" id="L710">  }</span>
  
  /**
   * Tells the panel to use a new experiment.
   *
   * @param exp a value of type 'Experiment'
   */
  public void setExperiment(Experiment exp) {
    
<span class="nc" id="L719">    m_Exp = exp;</span>
<span class="nc bnc" id="L720" title="All 2 branches missed.">    m_FromExpBut.setEnabled(exp != null);</span>
<span class="nc" id="L721">  }</span>

  /**
   * Queries the user enough to make a database query to retrieve experiment
   * results.
   */
  protected void setInstancesFromDBaseQuery() {

    try {
<span class="nc bnc" id="L730" title="All 2 branches missed.">      if (m_InstanceQuery == null) {</span>
<span class="nc" id="L731">	m_InstanceQuery = new InstanceQuery();</span>
      }
<span class="nc" id="L733">      String dbaseURL = m_InstanceQuery.getDatabaseURL();</span>
<span class="nc" id="L734">      String username = m_InstanceQuery.getUsername();</span>
<span class="nc" id="L735">      String passwd = m_InstanceQuery.getPassword();</span>
      /*dbaseURL = (String) JOptionPane.showInputDialog(this,
					     &quot;Enter the database URL&quot;,
					     &quot;Query Database&quot;,
					     JOptionPane.PLAIN_MESSAGE,
					     null,
					     null,
					     dbaseURL);*/
     
      
      
<span class="nc" id="L746">      DatabaseConnectionDialog dbd= new DatabaseConnectionDialog(null,dbaseURL,username);</span>
<span class="nc" id="L747">      dbd.setVisible(true);</span>
      
      //if (dbaseURL == null) {
<span class="nc bnc" id="L750" title="All 2 branches missed.">      if (dbd.getReturnValue()==JOptionPane.CLOSED_OPTION) {</span>
<span class="nc" id="L751">	m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromDBaseQuery_FromLab_Text_First&quot;));</span>
<span class="nc" id="L752">	return;</span>
      }
<span class="nc" id="L754">      dbaseURL=dbd.getURL();</span>
<span class="nc" id="L755">      username=dbd.getUsername();</span>
<span class="nc" id="L756">      passwd=dbd.getPassword();</span>
<span class="nc" id="L757">      m_InstanceQuery.setDatabaseURL(dbaseURL);</span>
<span class="nc" id="L758">      m_InstanceQuery.setUsername(username);</span>
<span class="nc" id="L759">      m_InstanceQuery.setPassword(passwd);</span>
<span class="nc" id="L760">      m_InstanceQuery.setDebug(dbd.getDebug());</span>
      
<span class="nc" id="L762">      m_InstanceQuery.connectToDatabase();</span>
<span class="nc bnc" id="L763" title="All 2 branches missed.">      if (!m_InstanceQuery.experimentIndexExists()) {</span>
<span class="nc" id="L764">	System.err.println(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromDBaseQuery_Error_Text_First&quot;));</span>
<span class="nc" id="L765">	m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromDBaseQuery_FromLab_Text_Second&quot;));</span>
<span class="nc" id="L766">        m_InstanceQuery.disconnectFromDatabase();</span>
<span class="nc" id="L767">	return;</span>
      }
<span class="nc" id="L769">      System.err.println(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromDBaseQuery_Error_Text_Second&quot;));</span>
<span class="nc" id="L770">      m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromDBaseQuery_FromLab_Text_Fourth&quot;));</span>
<span class="nc" id="L771">      Instances index = m_InstanceQuery.retrieveInstances(&quot;SELECT * FROM &quot;</span>
				       + InstanceQuery.EXP_INDEX_TABLE);
<span class="nc bnc" id="L773" title="All 2 branches missed.">      if (index.numInstances() == 0) {</span>
<span class="nc" id="L774">	m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromDBaseQuery_FromLab_Text_Fifth&quot;));</span>
<span class="nc" id="L775">        m_InstanceQuery.disconnectFromDatabase();</span>
<span class="nc" id="L776">	return;	</span>
      }
<span class="nc" id="L778">      m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromDBaseQuery_FromLab_Text_Sixth&quot;));</span>

<span class="nc" id="L780">      DefaultListModel lm = new DefaultListModel();</span>
<span class="nc bnc" id="L781" title="All 2 branches missed.">      for (int i = 0; i &lt; index.numInstances(); i++) {</span>
<span class="nc" id="L782">	lm.addElement(index.instance(i).toString());</span>
      }
<span class="nc" id="L784">      JList jl = new JList(lm);</span>
<span class="nc" id="L785">      jl.setSelectedIndex(0);</span>
      int result;
      // display dialog only if there's not just one result!
<span class="nc bnc" id="L788" title="All 2 branches missed.">      if (jl.getModel().getSize() != 1) {</span>
<span class="nc" id="L789">        ListSelectorDialog jd = new ListSelectorDialog(null, jl);</span>
<span class="nc" id="L790">        result = jd.showDialog();</span>
      }
      else {
<span class="nc" id="L793">        result = ListSelectorDialog.APPROVE_OPTION;</span>
      }
<span class="nc bnc" id="L795" title="All 2 branches missed.">      if (result != ListSelectorDialog.APPROVE_OPTION) {</span>
<span class="nc" id="L796">	m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromDBaseQuery_FromLab_Text_Sixth&quot;));</span>
<span class="nc" id="L797">        m_InstanceQuery.disconnectFromDatabase();</span>
<span class="nc" id="L798">	return;</span>
      }
<span class="nc" id="L800">      Instance selInst = index.instance(jl.getSelectedIndex());</span>
<span class="nc" id="L801">      Attribute tableAttr = index.attribute(InstanceQuery.EXP_RESULT_COL);</span>
<span class="nc" id="L802">      String table = InstanceQuery.EXP_RESULT_PREFIX</span>
<span class="nc" id="L803">	+ selInst.toString(tableAttr);</span>
<span class="nc" id="L804">      setInstancesFromDatabaseTable(table);</span>
      
<span class="nc" id="L806">    } catch (Exception ex) {</span>
       // 1. print complete stacktrace
<span class="nc" id="L808">       ex.printStackTrace();</span>
       // 2. print message in panel
<span class="nc" id="L810">       m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromDBaseQuery_FromLab_Text_Seventh_First&quot;) + ex.getMessage() + Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromDBaseQuery_FromLab_Text_Seventh_Second&quot;));</span>
    }
<span class="nc" id="L812">  }</span>
  
  /**
   * Examines the supplied experiment to determine the results destination
   * and attempts to load the results.
   *
   * @param exp a value of type 'Experiment'
   */
  protected void setInstancesFromExp(Experiment exp) {

<span class="nc bnc" id="L822" title="All 2 branches missed.">    if ((exp.getResultListener() instanceof CSVResultListener)) { </span>
<span class="nc" id="L823">      File resultFile = ((CSVResultListener) exp.getResultListener())</span>
<span class="nc" id="L824">	.getOutputFile();</span>
<span class="nc bnc" id="L825" title="All 2 branches missed.">      if ((resultFile == null)) {</span>
<span class="nc" id="L826">	m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromExp_FromLab_Text_First&quot;));</span>
      } else {
<span class="nc" id="L828">	setInstancesFromFile(resultFile);</span>
      }
<span class="nc bnc" id="L830" title="All 2 branches missed.">    } else if (exp.getResultListener() instanceof DatabaseResultListener) {</span>
<span class="nc" id="L831">      String dbaseURL = ((DatabaseResultListener) exp.getResultListener())</span>
<span class="nc" id="L832">	.getDatabaseURL();</span>
      try {
<span class="nc bnc" id="L834" title="All 2 branches missed.">	if (m_InstanceQuery == null) {</span>
<span class="nc" id="L835">	  m_InstanceQuery = new InstanceQuery();</span>
	}
<span class="nc" id="L837">	m_InstanceQuery.setDatabaseURL(dbaseURL);</span>
<span class="nc" id="L838">	m_InstanceQuery.connectToDatabase();</span>
<span class="nc" id="L839">	String tableName = m_InstanceQuery</span>
<span class="nc" id="L840">	  .getResultsTableName(exp.getResultProducer());</span>
<span class="nc" id="L841">	setInstancesFromDatabaseTable(tableName);</span>
<span class="nc" id="L842">      } catch (Exception ex) {</span>
<span class="nc" id="L843">	m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromExp_FromLab_Text_Second&quot;));</span>
      }
    } else {
<span class="nc" id="L846">      m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromExp_FromLab_Text_Third&quot;));</span>
    }
<span class="nc" id="L848">  }</span>

  
  /**
   * Queries a database to load results from the specified table name. The
   * database connection must have already made by m_InstanceQuery.
   *
   * @param tableName the name of the table containing results to retrieve.
   */
  protected void setInstancesFromDatabaseTable(String tableName) {

    try {
<span class="nc" id="L860">      m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromDatabaseTable_FromLab_Text&quot;));</span>
<span class="nc" id="L861">      final Instances i = m_InstanceQuery.retrieveInstances(&quot;SELECT * FROM &quot;</span>
<span class="nc" id="L862">						      + tableName);</span>
<span class="nc" id="L863">      SwingUtilities.invokeAndWait(new Runnable() {</span>
	public void run() {
<span class="nc" id="L865">	  setInstances(i);</span>
<span class="nc" id="L866">	}</span>
      });
<span class="nc" id="L868">      m_InstanceQuery.disconnectFromDatabase();</span>
<span class="nc" id="L869">    } catch (Exception ex) {</span>
<span class="nc" id="L870">      m_FromLab.setText(ex.getMessage());</span>
    }
<span class="nc" id="L872">  }</span>
  
  /**
   * Loads results from a set of instances contained in the supplied
   * file.
   *
   * @param f a value of type 'File'
   */
  protected void setInstancesFromFile(File f) {

<span class="nc" id="L882">    String fileType = f.getName();</span>
    try {
<span class="nc" id="L884">      m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromFile_FromLab_Text&quot;));</span>
<span class="nc bnc" id="L885" title="All 2 branches missed.">      if (f.getName().toLowerCase().endsWith(Instances.FILE_EXTENSION)) {	    </span>
<span class="nc" id="L886">	fileType = &quot;arff&quot;;</span>
<span class="nc" id="L887">	Reader r = new BufferedReader(new FileReader(f));</span>
<span class="nc" id="L888">	setInstances(new Instances(r));</span>
<span class="nc" id="L889">	r.close();</span>
<span class="nc bnc" id="L890" title="All 2 branches missed.">      } else if (f.getName().toLowerCase().endsWith(CSVLoader.FILE_EXTENSION)) {</span>
<span class="nc" id="L891">	fileType = &quot;csv&quot;;</span>
<span class="nc" id="L892">	CSVLoader cnv = new CSVLoader();</span>
<span class="nc" id="L893">	cnv.setSource(f);</span>
<span class="nc" id="L894">	Instances inst = cnv.getDataSet();</span>
<span class="nc" id="L895">	setInstances(inst);</span>
      } else {
<span class="nc" id="L897">	throw new Exception(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromFile_Error_Text&quot;));</span>
      }
<span class="nc" id="L899">    } catch (Exception ex) {</span>
<span class="nc" id="L900">      m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromFile_Error_FromLab_Text_First&quot;) + f.getName() + Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromFile_Error_FromLab_Text_Second&quot;)</span>
<span class="nc" id="L901">			  +fileType + Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromFile_Error_FromLab_Text_Third&quot;));</span>
<span class="nc" id="L902">      if (JOptionPane.showOptionDialog(ResultsPanel.this,</span>
<span class="nc" id="L903">    		  Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromFile_Error_JOptionPaneShowOptionDialog_Text_First&quot;) + f.getName()</span>
<span class="nc" id="L904">				       + Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromFile_Error_JOptionPaneShowOptionDialog_Text_Second&quot;)</span>
<span class="nc" id="L905">				       +fileType + Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromFile_Error_JOptionPaneShowOptionDialog_Text_Third&quot;)</span>
<span class="nc" id="L906">				       + Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromFile_Error_JOptionPaneShowOptionDialog_Text_Fourth&quot;) + ex.getMessage(),</span>
<span class="nc" id="L907">				       Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromFile_Error_JOptionPaneShowOptionDialog_Text_Fifth&quot;),</span>
<span class="nc" id="L908">				       0,</span>
<span class="nc" id="L909">				       JOptionPane.ERROR_MESSAGE,</span>
<span class="nc" id="L910">				       null,</span>
<span class="nc" id="L911">				       new String[] {Messages.getInstance().getString(&quot;ResultsPanel_SetInstancesFromFile_Error_JOptionPaneShowOptionDialog_Text_Sixth&quot;)},</span>
<span class="nc" id="L912">				       null) == 1) {</span>
	
      }
    }  
<span class="nc" id="L916">  }</span>
  
  /**
   * Returns a vector with column names of the dataset, listed in &quot;list&quot;. If
   * a column cannot be found or the list is empty the ones from the default 
   * list are returned. 
   * 
   * @param list           comma-separated list of attribute names
   * @param defaultList    the default list of attribute names
   * @param inst           the instances to get the attribute names from
   * @return               a vector containing attribute names
   */
  protected Vector determineColumnNames(String list, String defaultList, Instances inst) {
    Vector              result;
    Vector              atts;
    StringTokenizer     tok;
    int                 i;
    String              item;
    
    // get attribute names
<span class="nc" id="L936">    atts = new Vector();</span>
<span class="nc bnc" id="L937" title="All 2 branches missed.">    for (i = 0; i &lt; inst.numAttributes(); i++)</span>
<span class="nc" id="L938">      atts.add(inst.attribute(i).name().toLowerCase());</span>

    // process list
<span class="nc" id="L941">    result = new Vector();</span>
<span class="nc" id="L942">    tok = new StringTokenizer(list, &quot;,&quot;);</span>
<span class="nc bnc" id="L943" title="All 2 branches missed.">    while (tok.hasMoreTokens()) {</span>
<span class="nc" id="L944">      item = tok.nextToken().toLowerCase();</span>
<span class="nc bnc" id="L945" title="All 2 branches missed.">      if (atts.contains(item)) {</span>
<span class="nc" id="L946">        result.add(item);</span>
      }
      else {
<span class="nc" id="L949">        result.clear();</span>
<span class="nc" id="L950">        break;</span>
      }
    }
    
    // do we have to return defaults?
<span class="nc bnc" id="L955" title="All 2 branches missed.">    if (result.size() == 0) {</span>
<span class="nc" id="L956">      tok = new StringTokenizer(defaultList, &quot;,&quot;);</span>
<span class="nc bnc" id="L957" title="All 2 branches missed.">      while (tok.hasMoreTokens())</span>
<span class="nc" id="L958">        result.add(tok.nextToken().toLowerCase());</span>
    }
    
<span class="nc" id="L961">    return result;</span>
  }

  /**
   * Sets up the panel with a new set of instances, attempting
   * to guess the correct settings for various columns.
   *
   * @param newInstances the new set of results.
   */
  public void setInstances(Instances newInstances) {

<span class="nc" id="L972">    m_Instances = newInstances;</span>
<span class="nc" id="L973">    m_TTester.setInstances(m_Instances);</span>
<span class="nc" id="L974">    m_FromLab.setText(Messages.getInstance().getString(&quot;ResultsPanel_SetInstances_FromLab_Text_First&quot;) + m_Instances.numInstances() + Messages.getInstance().getString(&quot;ResultsPanel_SetInstances_FromLab_Text_Second&quot;));</span>
    
    // setup row and column names
<span class="nc" id="L977">    Vector rows = determineColumnNames(</span>
<span class="nc" id="L978">        ExperimenterDefaults.getRow(), &quot;Key_Dataset&quot;, m_Instances);</span>
<span class="nc" id="L979">    Vector cols = determineColumnNames(</span>
<span class="nc" id="L980">        ExperimenterDefaults.getColumn(), &quot;Key_Scheme,Key_Scheme_options,Key_Scheme_version_ID&quot;, m_Instances);</span>
    
    // Do other stuff
<span class="nc" id="L983">    m_DatasetKeyModel.removeAllElements();</span>
<span class="nc" id="L984">    m_ResultKeyModel.removeAllElements();</span>
<span class="nc" id="L985">    m_CompareModel.removeAllElements();</span>
<span class="nc" id="L986">    m_SortModel.removeAllElements();</span>
<span class="nc" id="L987">    m_SortModel.addElement(&quot;&lt;default&gt;&quot;);</span>
<span class="nc" id="L988">    m_TTester.setSortColumn(-1);</span>
<span class="nc" id="L989">    String selectedList = &quot;&quot;;</span>
<span class="nc" id="L990">    String selectedListDataset = &quot;&quot;;</span>
<span class="nc" id="L991">    boolean comparisonFieldSet = false; </span>
<span class="nc bnc" id="L992" title="All 2 branches missed.">    for (int i = 0; i &lt; m_Instances.numAttributes(); i++) {</span>
<span class="nc" id="L993">      String name = m_Instances.attribute(i).name();</span>
<span class="nc bnc" id="L994" title="All 2 branches missed.">      if (name.toLowerCase().startsWith(&quot;key_&quot;, 0)) {</span>
<span class="nc" id="L995">	m_DatasetKeyModel.addElement(name.substring(4));</span>
<span class="nc" id="L996">	m_ResultKeyModel.addElement(name.substring(4));</span>
<span class="nc" id="L997">	m_CompareModel.addElement(name.substring(4));</span>
      } else {
<span class="nc" id="L999">	m_DatasetKeyModel.addElement(name);</span>
<span class="nc" id="L1000">	m_ResultKeyModel.addElement(name);</span>
<span class="nc" id="L1001">	m_CompareModel.addElement(name);</span>
<span class="nc bnc" id="L1002" title="All 2 branches missed.">        if (m_Instances.attribute(i).isNumeric())</span>
<span class="nc" id="L1003">	  m_SortModel.addElement(name);</span>
      }

<span class="nc bnc" id="L1006" title="All 2 branches missed.">      if (rows.contains(name.toLowerCase())) {</span>
<span class="nc" id="L1007">	m_DatasetKeyList.addSelectionInterval(i, i);</span>
<span class="nc" id="L1008">	selectedListDataset += &quot;,&quot; + (i + 1);</span>
<span class="nc bnc" id="L1009" title="All 2 branches missed.">      } else if (name.toLowerCase().equals(&quot;key_run&quot;)) {</span>
<span class="nc" id="L1010">	m_TTester.setRunColumn(i);</span>
<span class="nc bnc" id="L1011" title="All 2 branches missed.">      } else if (name.toLowerCase().equals(&quot;key_fold&quot;)) {</span>
<span class="nc" id="L1012">	m_TTester.setFoldColumn(i);</span>
<span class="nc bnc" id="L1013" title="All 2 branches missed.">      } else if (cols.contains(name.toLowerCase())) {</span>
<span class="nc" id="L1014">	m_ResultKeyList.addSelectionInterval(i, i);</span>
<span class="nc" id="L1015">	selectedList += &quot;,&quot; + (i + 1);</span>
<span class="nc bnc" id="L1016" title="All 2 branches missed.">      } else if (name.toLowerCase().indexOf(ExperimenterDefaults.getComparisonField()) != -1) {</span>
<span class="nc" id="L1017">	m_CompareCombo.setSelectedIndex(i);</span>
<span class="nc" id="L1018">	comparisonFieldSet = true;</span>
	//	break;
<span class="nc bnc" id="L1020" title="All 2 branches missed.">      } else if ((name.toLowerCase().indexOf(&quot;root_relative_squared_error&quot;) != -1) &amp;&amp;</span>
<span class="nc bnc" id="L1021" title="All 2 branches missed.">          (!comparisonFieldSet)) {</span>
<span class="nc" id="L1022">	m_CompareCombo.setSelectedIndex(i);</span>
<span class="nc" id="L1023">	comparisonFieldSet = true;</span>
      }
    }
<span class="nc" id="L1026">    m_TesterClasses.setEnabled(true);</span>
<span class="nc" id="L1027">    m_DatasetKeyBut.setEnabled(true);</span>
<span class="nc" id="L1028">    m_ResultKeyBut.setEnabled(true);</span>
<span class="nc" id="L1029">    m_CompareCombo.setEnabled(true);</span>
<span class="nc" id="L1030">    m_SortCombo.setEnabled(true);</span>
<span class="nc bnc" id="L1031" title="All 2 branches missed.">    if (ExperimenterDefaults.getSorting().length() != 0)</span>
<span class="nc" id="L1032">      setSelectedItem(m_SortCombo, ExperimenterDefaults.getSorting());</span>

<span class="nc" id="L1034">    Range generatorRange = new Range();</span>
<span class="nc bnc" id="L1035" title="All 2 branches missed.">    if (selectedList.length() != 0) {</span>
      try {
<span class="nc" id="L1037">	generatorRange.setRanges(selectedList);</span>
<span class="nc" id="L1038">      } catch (Exception ex) {</span>
<span class="nc" id="L1039">	ex.printStackTrace();</span>
<span class="nc" id="L1040">	System.err.println(ex.getMessage());</span>
      }
    }
<span class="nc" id="L1043">    m_TTester.setResultsetKeyColumns(generatorRange);</span>

<span class="nc" id="L1045">    generatorRange = new Range();</span>
<span class="nc bnc" id="L1046" title="All 2 branches missed.">    if (selectedListDataset.length() != 0) {</span>
      try {
<span class="nc" id="L1048">	generatorRange.setRanges(selectedListDataset);</span>
<span class="nc" id="L1049">      } catch (Exception ex) {</span>
<span class="nc" id="L1050">	ex.printStackTrace();</span>
<span class="nc" id="L1051">	System.err.println(ex.getMessage());</span>
      }
    }
<span class="nc" id="L1054">    m_TTester.setDatasetKeyColumns(generatorRange);</span>

<span class="nc" id="L1056">    m_SigTex.setEnabled(true);</span>

<span class="nc" id="L1058">    setTTester();</span>
<span class="nc" id="L1059">  }</span>

  /**
   * Sets the selected item of an combobox, since using setSelectedItem(...)
   * doesn't work, if one checks object references!
   *
   * @param cb      the combobox to set the item for
   * @param item    the item to set active
   */
  protected void setSelectedItem(JComboBox cb, String item) {
    int       i;

<span class="nc bnc" id="L1071" title="All 2 branches missed.">    for (i = 0; i &lt; cb.getItemCount(); i++) {</span>
<span class="nc bnc" id="L1072" title="All 2 branches missed.">      if (cb.getItemAt(i).toString().equals(item)) {</span>
<span class="nc" id="L1073">        cb.setSelectedIndex(i);</span>
<span class="nc" id="L1074">        break;</span>
      }
    }
<span class="nc" id="L1077">  }</span>

  /**
   * Updates the test chooser with possible tests.
   */
  protected void setTTester() {
    
    // default is to display all columns
<span class="nc" id="L1085">    m_TTester.setDisplayedResultsets(null);       </span>

<span class="nc" id="L1087">    String name = (new SimpleDateFormat(&quot;HH:mm:ss - &quot;))</span>
<span class="nc" id="L1088">      .format(new Date())</span>
<span class="nc" id="L1089">      + Messages.getInstance().getString(&quot;ResultsPanel_SetTTester_Name_Text&quot;);</span>
<span class="nc" id="L1090">    StringBuffer outBuff = new StringBuffer();</span>
<span class="nc" id="L1091">    outBuff.append(Messages.getInstance().getString(&quot;ResultsPanel_SetTTester_OutBuff_Text_First&quot;)</span>
<span class="nc" id="L1092">		   + m_TTester.resultsetKey() + &quot;\n\n&quot;);</span>
<span class="nc" id="L1093">    m_History.addResult(name, outBuff);</span>
<span class="nc" id="L1094">    m_History.setSingle(name);</span>

<span class="nc" id="L1096">    m_TestsModel.removeAllElements();</span>
<span class="nc bnc" id="L1097" title="All 2 branches missed.">    for (int i = 0; i &lt; m_TTester.getNumResultsets(); i++) {</span>
<span class="nc" id="L1098">      String tname = m_TTester.getResultsetName(i);</span>
      /*      if (tname.length() &gt; 20) {
	tname = tname.substring(0, 20);
	} */
<span class="nc" id="L1102">      m_TestsModel.addElement(tname);</span>
    }
    
<span class="nc" id="L1105">    m_DisplayedModel.removeAllElements();</span>
<span class="nc bnc" id="L1106" title="All 2 branches missed.">    for (int i = 0; i &lt; m_TestsModel.size(); i++)</span>
<span class="nc" id="L1107">      m_DisplayedModel.addElement(m_TestsModel.elementAt(i));</span>
    
<span class="nc" id="L1109">    m_TestsModel.addElement(Messages.getInstance().getString(&quot;ResultsPanel_SetTTester_TestsModel_Element_Text_First&quot;));</span>
<span class="nc" id="L1110">    m_TestsModel.addElement(Messages.getInstance().getString(&quot;ResultsPanel_SetTTester_TestsModel_Element_Text_Second&quot;));</span>

<span class="nc" id="L1112">    m_TestsList.setSelectedIndex(0);</span>
<span class="nc" id="L1113">    m_DisplayedList.setSelectionInterval(0, m_DisplayedModel.size() - 1);</span>
    
<span class="nc" id="L1115">    m_TestsButton.setEnabled(true);</span>
<span class="nc" id="L1116">    m_DisplayedButton.setEnabled(true);</span>
<span class="nc" id="L1117">    m_ShowStdDevs.setEnabled(true);</span>
<span class="nc" id="L1118">    m_OutputFormatButton.setEnabled(true);</span>
<span class="nc" id="L1119">    m_PerformBut.setEnabled(true);</span>
    
<span class="nc" id="L1121">  }</span>

  
  /**
   * Carries out a t-test using the current configuration.
   */
  protected void performTest() {

<span class="nc" id="L1129">    String sigStr = m_SigTex.getText();</span>
<span class="nc bnc" id="L1130" title="All 2 branches missed.">    if (sigStr.length() != 0) {</span>
<span class="nc" id="L1131">      m_TTester.setSignificanceLevel((new Double(sigStr)).doubleValue());</span>
    } else {
<span class="nc" id="L1133">      m_TTester.setSignificanceLevel(ExperimenterDefaults.getSignificance());</span>
    }

    // Carry out the test chosen and biff the results to the output area
<span class="nc" id="L1137">    m_TTester.setShowStdDevs(m_ShowStdDevs.isSelected());</span>
<span class="nc bnc" id="L1138" title="All 2 branches missed.">    if (m_Instances.attribute(m_SortCombo.getSelectedItem().toString()) != null)</span>
<span class="nc" id="L1139">      m_TTester.setSortColumn(</span>
<span class="nc" id="L1140">          m_Instances.attribute(</span>
<span class="nc" id="L1141">            m_SortCombo.getSelectedItem().toString()).index());</span>
    else
<span class="nc" id="L1143">      m_TTester.setSortColumn(-1);</span>
<span class="nc" id="L1144">    int compareCol = m_CompareCombo.getSelectedIndex();</span>
<span class="nc" id="L1145">    int tType = m_TestsList.getSelectedIndex();</span>

<span class="nc" id="L1147">    String name = (new SimpleDateFormat(&quot;HH:mm:ss - &quot;))</span>
<span class="nc" id="L1148">      .format(new Date())</span>
<span class="nc" id="L1149">      + (String) m_CompareCombo.getSelectedItem() + &quot; - &quot;</span>
<span class="nc" id="L1150">      + (String) m_TestsList.getSelectedValue();</span>
<span class="nc" id="L1151">    StringBuffer outBuff = new StringBuffer();</span>
<span class="nc" id="L1152">    outBuff.append(m_TTester.header(compareCol));</span>
<span class="nc" id="L1153">    outBuff.append(&quot;\n&quot;);</span>
<span class="nc" id="L1154">    m_History.addResult(name, outBuff);</span>
<span class="nc" id="L1155">    m_History.setSingle(name);</span>
<span class="nc" id="L1156">    m_TTester.setDisplayedResultsets(m_DisplayedList.getSelectedIndices());</span>
<span class="nc" id="L1157">    m_TTester.setResultMatrix(m_ResultMatrix);</span>
    try {
<span class="nc bnc" id="L1159" title="All 2 branches missed.">      if (tType &lt; m_TTester.getNumResultsets()) {</span>
<span class="nc" id="L1160">	outBuff.append(m_TTester.multiResultsetFull(tType, compareCol));</span>
<span class="nc bnc" id="L1161" title="All 2 branches missed.">      } else if (tType == m_TTester.getNumResultsets()) {</span>
<span class="nc" id="L1162">	outBuff.append(m_TTester.multiResultsetSummary(compareCol));</span>
      } else {
<span class="nc" id="L1164">	outBuff.append(m_TTester.multiResultsetRanking(compareCol));</span>
      }
<span class="nc" id="L1166">      outBuff.append(&quot;\n&quot;);</span>
<span class="nc" id="L1167">    } catch (Exception ex) {</span>
<span class="nc" id="L1168">      outBuff.append(ex.getMessage() + &quot;\n&quot;);</span>
    }
<span class="nc" id="L1170">    m_History.updateResult(name);</span>
<span class="nc" id="L1171">  }</span>

  
  public void setResultKeyFromDialog() {

<span class="nc" id="L1176">    ListSelectorDialog jd = new ListSelectorDialog(null, m_ResultKeyList);</span>

    // Open the dialog
<span class="nc" id="L1179">    int result = jd.showDialog();</span>
  
    // If accepted, update the ttester
<span class="nc bnc" id="L1182" title="All 2 branches missed.">    if (result == ListSelectorDialog.APPROVE_OPTION) {</span>
<span class="nc" id="L1183">      int [] selected = m_ResultKeyList.getSelectedIndices();</span>
<span class="nc" id="L1184">      String selectedList = &quot;&quot;;</span>
<span class="nc bnc" id="L1185" title="All 2 branches missed.">      for (int i = 0; i &lt; selected.length; i++) {</span>
<span class="nc" id="L1186">	selectedList += &quot;,&quot; + (selected[i] + 1);</span>
      }
<span class="nc" id="L1188">      Range generatorRange = new Range();</span>
<span class="nc bnc" id="L1189" title="All 2 branches missed.">      if (selectedList.length() != 0) {</span>
	try {
<span class="nc" id="L1191">	  generatorRange.setRanges(selectedList);</span>
<span class="nc" id="L1192">	} catch (Exception ex) {</span>
<span class="nc" id="L1193">	  ex.printStackTrace();</span>
<span class="nc" id="L1194">	  System.err.println(ex.getMessage());</span>
	}
      }
<span class="nc" id="L1197">      m_TTester.setResultsetKeyColumns(generatorRange);</span>
<span class="nc" id="L1198">      setTTester();</span>
    }
<span class="nc" id="L1200">  }</span>
  
  public void setDatasetKeyFromDialog() {

<span class="nc" id="L1204">    ListSelectorDialog jd = new ListSelectorDialog(null, m_DatasetKeyList);</span>

    // Open the dialog
<span class="nc" id="L1207">    int result = jd.showDialog();</span>
    
    // If accepted, update the ttester
<span class="nc bnc" id="L1210" title="All 2 branches missed.">    if (result == ListSelectorDialog.APPROVE_OPTION) {</span>
<span class="nc" id="L1211">      int [] selected = m_DatasetKeyList.getSelectedIndices();</span>
<span class="nc" id="L1212">      String selectedList = &quot;&quot;;</span>
<span class="nc bnc" id="L1213" title="All 2 branches missed.">      for (int i = 0; i &lt; selected.length; i++) {</span>
<span class="nc" id="L1214">	selectedList += &quot;,&quot; + (selected[i] + 1);</span>
      }
<span class="nc" id="L1216">      Range generatorRange = new Range();</span>
<span class="nc bnc" id="L1217" title="All 2 branches missed.">      if (selectedList.length() != 0) {</span>
	try {
<span class="nc" id="L1219">	  generatorRange.setRanges(selectedList);</span>
<span class="nc" id="L1220">	} catch (Exception ex) {</span>
<span class="nc" id="L1221">	  ex.printStackTrace();</span>
<span class="nc" id="L1222">	  System.err.println(ex.getMessage());</span>
	}
      }
<span class="nc" id="L1225">      m_TTester.setDatasetKeyColumns(generatorRange);</span>
<span class="nc" id="L1226">      setTTester();</span>
    }
<span class="nc" id="L1228">  }</span>

  public void setTestBaseFromDialog() {
<span class="nc" id="L1231">    ListSelectorDialog jd = new ListSelectorDialog(null, m_TestsList);</span>

    // Open the dialog
<span class="nc" id="L1234">    jd.showDialog();</span>
<span class="nc" id="L1235">  }</span>

  public void setDisplayedFromDialog() {
<span class="nc" id="L1238">    ListSelectorDialog jd = new ListSelectorDialog(null, m_DisplayedList);</span>

    // Open the dialog
<span class="nc" id="L1241">    jd.showDialog();</span>
<span class="nc" id="L1242">  }</span>
  
  /**
   * displays the Dialog for the output format and sets the chosen settings, 
   * if the user approves.
   */
  public void setOutputFormatFromDialog() {
<span class="nc" id="L1249">    OutputFormatDialog dialog = new OutputFormatDialog(null);</span>
    
<span class="nc" id="L1251">    dialog.setResultMatrix(m_ResultMatrix.getClass());</span>
<span class="nc" id="L1252">    dialog.setMeanPrec(m_ResultMatrix.getMeanPrec());</span>
<span class="nc" id="L1253">    dialog.setStdDevPrec(m_ResultMatrix.getStdDevPrec());</span>
<span class="nc" id="L1254">    dialog.setRemoveFilterName(m_ResultMatrix.getRemoveFilterName());</span>
<span class="nc" id="L1255">    dialog.setShowAverage(m_ResultMatrix.getShowAverage());</span>
    
<span class="nc bnc" id="L1257" title="All 2 branches missed.">    if (dialog.showDialog() == OutputFormatDialog.APPROVE_OPTION) {</span>
      try {
<span class="nc" id="L1259">        m_ResultMatrix = (ResultMatrix) dialog.getResultMatrix().newInstance();</span>
      }
<span class="nc" id="L1261">      catch (Exception e) {</span>
<span class="nc" id="L1262">        e.printStackTrace();</span>
<span class="nc" id="L1263">        m_ResultMatrix = new ResultMatrixPlainText();</span>
      }
<span class="nc" id="L1265">      m_ResultMatrix.setMeanPrec(dialog.getMeanPrec());</span>
<span class="nc" id="L1266">      m_ResultMatrix.setStdDevPrec(dialog.getStdDevPrec());</span>
<span class="nc" id="L1267">      m_ResultMatrix.setRemoveFilterName(dialog.getRemoveFilterName());</span>
<span class="nc" id="L1268">      m_ResultMatrix.setShowAverage(dialog.getShowAverage());</span>
    }
<span class="nc" id="L1270">  }</span>

  /**
   * Save the currently selected result buffer to a file.
   */
  protected void saveBuffer() {
<span class="nc" id="L1276">    StringBuffer sb = m_History.getSelectedBuffer();</span>
<span class="nc bnc" id="L1277" title="All 2 branches missed.">    if (sb != null) {</span>
<span class="nc bnc" id="L1278" title="All 2 branches missed.">      if (m_SaveOut.save(sb)) {</span>
<span class="nc" id="L1279">	JOptionPane.showMessageDialog(this,</span>
<span class="nc" id="L1280">			Messages.getInstance().getString(&quot;ResultsPanel_SetTTester_SaveBuffer_JOptionPaneShowMessageDialog_Text_First&quot;),</span>
<span class="nc" id="L1281">			Messages.getInstance().getString(&quot;ResultsPanel_SetTTester_SaveBuffer_JOptionPaneShowMessageDialog_Text_Second&quot;),</span>
<span class="nc" id="L1282">				      JOptionPane.INFORMATION_MESSAGE);</span>
      }
    } else {
<span class="nc" id="L1285">      m_SaveOutBut.setEnabled(false);</span>
    }
<span class="nc" id="L1287">  }</span>

  /**
   * sets the currently selected Tester-Class.
   */
  protected void setTester() {
    Tester        tester;
    Tester        t;
    int           i;
    
<span class="nc bnc" id="L1297" title="All 2 branches missed.">    if (m_TesterClasses.getSelectedItem() == null)</span>
<span class="nc" id="L1298">      return;</span>

<span class="nc" id="L1300">    tester = null;</span>
    
    // find display name
    try {
<span class="nc bnc" id="L1304" title="All 2 branches missed.">      for (i = 0; i &lt; m_Testers.size(); i++) {</span>
<span class="nc" id="L1305">        t = (Tester) ((Class) m_Testers.get(i)).newInstance();</span>
<span class="nc bnc" id="L1306" title="All 2 branches missed.">        if (t.getDisplayName().equals(m_TesterClasses.getSelectedItem())) {</span>
<span class="nc" id="L1307">          tester = t;</span>
<span class="nc" id="L1308">          break;</span>
        }
      }
    }
<span class="nc" id="L1312">    catch (Exception e) {</span>
<span class="nc" id="L1313">      e.printStackTrace();</span>
    }

<span class="nc bnc" id="L1316" title="All 2 branches missed.">    if (tester == null) {</span>
<span class="nc" id="L1317">      tester  = new PairedCorrectedTTester();  // default</span>
<span class="nc" id="L1318">      m_TesterClasses.setSelectedItem(tester.getDisplayName());</span>
    }

<span class="nc" id="L1321">    tester.assign(m_TTester);</span>
<span class="nc" id="L1322">    m_TTester = tester;</span>
<span class="nc" id="L1323">    m_PerformBut.setToolTipText(m_TTester.getToolTipText());</span>
<span class="nc" id="L1324">    System.out.println(Messages.getInstance().getString(&quot;ResultsPanel_SetTTester_SetTester_Text&quot;) + m_TTester.getClass().getName());</span>
<span class="nc" id="L1325">  }</span>
  
  /**
   * Tests out the results panel from the command line.
   *
   * @param args ignored
   */
  public static void main(String [] args) {

    try {
<span class="nc" id="L1335">      final JFrame jf = new JFrame(Messages.getInstance().getString(&quot;ResultsPanel_SetTTester_Main_JFrame_Text&quot;));</span>
<span class="nc" id="L1336">      jf.getContentPane().setLayout(new BorderLayout());</span>
<span class="nc" id="L1337">      final ResultsPanel sp = new ResultsPanel();</span>
      //sp.setBorder(BorderFactory.createTitledBorder(&quot;Setup&quot;));
<span class="nc" id="L1339">      jf.getContentPane().add(sp, BorderLayout.CENTER);</span>
<span class="nc" id="L1340">      jf.addWindowListener(new WindowAdapter() {</span>
	public void windowClosing(WindowEvent e) {
<span class="nc" id="L1342">	  jf.dispose();</span>
<span class="nc" id="L1343">	  System.exit(0);</span>
<span class="nc" id="L1344">	}</span>
      });
<span class="nc" id="L1346">      jf.pack();</span>
<span class="nc" id="L1347">      jf.setSize(700, 550);</span>
<span class="nc" id="L1348">      jf.setVisible(true);</span>
<span class="nc" id="L1349">    } catch (Exception ex) {</span>
<span class="nc" id="L1350">      ex.printStackTrace();</span>
<span class="nc" id="L1351">      System.err.println(ex.getMessage());</span>
    }
<span class="nc" id="L1353">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span>AllTests (Nov 28, 2015 2:34:31 PM)</div></body></html>
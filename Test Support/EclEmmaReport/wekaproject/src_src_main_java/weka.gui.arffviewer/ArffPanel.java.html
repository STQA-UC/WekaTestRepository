<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>ArffPanel.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">AllTests (Nov 28, 2015 2:34:31 PM)</a> &gt; <a href="../../index.html" class="el_group">wekaproject</a> &gt; <a href="../index.html" class="el_bundle">src/src/main/java</a> &gt; <a href="index.source.html" class="el_package">weka.gui.arffviewer</a> &gt; <span class="el_source">ArffPanel.java</span></div><h1>ArffPanel.java</h1><pre class="source lang-java linenums">/*
 *    This program is free software; you can redistribute it and/or modify
 *    it under the terms of the GNU General Public License as published by
 *    the Free Software Foundation; either version 2 of the License, or
 *    (at your option) any later version.
 *
 *    This program is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *    GNU General Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License
 *    along with this program; if not, write to the Free Software
 *    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 */

/*
 * ArffPanel.java
 * Copyright (C) 2005 University of Waikato, Hamilton, New Zealand
 *
 */

package weka.gui.arffviewer;

import weka.core.Instances;
import weka.core.Undoable;
import weka.core.Utils;
import weka.gui.ComponentHelper;
import weka.gui.JTableHelper;
import weka.gui.ListSelectorDialog;

import java.awt.BorderLayout;
import java.awt.Cursor;
import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.StringSelection;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.io.File;
import java.util.Collections;
import java.util.HashSet;
import java.util.Iterator;
import java.util.Vector;

import javax.swing.JLabel;
import javax.swing.JList;
import javax.swing.JMenuItem;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JPopupMenu;
import javax.swing.JScrollPane;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;
import javax.swing.event.TableModelEvent;

/**
 * A Panel representing an ARFF-Table and the associated filename.
 *
 *
 * @author FracPete (fracpete at waikato dot ac dot nz)
 * @version $Revision: 7369 $ 
 */

<span class="nc" id="L66">public class ArffPanel </span>
  extends JPanel
  implements ActionListener, ChangeListener, MouseListener, Undoable {
  
  /** for serialization */
  static final long serialVersionUID = -4697041150989513939L;
  
  /** the name of the tab for instances that were set directly */
<span class="nc" id="L74">  public final static String TAB_INSTANCES = Messages.getInstance().getString(&quot;ArffPanel_TabInstanses_Text&quot;);</span>

  /** the underlying table */
  private ArffTable m_TableArff;
  /** the popup menu for the header row */
  private JPopupMenu m_PopupHeader;
  /** the popup menu for the data rows */
  private JPopupMenu m_PopupRows;
  /** displays the relation name */
  private JLabel m_LabelName;
  
  // menu items
  private JMenuItem             menuItemMean;
  private JMenuItem             menuItemSetAllValues;
  private JMenuItem             menuItemSetMissingValues;
  private JMenuItem             menuItemReplaceValues;
  private JMenuItem             menuItemRenameAttribute;
  private JMenuItem             menuItemAttributeAsClass;
  private JMenuItem             menuItemDeleteAttribute;
  private JMenuItem             menuItemDeleteAttributes;
  private JMenuItem             menuItemSortInstances;
  private JMenuItem             menuItemDeleteSelectedInstance;
  private JMenuItem             menuItemDeleteAllSelectedInstances;
  private JMenuItem             menuItemSearch;
  private JMenuItem             menuItemClearSearch;
  private JMenuItem             menuItemUndo;
  private JMenuItem             menuItemCopy;
  private JMenuItem             menuItemOptimalColWidth;
  private JMenuItem             menuItemOptimalColWidths;
  
  /** the filename used in the title */
  private String m_Filename;
  /** the title prefix */
  private String m_Title;
  /** the currently selected column */
  private int m_CurrentCol;
  /** flag for whether data got changed */
  private boolean m_Changed;
  /** the listeners that listen for modifications */
  private HashSet m_ChangeListeners;
  /** the string used in the last search */
  private String m_LastSearch;
  /** the string used in the last replace */
  private String m_LastReplace;
  
  /**
   * initializes the panel with no data
   */
  public ArffPanel() {
<span class="nc" id="L123">    super();</span>
    
<span class="nc" id="L125">    initialize();</span>
<span class="nc" id="L126">    createPanel();</span>
<span class="nc" id="L127">  }</span>
  
  /**
   * initializes the panel and loads the specified file
   * 
   * @param filename	the file to load
   */
  public ArffPanel(String filename) {
<span class="nc" id="L135">    this();</span>
    
<span class="nc" id="L137">    loadFile(filename);</span>
<span class="nc" id="L138">  }</span>
  
  /**
   * initializes the panel with the given data
   * 
   * @param data	the data to use
   */
  public ArffPanel(Instances data) {
<span class="nc" id="L146">    this();</span>
    
<span class="nc" id="L148">    m_Filename = &quot;&quot;;</span>
    
<span class="nc" id="L150">    setInstances(data);</span>
<span class="nc" id="L151">  }</span>
  
  /**
   * any member variables are initialized here
   */
  protected void initialize() {
<span class="nc" id="L157">    m_Filename        = &quot;&quot;;</span>
<span class="nc" id="L158">    m_Title           = &quot;&quot;;</span>
<span class="nc" id="L159">    m_CurrentCol      = -1;</span>
<span class="nc" id="L160">    m_LastSearch      = &quot;&quot;;</span>
<span class="nc" id="L161">    m_LastReplace     = &quot;&quot;;</span>
<span class="nc" id="L162">    m_Changed         = false;</span>
<span class="nc" id="L163">    m_ChangeListeners = new HashSet();</span>
<span class="nc" id="L164">  }</span>
  
  /**
   * creates all the components in the frame
   */
  protected void createPanel() {
    JScrollPane                pane;
    
<span class="nc" id="L172">    setLayout(new BorderLayout());</span>
    
<span class="nc" id="L174">    menuItemMean = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_GetMean_JMenuItem_Text&quot;));</span>
<span class="nc" id="L175">    menuItemMean.addActionListener(this);</span>
<span class="nc" id="L176">    menuItemSetAllValues = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_SetAllValuesTo_JMenuItem_Text&quot;));</span>
<span class="nc" id="L177">    menuItemSetAllValues.addActionListener(this);</span>
<span class="nc" id="L178">    menuItemSetMissingValues = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_SetMissingValues_JMenuItem_Text&quot;));</span>
<span class="nc" id="L179">    menuItemSetMissingValues.addActionListener(this);</span>
<span class="nc" id="L180">    menuItemReplaceValues = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_ReplaceValues_JMenuItem_Text&quot;));</span>
<span class="nc" id="L181">    menuItemReplaceValues.addActionListener(this);</span>
<span class="nc" id="L182">    menuItemRenameAttribute = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_RenameAttribute_JMenuItem_Text&quot;));</span>
<span class="nc" id="L183">    menuItemRenameAttribute.addActionListener(this);</span>
<span class="nc" id="L184">    menuItemAttributeAsClass = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_AttributeAsClass_JMenuItem_Text&quot;));</span>
<span class="nc" id="L185">    menuItemAttributeAsClass.addActionListener(this);</span>
<span class="nc" id="L186">    menuItemDeleteAttribute = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_DeleteAttribute_JMenuItem_Text&quot;));</span>
<span class="nc" id="L187">    menuItemDeleteAttribute.addActionListener(this);</span>
<span class="nc" id="L188">    menuItemDeleteAttributes = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_DeleteAttributes_JMenuItem_Text&quot;));</span>
<span class="nc" id="L189">    menuItemDeleteAttributes.addActionListener(this);</span>
<span class="nc" id="L190">    menuItemSortInstances = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_SortInstances_JMenuItem_Text&quot;));</span>
<span class="nc" id="L191">    menuItemSortInstances.addActionListener(this);</span>
<span class="nc" id="L192">    menuItemOptimalColWidth = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_OptimalColWidth_JMenuItem_Text&quot;));</span>
<span class="nc" id="L193">    menuItemOptimalColWidth.addActionListener(this);</span>
<span class="nc" id="L194">    menuItemOptimalColWidths = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_OptimalColWidths_JMenuItem_Text&quot;));</span>
<span class="nc" id="L195">    menuItemOptimalColWidths.addActionListener(this);</span>

    // row popup
<span class="nc" id="L198">    menuItemUndo = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_Undo_JMenuItem_Text&quot;));</span>
<span class="nc" id="L199">    menuItemUndo.addActionListener(this);</span>
<span class="nc" id="L200">    menuItemCopy = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_Copy_JMenuItem_Text&quot;));</span>
<span class="nc" id="L201">    menuItemCopy.addActionListener(this);</span>
<span class="nc" id="L202">    menuItemSearch = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_Search_JMenuItem_Text&quot;));</span>
<span class="nc" id="L203">    menuItemSearch.addActionListener(this);</span>
<span class="nc" id="L204">    menuItemClearSearch = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_ClearSearch_JMenuItem_Text&quot;));</span>
<span class="nc" id="L205">    menuItemClearSearch.addActionListener(this);</span>
<span class="nc" id="L206">    menuItemDeleteSelectedInstance = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_DeleteSelectedInstance_JMenuItem_Text&quot;));</span>
<span class="nc" id="L207">    menuItemDeleteSelectedInstance.addActionListener(this);</span>
<span class="nc" id="L208">    menuItemDeleteAllSelectedInstances = new JMenuItem(Messages.getInstance().getString(&quot;ArffPanel_DeleteAllSelectedInstances_JMenuItem_Text&quot;));</span>
<span class="nc" id="L209">    menuItemDeleteAllSelectedInstances.addActionListener(this);</span>
    
    // table
<span class="nc" id="L212">    m_TableArff = new ArffTable();</span>
<span class="nc" id="L213">    m_TableArff.setToolTipText(Messages.getInstance().getString(&quot;ArffPanel_ToolTipText_Text&quot;));</span>
<span class="nc" id="L214">    m_TableArff.getTableHeader().addMouseListener(this);</span>
<span class="nc" id="L215">    m_TableArff.getTableHeader().setToolTipText(Messages.getInstance().getString(&quot;ArffPanel_TableHeader_ToolTipText_Text&quot;) + &quot;&lt;html&gt;&lt;b&gt;Sort view:&lt;/b&gt; left click = ascending / Shift + left click = descending&lt;br&gt;&lt;b&gt;Menu:&lt;/b&gt; right click (or left+alt)&lt;/html&gt;&quot;);</span>
<span class="nc" id="L216">    m_TableArff.getTableHeader().setDefaultRenderer(new ArffTableCellRenderer());</span>
<span class="nc" id="L217">    m_TableArff.addChangeListener(this);</span>
<span class="nc" id="L218">    m_TableArff.addMouseListener(this);</span>
<span class="nc" id="L219">    pane = new JScrollPane(m_TableArff);</span>
<span class="nc" id="L220">    add(pane, BorderLayout.CENTER);</span>
    
    // relation name
<span class="nc" id="L223">    m_LabelName   = new JLabel();</span>
<span class="nc" id="L224">    add(m_LabelName, BorderLayout.NORTH);</span>
<span class="nc" id="L225">  }</span>

  /**
   * initializes the popup menus
   */
  private void initPopupMenus() {
    // header popup
<span class="nc" id="L232">    m_PopupHeader  = new JPopupMenu();</span>
<span class="nc" id="L233">    m_PopupHeader.addMouseListener(this);</span>
<span class="nc" id="L234">    m_PopupHeader.add(menuItemMean);</span>
<span class="nc bnc" id="L235" title="All 2 branches missed.">    if (!isReadOnly()) {</span>
<span class="nc" id="L236">      m_PopupHeader.addSeparator();</span>
<span class="nc" id="L237">      m_PopupHeader.add(menuItemSetAllValues);</span>
<span class="nc" id="L238">      m_PopupHeader.add(menuItemSetMissingValues);</span>
<span class="nc" id="L239">      m_PopupHeader.add(menuItemReplaceValues);</span>
<span class="nc" id="L240">      m_PopupHeader.addSeparator();</span>
<span class="nc" id="L241">      m_PopupHeader.add(menuItemRenameAttribute);</span>
<span class="nc" id="L242">      m_PopupHeader.add(menuItemAttributeAsClass);</span>
<span class="nc" id="L243">      m_PopupHeader.add(menuItemDeleteAttribute);</span>
<span class="nc" id="L244">      m_PopupHeader.add(menuItemDeleteAttributes);</span>
<span class="nc" id="L245">      m_PopupHeader.add(menuItemSortInstances);</span>
    }
<span class="nc" id="L247">    m_PopupHeader.addSeparator();</span>
<span class="nc" id="L248">    m_PopupHeader.add(menuItemOptimalColWidth);</span>
<span class="nc" id="L249">    m_PopupHeader.add(menuItemOptimalColWidths);</span>
    
    // row popup
<span class="nc" id="L252">    m_PopupRows = new JPopupMenu();</span>
<span class="nc" id="L253">    m_PopupRows.addMouseListener(this);</span>
<span class="nc bnc" id="L254" title="All 2 branches missed.">    if (!isReadOnly()) {</span>
<span class="nc" id="L255">      m_PopupRows.add(menuItemUndo);</span>
<span class="nc" id="L256">      m_PopupRows.addSeparator();</span>
    }
<span class="nc" id="L258">    m_PopupRows.add(menuItemCopy);</span>
<span class="nc" id="L259">    m_PopupRows.addSeparator();</span>
<span class="nc" id="L260">    m_PopupRows.add(menuItemSearch);</span>
<span class="nc" id="L261">    m_PopupRows.add(menuItemClearSearch);</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">    if (!isReadOnly()) {</span>
<span class="nc" id="L263">      m_PopupRows.addSeparator();</span>
<span class="nc" id="L264">      m_PopupRows.add(menuItemDeleteSelectedInstance);</span>
<span class="nc" id="L265">      m_PopupRows.add(menuItemDeleteAllSelectedInstances);</span>
    }
<span class="nc" id="L267">  }</span>
  
  /**
   * sets the enabled/disabled state of the menu items 
   */
  private void setMenu() {
    boolean			isNumeric;
    boolean			hasColumns;
    boolean			hasRows;
    boolean			attSelected;
    ArffSortedTableModel	model;
    boolean			isNull;
    
<span class="nc" id="L280">    model       = (ArffSortedTableModel) m_TableArff.getModel();</span>
<span class="nc bnc" id="L281" title="All 2 branches missed.">    isNull      = (model.getInstances() == null);</span>
<span class="nc bnc" id="L282" title="All 4 branches missed.">    hasColumns  = !isNull &amp;&amp; (model.getInstances().numAttributes() &gt; 0);</span>
<span class="nc bnc" id="L283" title="All 4 branches missed.">    hasRows     = !isNull &amp;&amp; (model.getInstances().numInstances() &gt; 0);</span>
<span class="nc bnc" id="L284" title="All 4 branches missed.">    attSelected = hasColumns &amp;&amp; (m_CurrentCol &gt; 0);</span>
<span class="nc bnc" id="L285" title="All 4 branches missed.">    isNumeric   = attSelected &amp;&amp; (model.getAttributeAt(m_CurrentCol).isNumeric());</span>
    
<span class="nc" id="L287">    menuItemUndo.setEnabled(canUndo());</span>
<span class="nc" id="L288">    menuItemCopy.setEnabled(true);</span>
<span class="nc" id="L289">    menuItemSearch.setEnabled(true);</span>
<span class="nc" id="L290">    menuItemClearSearch.setEnabled(true);</span>
<span class="nc" id="L291">    menuItemMean.setEnabled(isNumeric);</span>
<span class="nc" id="L292">    menuItemSetAllValues.setEnabled(attSelected);</span>
<span class="nc" id="L293">    menuItemSetMissingValues.setEnabled(attSelected);</span>
<span class="nc" id="L294">    menuItemReplaceValues.setEnabled(attSelected);</span>
<span class="nc" id="L295">    menuItemRenameAttribute.setEnabled(attSelected);</span>
<span class="nc" id="L296">    menuItemDeleteAttribute.setEnabled(attSelected);</span>
<span class="nc" id="L297">    menuItemDeleteAttributes.setEnabled(attSelected);</span>
<span class="nc bnc" id="L298" title="All 4 branches missed.">    menuItemSortInstances.setEnabled(hasRows &amp;&amp; attSelected);</span>
<span class="nc bnc" id="L299" title="All 4 branches missed.">    menuItemDeleteSelectedInstance.setEnabled(hasRows &amp;&amp; m_TableArff.getSelectedRow() &gt; -1);</span>
<span class="nc bnc" id="L300" title="All 4 branches missed.">    menuItemDeleteAllSelectedInstances.setEnabled(hasRows &amp;&amp; (m_TableArff.getSelectedRows().length &gt; 0));</span>
<span class="nc" id="L301">  }</span>
  
  /**
   * returns the table component
   * 
   * @return 		the table
   */
  public ArffTable getTable() {
<span class="nc" id="L309">    return m_TableArff;</span>
  }
  
  /**
   * returns the title for the Tab, i.e. the filename
   * 
   * @return 		the title for the tab
   */
  public String getTitle() {
<span class="nc" id="L318">    return m_Title;</span>
  }
  
  /**
   * returns the filename
   * 
   * @return		the filename
   */
  public String getFilename() {
<span class="nc" id="L327">    return m_Filename;</span>
  }
  
  /**
   * sets the filename
   * 
   * @param filename	the new filename
   */
  public void setFilename(String filename) {
<span class="nc" id="L336">    m_Filename = filename;</span>
<span class="nc" id="L337">    createTitle();</span>
<span class="nc" id="L338">  }</span>
  
  /**
   * returns the instances of the panel, if none then NULL
   * 
   * @return		the instances of the panel
   */
  public Instances getInstances() {
    Instances            result;
    
<span class="nc" id="L348">    result = null;</span>
    
<span class="nc bnc" id="L350" title="All 2 branches missed.">    if (m_TableArff.getModel() != null)</span>
<span class="nc" id="L351">      result = ((ArffSortedTableModel) m_TableArff.getModel()).getInstances();</span>
    
<span class="nc" id="L353">    return result;</span>
  }
  
  /**
   * displays the given instances, i.e. creates a tab with the title 
   * TAB_INSTANCES. if one already exists it closes it.&lt;br&gt;
   * if a different instances object is used here, don't forget to clear
   * the undo-history by calling &lt;code&gt;clearUndo()&lt;/code&gt;
   * 
   * @param data	the instances to display
   * @see               #TAB_INSTANCES
   * @see               #clearUndo()
   */
  public void setInstances(Instances data) {
    ArffSortedTableModel         model;
    
<span class="nc" id="L369">    m_Filename = TAB_INSTANCES;</span>
    
<span class="nc" id="L371">    createTitle();</span>
<span class="nc" id="L372">    model = new ArffSortedTableModel(data);</span>
    
<span class="nc" id="L374">    m_TableArff.setModel(model);</span>
<span class="nc" id="L375">    clearUndo();</span>
<span class="nc" id="L376">    setChanged(false);</span>
<span class="nc" id="L377">    createName();</span>
<span class="nc" id="L378">  }</span>
  
  /**
   * returns a list with the attributes
   * 
   * @return		a list of the attributes
   */
  public Vector getAttributes() {
    Vector               result;
    int                  i;
    
<span class="nc" id="L389">    result = new Vector();</span>
<span class="nc bnc" id="L390" title="All 2 branches missed.">    for (i = 0; i &lt; getInstances().numAttributes(); i++)</span>
<span class="nc" id="L391">      result.add(getInstances().attribute(i).name());</span>
<span class="nc" id="L392">    Collections.sort(result);</span>
    
<span class="nc" id="L394">    return result;</span>
  }
  
  /**
   * can only reset the changed state to FALSE
   * 
   * @param changed		if false, resets the changed state
   */
  public void setChanged(boolean changed) {
<span class="nc bnc" id="L403" title="All 2 branches missed.">    if (!changed) {</span>
<span class="nc" id="L404">      this.m_Changed = changed;</span>
<span class="nc" id="L405">      createTitle();</span>
    }
<span class="nc" id="L407">  }</span>
  
  /**
   * returns whether the content of the panel was changed
   * 
   * @return		true if the content was changed
   */
  public boolean isChanged() {
<span class="nc" id="L415">    return m_Changed;</span>
  }

  /**
   * returns whether the model is read-only
   * 
   * @return 		true if model is read-only
   */
  public boolean isReadOnly() {
<span class="nc bnc" id="L424" title="All 2 branches missed.">    if (m_TableArff == null)</span>
<span class="nc" id="L425">      return true;</span>
    else
<span class="nc" id="L427">      return ((ArffSortedTableModel) m_TableArff.getModel()).isReadOnly();</span>
  }
  
  /**
   * sets whether the model is read-only
   * 
   * @param value	if true the model is set to read-only
   */
  public void setReadOnly(boolean value) {
<span class="nc bnc" id="L436" title="All 2 branches missed.">    if (m_TableArff != null)</span>
<span class="nc" id="L437">      ((ArffSortedTableModel) m_TableArff.getModel()).setReadOnly(value);</span>
<span class="nc" id="L438">  }</span>

  /**
   * returns whether undo support is enabled
   * 
   * @return 		true if undo is enabled
   */
  public boolean isUndoEnabled() {
<span class="nc" id="L446">    return ((ArffSortedTableModel) m_TableArff.getModel()).isUndoEnabled();</span>
  }
  
  /**
   * sets whether undo support is enabled
   * 
   * @param enabled		whether to enable/disable undo support
   */
  public void setUndoEnabled(boolean enabled) {
<span class="nc" id="L455">    ((ArffSortedTableModel) m_TableArff.getModel()).setUndoEnabled(enabled);</span>
<span class="nc" id="L456">  }</span>
  
  /**
   * removes the undo history
   */
  public void clearUndo() {
<span class="nc" id="L462">    ((ArffSortedTableModel) m_TableArff.getModel()).clearUndo();</span>
<span class="nc" id="L463">  }</span>
  
  /**
   * returns whether an undo is possible 
   * 
   * @return		true if undo is possible
   */
  public boolean canUndo() {
<span class="nc" id="L471">    return ((ArffSortedTableModel) m_TableArff.getModel()).canUndo();</span>
  }
  
  /**
   * performs an undo action
   */
  public void undo() {
<span class="nc bnc" id="L478" title="All 2 branches missed.">    if (canUndo()) {</span>
<span class="nc" id="L479">      ((ArffSortedTableModel) m_TableArff.getModel()).undo();</span>
      
      // notify about update
<span class="nc" id="L482">      notifyListener();</span>
    }
<span class="nc" id="L484">  }</span>
  
  /**
   * adds the current state of the instances to the undolist 
   */
  public void addUndoPoint() {
<span class="nc" id="L490">    ((ArffSortedTableModel) m_TableArff.getModel()).addUndoPoint();</span>
        
    // update menu
<span class="nc" id="L493">    setMenu();</span>
<span class="nc" id="L494">  }</span>
  
  /**
   * sets the title (i.e. filename)
   */
  private void createTitle() {
    File              file;
    
<span class="nc bnc" id="L502" title="All 2 branches missed.">    if (m_Filename.equals(&quot;&quot;)) {</span>
<span class="nc" id="L503">      m_Title = Messages.getInstance().getString(&quot;ArffPanel_CreateTitle_Title_Text&quot;);</span>
    }
<span class="nc bnc" id="L505" title="All 2 branches missed.">    else if (m_Filename.equals(TAB_INSTANCES)) {</span>
<span class="nc" id="L506">      m_Title = TAB_INSTANCES;</span>
    }
    else {
      try {
<span class="nc" id="L510">        file  = new File(m_Filename);</span>
<span class="nc" id="L511">        m_Title = file.getName();</span>
      }
<span class="nc" id="L513">      catch (Exception e) {</span>
<span class="nc" id="L514">        m_Title = Messages.getInstance().getString(&quot;ArffPanel_CreateTitle_Title_Text&quot;);</span>
      }
    }
    
<span class="nc bnc" id="L518" title="All 2 branches missed.">    if (isChanged())</span>
<span class="nc" id="L519">      m_Title += &quot; *&quot;;</span>
<span class="nc" id="L520">  }</span>
  
  /**
   * sets the relation name
   */
  private void createName() {
    ArffSortedTableModel         model;
    
<span class="nc" id="L528">    model = (ArffSortedTableModel) m_TableArff.getModel();</span>
<span class="nc bnc" id="L529" title="All 4 branches missed.">    if ((model != null) &amp;&amp; (model.getInstances() != null))</span>
<span class="nc" id="L530">      m_LabelName.setText(Messages.getInstance().getString(&quot;ArffPanel_CreateName_Text&quot;) + model.getInstances().relationName());</span>
    else
<span class="nc" id="L532">      m_LabelName.setText(&quot;&quot;);</span>
<span class="nc" id="L533">  }</span>
  
  /**
   * loads the specified file into the table
   * 
   * @param filename		the file to load
   */
  private void loadFile(String filename) {
    ArffSortedTableModel         model;
    
<span class="nc" id="L543">    this.m_Filename = filename;</span>
    
<span class="nc" id="L545">    createTitle();</span>
    
<span class="nc bnc" id="L547" title="All 2 branches missed.">    if (filename.equals(&quot;&quot;))   </span>
<span class="nc" id="L548">      model = null;</span>
    else
<span class="nc" id="L550">      model = new ArffSortedTableModel(filename);</span>
    
<span class="nc" id="L552">    m_TableArff.setModel(model);</span>
<span class="nc" id="L553">    setChanged(false);</span>
<span class="nc" id="L554">    createName();</span>
<span class="nc" id="L555">  }</span>
  
  /**
   * calculates the mean of the given numeric column
   */
  private void calcMean() {
    ArffSortedTableModel   model;
    int               i;
    double            mean;
    
    // no column selected?
<span class="nc bnc" id="L566" title="All 2 branches missed.">    if (m_CurrentCol == -1)</span>
<span class="nc" id="L567">      return;</span>
    
<span class="nc" id="L569">    model = (ArffSortedTableModel) m_TableArff.getModel();</span>
    
    // not numeric?
<span class="nc bnc" id="L572" title="All 2 branches missed.">    if (!model.getAttributeAt(m_CurrentCol).isNumeric())</span>
<span class="nc" id="L573">      return;</span>
    
<span class="nc" id="L575">    mean = 0;</span>
<span class="nc bnc" id="L576" title="All 2 branches missed.">    for (i = 0; i &lt; model.getRowCount(); i++)</span>
<span class="nc" id="L577">      mean += model.getInstances().instance(i).value(m_CurrentCol - 1);</span>
<span class="nc" id="L578">    mean = mean / model.getRowCount();</span>
    
    // show result
<span class="nc" id="L581">    ComponentHelper.showMessageBox(</span>
<span class="nc" id="L582">        getParent(), </span>
<span class="nc" id="L583">        Messages.getInstance().getString(&quot;ArffPanel_CalcMean_Text_First&quot;),</span>
<span class="nc" id="L584">        Messages.getInstance().getString(&quot;ArffPanel_CalcMean_Text_Second&quot;) </span>
<span class="nc" id="L585">        + m_TableArff.getPlainColumnName(m_CurrentCol) </span>
<span class="nc" id="L586">        + Messages.getInstance().getString(&quot;ArffPanel_CalcMean_Text_Third&quot;) + Utils.doubleToString(mean, 3),</span>
<span class="nc" id="L587">        JOptionPane.OK_CANCEL_OPTION,</span>
<span class="nc" id="L588">        JOptionPane.PLAIN_MESSAGE);</span>
<span class="nc" id="L589">  }</span>
  
  /**
   * sets the specified values in a column to a new value
   * 
   * @param o		the menu item
   */
  private void setValues(Object o) {
    String                     msg;
    String                     title;
    String                     value;
    String                     valueNew;
    int                        i;
    ArffSortedTableModel      model;
    
<span class="nc" id="L604">    value    = &quot;&quot;;</span>
<span class="nc" id="L605">    valueNew = &quot;&quot;;</span>
    
<span class="nc bnc" id="L607" title="All 2 branches missed.">    if (o == menuItemSetMissingValues) {</span>
<span class="nc" id="L608">      title = Messages.getInstance().getString(&quot;ArffPanel_SetValues_Title_Text_First&quot;); </span>
<span class="nc" id="L609">      msg   = Messages.getInstance().getString(&quot;ArffPanel_SetValues_Message_Text_First&quot;);</span>
    }
<span class="nc bnc" id="L611" title="All 2 branches missed.">    else if (o == menuItemSetAllValues) {</span>
<span class="nc" id="L612">      title = Messages.getInstance().getString(&quot;ArffPanel_SetValues_Title_Text_Second&quot;); </span>
<span class="nc" id="L613">      msg   = Messages.getInstance().getString(&quot;ArffPanel_SetValues_Message_Text_Second&quot;);</span>
    }
<span class="nc bnc" id="L615" title="All 2 branches missed.">    else if (o == menuItemReplaceValues) {</span>
<span class="nc" id="L616">      title = Messages.getInstance().getString(&quot;ArffPanel_SetValues_Title_Text_Third&quot;); </span>
<span class="nc" id="L617">      msg   = Messages.getInstance().getString(&quot;ArffPanel_SetValues_Message_Text_Third&quot;);</span>
    }
    else
<span class="nc" id="L620">      return;</span>
    
<span class="nc" id="L622">    value = ComponentHelper.showInputBox(m_TableArff.getParent(), title, msg, m_LastSearch);</span>
    
    // cancelled?
<span class="nc bnc" id="L625" title="All 2 branches missed.">    if (value == null)</span>
<span class="nc" id="L626">      return;</span>

<span class="nc" id="L628">    m_LastSearch = value;</span>
    
    // replacement
<span class="nc bnc" id="L631" title="All 2 branches missed.">    if (o == menuItemReplaceValues) {</span>
<span class="nc" id="L632">      valueNew = ComponentHelper.showInputBox(m_TableArff.getParent(), title, Messages.getInstance().getString(&quot;ArffPanel_SetValues_ComponentHelperShowInputBox_Text&quot;), m_LastReplace);</span>
<span class="nc bnc" id="L633" title="All 2 branches missed.">      if (valueNew == null)</span>
<span class="nc" id="L634">        return;</span>
<span class="nc" id="L635">      m_LastReplace = valueNew;</span>
    }
    
<span class="nc" id="L638">    model = (ArffSortedTableModel) m_TableArff.getModel();</span>
<span class="nc" id="L639">    model.setNotificationEnabled(false);</span>

    // undo
<span class="nc" id="L642">    addUndoPoint();</span>
<span class="nc" id="L643">    model.setUndoEnabled(false);</span>
<span class="nc" id="L644">    String valueCopy = value;</span>
<span class="nc" id="L645">    String valueNewCopy = valueNew;</span>
    // set value
<span class="nc bnc" id="L647" title="All 2 branches missed.">    for (i = 0; i &lt; m_TableArff.getRowCount(); i++) {</span>
<span class="nc bnc" id="L648" title="All 2 branches missed.">      if (o == menuItemSetAllValues) {</span>
<span class="nc bnc" id="L649" title="All 4 branches missed.">        if (valueCopy.equals(&quot;NaN&quot;) || valueCopy.equals(&quot;?&quot;)) {</span>
<span class="nc" id="L650">          value = null;</span>
        }
<span class="nc" id="L652">        model.setValueAt(value, i, m_CurrentCol);</span>
      }
      else
<span class="nc bnc" id="L655" title="All 2 branches missed.">        if ( (o == menuItemSetMissingValues) </span>
<span class="nc bnc" id="L656" title="All 2 branches missed.">            &amp;&amp; model.isMissingAt(i, m_CurrentCol) )</span>
<span class="nc" id="L657">          model.setValueAt(value, i, m_CurrentCol);</span>
<span class="nc bnc" id="L658" title="All 2 branches missed.">        else if ( (o == menuItemReplaceValues)  </span>
<span class="nc bnc" id="L659" title="All 2 branches missed.">            &amp;&amp; model.getValueAt(i, m_CurrentCol).toString().equals(value) ) {</span>
<span class="nc bnc" id="L660" title="All 4 branches missed.">          if (valueNewCopy.equals(&quot;NaN&quot;) || valueNewCopy.equals(&quot;?&quot;)) {</span>
<span class="nc" id="L661">            valueNew = null;</span>
          }
<span class="nc" id="L663">          model.setValueAt(valueNew, i, m_CurrentCol);</span>
        }
    }
<span class="nc" id="L666">    model.setUndoEnabled(true);</span>
<span class="nc" id="L667">    model.setNotificationEnabled(true);</span>
<span class="nc" id="L668">    model.notifyListener(new TableModelEvent(model, 0, model.getRowCount(), m_CurrentCol, TableModelEvent.UPDATE));</span>
    
    // refresh
<span class="nc" id="L671">    m_TableArff.repaint();</span>
<span class="nc" id="L672">  }</span>
  
  /**
   * deletes the currently selected attribute
   */
  public void deleteAttribute() {
    ArffSortedTableModel   model;
    
    // no column selected?
<span class="nc bnc" id="L681" title="All 2 branches missed.">    if (m_CurrentCol == -1)</span>
<span class="nc" id="L682">      return;</span>
    
<span class="nc" id="L684">    model = (ArffSortedTableModel) m_TableArff.getModel();</span>

    // really an attribute column?
<span class="nc bnc" id="L687" title="All 2 branches missed.">    if (model.getAttributeAt(m_CurrentCol) == null)</span>
<span class="nc" id="L688">      return;</span>
    
    // really?
<span class="nc bnc" id="L691" title="All 2 branches missed.">    if (ComponentHelper.showMessageBox(</span>
<span class="nc" id="L692">        getParent(), </span>
<span class="nc" id="L693">        Messages.getInstance().getString(&quot;ArffPanel_DeleteAttribute_ComponentHelperShowMessageBox_Text_First&quot;),</span>
<span class="nc" id="L694">        Messages.getInstance().getString(&quot;ArffPanel_DeleteAttribute_ComponentHelperShowMessageBox_Text_Second&quot;) </span>
<span class="nc" id="L695">        + model.getAttributeAt(m_CurrentCol).name() + Messages.getInstance().getString(&quot;ArffPanel_DeleteAttribute_ComponentHelperShowMessageBox_Text_Third&quot;),</span>
<span class="nc" id="L696">        JOptionPane.YES_NO_OPTION,</span>
<span class="nc" id="L697">        JOptionPane.QUESTION_MESSAGE) != JOptionPane.YES_OPTION)</span>
<span class="nc" id="L698">      return;</span>
    
<span class="nc" id="L700">    setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));</span>
<span class="nc" id="L701">    model.deleteAttributeAt(m_CurrentCol);</span>
<span class="nc" id="L702">    setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));</span>
<span class="nc" id="L703">  }</span>
  
  /**
   * deletes the chosen attributes
   */
  public void deleteAttributes() {
    ListSelectorDialog    dialog;
    ArffSortedTableModel       model;
    Object[]              atts;
    int[]                 indices;
    int                   i;
    JList                 list;
    int                   result;
    
<span class="nc" id="L717">    list   = new JList(getAttributes());</span>
<span class="nc" id="L718">    dialog = new ListSelectorDialog(null, list);</span>
<span class="nc" id="L719">    result = dialog.showDialog();</span>
    
<span class="nc bnc" id="L721" title="All 2 branches missed.">    if (result != ListSelectorDialog.APPROVE_OPTION)</span>
<span class="nc" id="L722">      return;</span>
    
<span class="nc" id="L724">    atts = list.getSelectedValues();</span>
    
    // really?
<span class="nc bnc" id="L727" title="All 2 branches missed.">    if (ComponentHelper.showMessageBox(</span>
<span class="nc" id="L728">        getParent(), </span>
<span class="nc" id="L729">        Messages.getInstance().getString(&quot;ArffPanel_DeleteAttributes_ComponentHelperShowMessageBox_Text_First&quot;),</span>
<span class="nc" id="L730">        Messages.getInstance().getString(&quot;ArffPanel_DeleteAttributes_ComponentHelperShowMessageBox_Text_Second&quot;) </span>
<span class="nc" id="L731">        + atts.length + Messages.getInstance().getString(&quot;ArffPanel_DeleteAttributes_ComponentHelperShowMessageBox_Text_Third&quot;),</span>
<span class="nc" id="L732">        JOptionPane.YES_NO_OPTION,</span>
<span class="nc" id="L733">        JOptionPane.QUESTION_MESSAGE) != JOptionPane.YES_OPTION)</span>
<span class="nc" id="L734">      return;</span>
    
<span class="nc" id="L736">    model   = (ArffSortedTableModel) m_TableArff.getModel();</span>
<span class="nc" id="L737">    indices = new int[atts.length];</span>
<span class="nc bnc" id="L738" title="All 2 branches missed.">    for (i = 0; i &lt; atts.length; i++)</span>
<span class="nc" id="L739">      indices[i] = model.getAttributeColumn(atts[i].toString());</span>
    
<span class="nc" id="L741">    setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));</span>
<span class="nc" id="L742">    model.deleteAttributes(indices);</span>
<span class="nc" id="L743">    setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));</span>
<span class="nc" id="L744">  }</span>
  
  /**
   * sets the current attribute as class attribute, i.e. it moves it to the end
   * of the attributes
   */
  public void attributeAsClass() {
    ArffSortedTableModel   model;
    
    // no column selected?
<span class="nc bnc" id="L754" title="All 2 branches missed.">    if (m_CurrentCol == -1)</span>
<span class="nc" id="L755">      return;</span>
    
<span class="nc" id="L757">    model   = (ArffSortedTableModel) m_TableArff.getModel();</span>

    // really an attribute column?
<span class="nc bnc" id="L760" title="All 2 branches missed.">    if (model.getAttributeAt(m_CurrentCol) == null)</span>
<span class="nc" id="L761">      return;</span>
    
<span class="nc" id="L763">    setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));</span>
<span class="nc" id="L764">    model.attributeAsClassAt(m_CurrentCol);</span>
<span class="nc" id="L765">    setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));</span>
<span class="nc" id="L766">  }</span>
  
  /**
   * renames the current attribute
   */
  public void renameAttribute() {
    ArffSortedTableModel   model;
    String            newName;
    
    // no column selected?
<span class="nc bnc" id="L776" title="All 2 branches missed.">    if (m_CurrentCol == -1)</span>
<span class="nc" id="L777">      return;</span>
    
<span class="nc" id="L779">    model   = (ArffSortedTableModel) m_TableArff.getModel();</span>

    // really an attribute column?
<span class="nc bnc" id="L782" title="All 2 branches missed.">    if (model.getAttributeAt(m_CurrentCol) == null)</span>
<span class="nc" id="L783">      return;</span>
    
<span class="nc" id="L785">    newName = ComponentHelper.showInputBox(getParent(), </span>
<span class="nc" id="L786">    		Messages.getInstance().getString(&quot;ArffPanel_RenameAttribute_ComponentHelperShowInputBox_Text_First&quot;), Messages.getInstance().getString(&quot;ArffPanel_RenameAttribute_ComponentHelperShowInputBox_Text_Second&quot;), model.getAttributeAt(m_CurrentCol).name());</span>
<span class="nc bnc" id="L787" title="All 2 branches missed.">    if (newName == null)</span>
<span class="nc" id="L788">      return;</span>
    
<span class="nc" id="L790">    setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));</span>
<span class="nc" id="L791">    model.renameAttributeAt(m_CurrentCol, newName);</span>
<span class="nc" id="L792">    setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));</span>
<span class="nc" id="L793">  }</span>
  
  /**
   * deletes the currently selected instance
   */
  public void deleteInstance() {
    int               index;
    
<span class="nc" id="L801">    index = m_TableArff.getSelectedRow();</span>
<span class="nc bnc" id="L802" title="All 2 branches missed.">    if (index == -1)</span>
<span class="nc" id="L803">      return;</span>
    
<span class="nc" id="L805">    ((ArffSortedTableModel) m_TableArff.getModel()).deleteInstanceAt(index);</span>
<span class="nc" id="L806">  }</span>
  
  /**
   * deletes all the currently selected instances
   */
  public void deleteInstances() {
    int[]             indices;
    
<span class="nc bnc" id="L814" title="All 2 branches missed.">    if (m_TableArff.getSelectedRow() == -1)</span>
<span class="nc" id="L815">      return;</span>
    
<span class="nc" id="L817">    indices = m_TableArff.getSelectedRows();</span>
<span class="nc" id="L818">    ((ArffSortedTableModel) m_TableArff.getModel()).deleteInstances(indices);</span>
<span class="nc" id="L819">  }</span>
  
  /**
   * sorts the instances via the currently selected column
   */
  public void sortInstances() {
<span class="nc bnc" id="L825" title="All 2 branches missed.">    if (m_CurrentCol == -1)</span>
<span class="nc" id="L826">      return;</span>
    
<span class="nc" id="L828">    ((ArffSortedTableModel) m_TableArff.getModel()).sortInstances(m_CurrentCol);</span>
<span class="nc" id="L829">  }</span>
  
  /**
   * copies the content of the selection to the clipboard
   */
  public void copyContent() {
    StringSelection      selection;
    Clipboard            clipboard;
    
<span class="nc" id="L838">    selection = getTable().getStringSelection();</span>
<span class="nc bnc" id="L839" title="All 2 branches missed.">    if (selection == null)</span>
<span class="nc" id="L840">      return;</span>
    
<span class="nc" id="L842">    clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();</span>
<span class="nc" id="L843">    clipboard.setContents(selection, selection);</span>
<span class="nc" id="L844">  }</span>
  
  /**
   * searches for a string in the cells
   */
  public void search() {
    String              searchString;
    
    // display dialog
<span class="nc" id="L853">    searchString = ComponentHelper.showInputBox(getParent(), </span>
<span class="nc" id="L854">    		Messages.getInstance().getString(&quot;ArffPanel_Search_ComponentHelperShowInputBox_Text_First&quot;), Messages.getInstance().getString(&quot;ArffPanel_Search_ComponentHelperShowInputBox_Text_Second&quot;), m_LastSearch);</span>
<span class="nc bnc" id="L855" title="All 2 branches missed.">    if (searchString != null)</span>
<span class="nc" id="L856">      m_LastSearch = searchString;</span>
    
<span class="nc" id="L858">    getTable().setSearchString(searchString);</span>
<span class="nc" id="L859">  }</span>
  
  /**
   * clears the search, i.e. resets the found cells
   */
  public void clearSearch() {
<span class="nc" id="L865">    getTable().setSearchString(&quot;&quot;);</span>
<span class="nc" id="L866">  }</span>
  
  /**
   * calculates the optimal column width for the current column
   */
  public void setOptimalColWidth() {
    // no column selected?
<span class="nc bnc" id="L873" title="All 2 branches missed.">    if (m_CurrentCol == -1)</span>
<span class="nc" id="L874">      return;</span>

<span class="nc" id="L876">    JTableHelper.setOptimalColumnWidth(getTable(), m_CurrentCol);</span>
<span class="nc" id="L877">  }</span>
  
  /**
   * calculates the optimal column widths for all columns
   */
  public void setOptimalColWidths() {
<span class="nc" id="L883">    JTableHelper.setOptimalColumnWidth(getTable());</span>
<span class="nc" id="L884">  }</span>
  
  /**
   * invoked when an action occurs
   * 
   * @param e		the action event
   */
  public void actionPerformed(ActionEvent e) {
    Object          o;
    
<span class="nc" id="L894">    o = e.getSource();</span>
    
<span class="nc bnc" id="L896" title="All 2 branches missed.">    if (o == menuItemMean)</span>
<span class="nc" id="L897">      calcMean();</span>
<span class="nc bnc" id="L898" title="All 2 branches missed.">    else if (o == menuItemSetAllValues)</span>
<span class="nc" id="L899">      setValues(menuItemSetAllValues);</span>
<span class="nc bnc" id="L900" title="All 2 branches missed.">    else if (o == menuItemSetMissingValues)</span>
<span class="nc" id="L901">      setValues(menuItemSetMissingValues);</span>
<span class="nc bnc" id="L902" title="All 2 branches missed.">    else if (o == menuItemReplaceValues)</span>
<span class="nc" id="L903">      setValues(menuItemReplaceValues);</span>
<span class="nc bnc" id="L904" title="All 2 branches missed.">    else if (o == menuItemRenameAttribute)</span>
<span class="nc" id="L905">      renameAttribute();</span>
<span class="nc bnc" id="L906" title="All 2 branches missed.">    else if (o == menuItemAttributeAsClass)</span>
<span class="nc" id="L907">      attributeAsClass();</span>
<span class="nc bnc" id="L908" title="All 2 branches missed.">    else if (o == menuItemDeleteAttribute)</span>
<span class="nc" id="L909">      deleteAttribute();</span>
<span class="nc bnc" id="L910" title="All 2 branches missed.">    else if (o == menuItemDeleteAttributes)</span>
<span class="nc" id="L911">      deleteAttributes();</span>
<span class="nc bnc" id="L912" title="All 2 branches missed.">    else if (o == menuItemDeleteSelectedInstance)</span>
<span class="nc" id="L913">      deleteInstance();</span>
<span class="nc bnc" id="L914" title="All 2 branches missed.">    else if (o == menuItemDeleteAllSelectedInstances)</span>
<span class="nc" id="L915">      deleteInstances();</span>
<span class="nc bnc" id="L916" title="All 2 branches missed.">    else if (o == menuItemSortInstances)</span>
<span class="nc" id="L917">      sortInstances();</span>
<span class="nc bnc" id="L918" title="All 2 branches missed.">    else if (o == menuItemSearch)</span>
<span class="nc" id="L919">      search();</span>
<span class="nc bnc" id="L920" title="All 2 branches missed.">    else if (o == menuItemClearSearch)</span>
<span class="nc" id="L921">      clearSearch();</span>
<span class="nc bnc" id="L922" title="All 2 branches missed.">    else if (o == menuItemUndo)</span>
<span class="nc" id="L923">      undo();</span>
<span class="nc bnc" id="L924" title="All 2 branches missed.">    else if (o == menuItemCopy)</span>
<span class="nc" id="L925">      copyContent();</span>
<span class="nc bnc" id="L926" title="All 2 branches missed.">    else if (o == menuItemOptimalColWidth)</span>
<span class="nc" id="L927">      setOptimalColWidth();</span>
<span class="nc bnc" id="L928" title="All 2 branches missed.">    else if (o == menuItemOptimalColWidths)</span>
<span class="nc" id="L929">      setOptimalColWidths();</span>
<span class="nc" id="L930">  }</span>
  
  /**
   * Invoked when a mouse button has been pressed and released on a component
   * 
   * @param e		the mouse event
   */
  public void mouseClicked(MouseEvent e) {
    int		col;
    boolean	popup;
    
<span class="nc" id="L941">    col   = m_TableArff.columnAtPoint(e.getPoint());</span>
<span class="nc bnc" id="L942" title="All 4 branches missed.">    popup =    ((e.getButton() == MouseEvent.BUTTON3) &amp;&amp; (e.getClickCount() == 1))</span>
<span class="nc bnc" id="L943" title="All 10 branches missed.">            || ((e.getButton() == MouseEvent.BUTTON1) &amp;&amp; (e.getClickCount() == 1) &amp;&amp; e.isAltDown() &amp;&amp; !e.isControlDown() &amp;&amp; !e.isShiftDown());</span>
<span class="nc bnc" id="L944" title="All 4 branches missed.">    popup = popup &amp;&amp; (getInstances() != null);</span>
    
<span class="nc bnc" id="L946" title="All 2 branches missed.">    if (e.getSource() == m_TableArff.getTableHeader()) {</span>
<span class="nc" id="L947">      m_CurrentCol = col;</span>
      
      // Popup-Menu
<span class="nc bnc" id="L950" title="All 2 branches missed.">      if (popup) {</span>
<span class="nc" id="L951">        e.consume();</span>
<span class="nc" id="L952">        setMenu();</span>
<span class="nc" id="L953">        initPopupMenus();</span>
<span class="nc" id="L954">        m_PopupHeader.show(e.getComponent(), e.getX(), e.getY());</span>
      }
    }
<span class="nc bnc" id="L957" title="All 2 branches missed.">    else if (e.getSource() == m_TableArff) {</span>
      // Popup-Menu
<span class="nc bnc" id="L959" title="All 2 branches missed.">      if (popup) {</span>
<span class="nc" id="L960">        e.consume();</span>
<span class="nc" id="L961">        setMenu();</span>
<span class="nc" id="L962">        initPopupMenus();</span>
<span class="nc" id="L963">        m_PopupRows.show(e.getComponent(), e.getX(), e.getY());</span>
      }
    }
    
    // highlihgt column
<span class="nc bnc" id="L968" title="All 2 branches missed.">    if (    (e.getButton() == MouseEvent.BUTTON1)  </span>
<span class="nc bnc" id="L969" title="All 2 branches missed.">         &amp;&amp; (e.getClickCount() == 1) </span>
<span class="nc bnc" id="L970" title="All 2 branches missed.">         &amp;&amp; (!e.isAltDown())</span>
<span class="nc bnc" id="L971" title="All 2 branches missed.">         &amp;&amp; (col &gt; -1) ) {</span>
<span class="nc" id="L972">      m_TableArff.setSelectedColumn(col);</span>
    }
<span class="nc" id="L974">  }</span>
  
  /**
   * Invoked when the mouse enters a component.
   * 
   * @param e		the mouse event
   */
  public void mouseEntered(MouseEvent e) {
<span class="nc" id="L982">  }</span>
  
  /**
   * Invoked when the mouse exits a component
   * 
   * @param e		the mouse event
   */
  public void mouseExited(MouseEvent e) {
<span class="nc" id="L990">  }</span>
  
  /**
   * Invoked when a mouse button has been pressed on a component
   * 
   * @param e		the mouse event
   */
  public void mousePressed(MouseEvent e) {
<span class="nc" id="L998">  }</span>
  
  /**
   * Invoked when a mouse button has been released on a component.
   * 
   * @param e		the mouse event
   */
  public void mouseReleased(MouseEvent e) {
<span class="nc" id="L1006">  }</span>
  
  /**
   * Invoked when the target of the listener has changed its state.
   * 
   * @param e		the change event
   */
  public void stateChanged(ChangeEvent e) {
<span class="nc" id="L1014">    m_Changed = true;</span>
<span class="nc" id="L1015">    createTitle();</span>
<span class="nc" id="L1016">    notifyListener();</span>
<span class="nc" id="L1017">  }</span>
  
  /**
   * notfies all listener of the change
   */
  public void notifyListener() {
    Iterator                iter;
    
<span class="nc" id="L1025">    iter = m_ChangeListeners.iterator();</span>
<span class="nc bnc" id="L1026" title="All 2 branches missed.">    while (iter.hasNext())</span>
<span class="nc" id="L1027">      ((ChangeListener) iter.next()).stateChanged(new ChangeEvent(this));</span>
<span class="nc" id="L1028">  }</span>
  
  /**
   * Adds a ChangeListener to the panel
   * 
   * @param l		the listener to add
   */
  public void addChangeListener(ChangeListener l) {
<span class="nc" id="L1036">    m_ChangeListeners.add(l);</span>
<span class="nc" id="L1037">  }</span>
  
  /**
   * Removes a ChangeListener from the panel
   * 
   * @param l		the listener to remove
   */
  public void removeChangeListener(ChangeListener l) {
<span class="nc" id="L1045">    m_ChangeListeners.remove(l);</span>
<span class="nc" id="L1046">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span>AllTests (Nov 28, 2015 2:34:31 PM)</div></body></html>